<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>YuanyaDocs</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Root</a></li><li class="chapter-item expanded "><a href="æ¨¡æ¿.html"><strong aria-hidden="true">1.</strong> æ¨¡æ¿</a></li><li class="chapter-item expanded "><a href="ç•ª.html"><strong aria-hidden="true">2.</strong> ç•ª</a></li><li class="chapter-item expanded affix "><li class="part-title">è®¡</li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> æ“ä½œç³»ç»Ÿ</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="è®¡/æ“ä½œç³»ç»Ÿ/Linux.html"><strong aria-hidden="true">3.1.</strong> Linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="è®¡/æ“ä½œç³»ç»Ÿ/Linux.eBPF.html"><strong aria-hidden="true">3.1.1.</strong> Linux.eBPF</a></li></ol></li><li class="chapter-item expanded "><a href="è®¡/æ“ä½œç³»ç»Ÿ/WSL.html"><strong aria-hidden="true">3.2.</strong> WSL</a></li><li class="chapter-item expanded "><a href="è®¡/æ“ä½œç³»ç»Ÿ/Windows.html"><strong aria-hidden="true">3.3.</strong> Windows</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> è™šæ‹ŸåŒ–</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="OVN/OVS.html"><strong aria-hidden="true">4.1.</strong> OVN/OVS</a></li><li class="chapter-item expanded "><a href="è®¡/è™šæ‹ŸåŒ–/è™šæ‹Ÿç½‘ç»œ.html"><strong aria-hidden="true">4.2.</strong> è™šæ‹Ÿç½‘ç»œæŠ€æœ¯</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> äº‘åŸç”Ÿ</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="è®¡/äº‘åŸç”Ÿ/å®¹å™¨.Docker.html"><strong aria-hidden="true">5.1.</strong> Docker</a></li><li class="chapter-item expanded "><a href="è®¡/äº‘åŸç”Ÿ/Kubernetes.html"><strong aria-hidden="true">5.2.</strong> Kuberntes</a></li><li class="chapter-item expanded "><a href="è®¡/äº‘åŸç”Ÿ/Prometheus.html"><strong aria-hidden="true">5.3.</strong> Prometheus</a></li><li class="chapter-item expanded "><a href="è®¡/äº‘åŸç”Ÿ/Sealos.html"><strong aria-hidden="true">5.4.</strong> Sealos</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.5.</strong> Kube-OVN</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> è¯­è¨€</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="è®¡/è¯­è¨€/Go.html"><strong aria-hidden="true">6.1.</strong> Go</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> å·¥å…·</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="è®¡/å·¥å…·/Git.html"><strong aria-hidden="true">7.1.</strong> Git</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">YuanyaDocs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h3 id="hi-there-"><a class="header" href="#hi-there-">Hi there ğŸ‘‹</a></h3>
<!--
**YuanyaTianchi/yuanyatianchi** is a âœ¨ _special_ âœ¨ repository because its `README.md` (this file) appears on your GitHub profile.

Here are some ideas to get you started:

- ğŸ”­ Iâ€™m currently working on ...
- ğŸŒ± Iâ€™m currently learning ...
- ğŸ‘¯ Iâ€™m looking to collaborate on ...
- ğŸ¤” Iâ€™m looking for help with ...
- ğŸ’¬ Ask me about ...
- ğŸ“« How to reach me: ...
- ğŸ˜„ Pronouns: ...
- âš¡ Fun fact: ...
-->
<p><img src="./img/%E6%A0%88.svg" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;Title.sub_title&quot;
description = &quot;Title sub_title quick_start&quot;
tags = [&quot;techn&quot;, &quot;computer&quot;, &quot;tagx&quot;, &quot;Title&quot;, &quot;_sub_title&quot;, &quot;__quick_start(content)&quot;]</p>
<p>+++</p>
<h1 id="titlesub_title"><a class="header" href="#titlesub_title">Title.sub_title</a></h1>
<blockquote>
<p><a href="">å®˜ç½‘</a>ï¼›</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ç•ª"><a class="header" href="#ç•ª">ç•ª</a></h1>
<h2 id="2023"><a class="header" href="#2023">2023</a></h2>
<p>ã€202301ã€‘ã€æ—¥ã€‘è¿›å‡»çš„å·¨äºº æœ€ç»ˆå­£ Part.3-å‘¨äº”0</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘<a href="https://www.agemys.net/detail/20230072">å¤©å›½å¤§é­”å¢ƒ</a>-å‘¨å…­1</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘fate/strangeFake-0</p>
<p>ã€202211ã€‘ã€æ—¥ã€‘é˜¿å°”æ–¯çš„å·¨å…½-0</p>
<p>ã€202211ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22350.html"><strong>åˆ«å½“æ¬§å°¼é…±äº†</strong></a></p>
<p>ã€202301ã€‘ã€æ—¥ã€‘<a href="https://www.agemys.net/detail/20210270">å†°æµ·æˆ˜è®°2</a>-0</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘è¾‰å¤œå¤§å°å§æƒ³è®©æˆ‘å‘Šç™½ åˆå»ä¸ä¼šç»“æŸ-0</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘å°¼å°”ï¼šæœºæ¢°çºªå…ƒ-0</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘ä¸ƒå¤§ç½ª æ€¨å—Ÿçš„çˆ±ä¸å ¡ å‰ç¯‡-0</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/23092.html">æ–‡è±ªé‡çŠ¬4</a>-å‘¨ä¸‰0</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘<a href="https://www.bilibili.com/bangumi/media/md28412512">è™šæ„æ¨ç†2</a>-å‘¨æ—¥1</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘ä¼Šè—¤æ¶¦äºŒ2-0</p>
<p>ã€202301ã€‘ã€æ—¥ã€‘<a href="https://www.bilibili.com/bangumi/media/md28412511/">å› ä¸ºå¤ªæ€•ç—›å°±å…¨ç‚¹é˜²å¾¡åŠ›äº†</a>-å‘¨ä¸‰6</p>
<h2 id="2022"><a class="header" href="#2022">2022</a></h2>
<p>ã€202211ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22099.html">JOJOçš„å¥‡å¦™å†’é™©6çŸ³ä¹‹æµ·Part3</a></p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22465.html"><strong>4ä¸ªäººå„è‡ªæœ‰ç€è‡ªå·±çš„ç§˜å¯†</strong></a></p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22508.html">é£™é€Ÿå®…ç”·5</a>-å‘¨ä¸€10</p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/21333.html">ç”µé”¯äºº</a></p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22203.html">å­¤ç‹¬æ‘‡æ»š</a></p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22322.html">é»„é‡‘ç¥å¨4</a>-å‘¨ä¸€0</p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22266.html">æœºåŠ¨æˆ˜å£«é«˜è¾¾ æ°´æ˜Ÿçš„é­”å¥³</a>-å‘¨æ—¥0</p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22518.html">é—´è°è¿‡å®¶å®¶ Part2</a></p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.bilibili.com/bangumi/media/md28339709">çµèƒ½ç™¾åˆ†ç™¾3</a></p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22473.html">åä¾¦æ¢æŸ¯å— çŠ¯äººçŠ¯æ³½å…ˆç”Ÿ</a>-å‘¨äºŒ0</p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22438.html"><strong>ç§‹å¶åŸå¥³ä»†æˆ˜äº‰</strong></a></p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22209.html">æ­»ç¥ åƒå¹´è¡€æˆ˜ç¯‡</a>-å‘¨äºŒ0</p>
<p>ã€202210ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22536.html">é“¶æ²³è‹±é›„ä¼ è¯´ Die Neue These ç­–è°‹</a>-å‘¨äº”0</p>
<p>ã€202209ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22524.html"><strong>èµ›åšæœ‹å…‹ï¼šè¾¹ç¼˜è¡Œè€…</strong></a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22099.html">JOJOçš„å¥‡å¦™å†’é™©6çŸ³ä¹‹æµ·Part2</a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22224.html">Lycoris Recoil</a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/21285.html">Overlord4</a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22332.html">RWBY-å†°é›ªå¸å›½</a>-å‘¨æ—¥4</p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22294.html">æ¬¢è¿æ¥åˆ°å®åŠ›è‡³ä¸Šä¸»ä¹‰æ•™å®¤2</a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22170.html">ç‹‚èµŒä¹‹æ¸ŠåŒ</a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/20181.html"><strong>æ¥è‡ªæ·±æ¸Š2 çƒˆæ—¥çš„é»„é‡‘ä¹¡</strong></a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.agemys.net/play/20220134"><strong>å¼‚ä¸–ç•Œèˆ…èˆ…</strong></a></p>
<p>ã€202207ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22084.html">ç§Ÿç•Œå¥³å‹2</a>-å‘¨å…­18</p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/21157.html">å¤„åˆ‘å°‘å¥³çš„ç”Ÿå­˜ä¹‹é“</a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/21104.html"><strong>è¾‰å¤œå¤§å°å§æƒ³è®©æˆ‘å‘Šç™½3</strong></a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22164.html"><strong>é—´è°è¿‡å®¶å®¶</strong></a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.bilibili.com/bangumi/play/ss39725/">ç†ç§‘ç”Ÿå å…¥æƒ…ç½‘ï¼Œæ•…å°è¯•è¯æ˜2</a>-å‘¨å…­4</p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.bilibili.com/bangumi/play/ss41418/"><strong>æ‹çˆ±è¦åœ¨å¾æœä¸–ç•Œå</strong></a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.bilibili.com/bangumi/play/ep478912">æ‹çˆ±æ¸¸æˆä¸–ç•Œå¯¹è·¯äººè§’è‰²å¾ˆä¸å‹å¥½</a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22172.html">æ´¾å¯¹æµªå®¢è¯¸è‘›å­”æ˜</a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22165.html">æœ‹å‹æ¸¸æˆ1</a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22162.html"><strong>é’ä¹‹èŠ¦è‹‡</strong></a></p>
<p>ã€202204ã€‘ã€æ—¥ã€‘<a href="https://www.yhdmp.cc/showp/22174.html">å¤æ—¥é‡ç°</a></p>
<p>ã€202201ã€‘ã€æ—¥ã€‘é¬¼ç­ä¹‹åˆƒ3æ¸¸éƒ­ç¯‡</p>
<p>ã€202201ã€‘ã€æ—¥ã€‘<strong>è¿›å‡»çš„å·¨äººæœ€ç»ˆå­£part2</strong></p>
<p>ã€202201ã€‘ã€æ—¥ã€‘å¤©æ‰ç‹å­çš„èµ¤å­—å›½å®¶æŒ¯å…´æœ¯</p>
<p>ã€202201ã€‘ã€æ—¥ã€‘<strong>ä¸å˜æˆäº†å¼‚ä¸–ç•Œç¾å°‘å¥³çš„å¥½å‹ä¸€èµ·å†’é™©</strong></p>
<h2 id="2021"><a class="header" href="#2021">2021</a></h2>
<p>ã€202110ã€‘ã€æ—¥ã€‘jojoçš„å¥‡å¦™å†’é™©.çŸ³ä¹‹æµ·</p>
<p>ã€202110ã€‘ã€æ—¥ã€‘é“‚é‡‘ç»ˆå±€</p>
<p>ã€202110ã€‘ã€æ—¥ã€‘èŒƒé©¬åˆƒç‰™</p>
<p>ã€202110ã€‘ã€æ—¥ã€‘å›½ç‹æ’å</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘<a href="https://www.agemys.cc/detail/20210314">å¢ƒç•Œè§¦å‘è€…3</a>-0</p>
<p>ã€202110ã€‘ã€æ—¥ã€‘é­”æ³•ä½¿çš„æ–°å¨˜2-1</p>
<p>ã€202110ã€‘ã€æ—¥ã€‘ä¸ƒåŸç½ªå‰§åœºç‰ˆ è¢«å…‰è¯…å’’çš„ä¼—äºº</p>
<p>ã€202110ã€‘ã€æ—¥ã€‘<strong>æ— èŒè½¬ç”Ÿ1part2</strong></p>
<p>ã€202110ã€‘ã€æ—¥ã€‘<strong>è‹±é›„è”ç›Ÿï¼šåŒåŸä¹‹æˆ˜</strong></p>
<p>ã€202107ã€‘ã€æ—¥ã€‘è¶…é¾™ç è‹±é›„BM-17</p>
<p>ã€202107ã€‘ã€æ—¥ã€‘æ­Œå‰§å°‘å¥³-0</p>
<p>ã€202107ã€‘ã€æ—¥ã€‘<strong>å…³äºæˆ‘è½¬ç”Ÿå˜æˆå²è±å§†è¿™ä»¶äº‹3</strong></p>
<p>ã€202107ã€‘ã€æ—¥ã€‘å¯’è‰é¸£æ³£ä¹‹æ—¶ å’-0</p>
<p>ã€202107ã€‘ã€æ—¥ã€‘è§é¢5ç§’å¼€å§‹æˆ˜æ–—</p>
<p>ã€202107ã€‘ã€æ—¥ã€‘ç²¾çµå¹»æƒ³è®°</p>
<p>ã€202107ã€‘ã€æ—¥ã€‘<strong>å¹³ç¨³ä¸–ä»£çš„éŸ¦é©®å¤©ä»¬</strong></p>
<p>ã€202107ã€‘ã€æ—¥ã€‘å¥‡å·§è®¡ç¨‹è½¦</p>
<p>ã€202107ã€‘ã€æ—¥ã€‘å°æ—å®¶çš„é¾™å¥³ä»†S</p>
<p>ã€202107ã€‘ã€æ—¥ã€‘å¼‚ä¸–ç•Œè¿·å®«é»‘å¿ƒä¼ä¸š</p>
<p>ã€202104ã€‘ã€æ—¥ã€‘MARS RED-1</p>
<p>ã€202104ã€‘ã€æ—¥ã€‘MegaloBOX2</p>
<p>ã€202104ã€‘ã€æ—¥ã€‘æé“ä¸»å¤«-5</p>
<p>ã€202104ã€‘ã€æ—¥ã€‘å¦‚æœç©¶æè¿›åŒ–çš„å®Œå…¨æ²‰æµ¸RPGæ¯”ç°å®æ›´åƒåœ¾çš„è¯1</p>
<p>ã€202104ã€‘ã€æ—¥ã€‘å…¥é—´åŒå­¦å…¥é­”äº†2-0</p>
<p>ã€202104ã€‘ã€æ—¥ã€‘æˆ˜æ–—å‘˜æ´¾é£ä¸­</p>
<p>ã€202104ã€‘ã€æ—¥ã€‘è½¬ç”Ÿå²è±å§†æ—¥è®°-2</p>
<p>ã€202101ã€‘ã€å›½ã€‘<strong>åˆºå®¢ä¼å…­ä¸ƒä¹‹ç„æ­¦å›½ç¯‡</strong></p>
<p>ã€202101ã€‘ã€æ—¥ã€‘BackArrow</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘ä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´»2.2</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘åŠ¨ç‰©ç‹‚æƒ³æ›²2</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å·¥ä½œç»†èƒ2</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å·¥ä½œç»†èƒBlack</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å¥½æ¯”æ˜¯æœ€ç»ˆè¿·å®«å‰çš„å°‘å¹´åˆ°æ–°æ‰‹æ‘ç”Ÿæ´»ä¸€èˆ¬çš„æ•…äº‹</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘<strong>å…³äºæˆ‘è½¬ç”Ÿå˜æˆå²è±å§†è¿™ä»¶äº‹2</strong></p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å›å¤æœ¯å£«çš„é‡å¯äººç”Ÿ</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘è®°å½•çš„åœ°å¹³çº¿3</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘<strong>è¿›å‡»çš„å·¨äººæœ€ç»ˆå­£part1</strong></p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å¢ƒç•Œè§¦å‘è€…2</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å €ä¸å®«æ‘</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘<a href="https://www.bilibili.com/bangumi/media/md28232005">ä¸ƒå¤§ç½ª4</a>-14</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å¼±åŠ¿è§’è‰²å‹å´å›</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘èµ›é©¬å¨˜-5</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘å¤©ç©ºä¾µçŠ¯1</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘<strong>æ— èŒè½¬ç”Ÿ1part1</strong></p>
<p>ã€202101ã€‘ã€æ—¥ã€‘æ‘‡æ›³éœ²è¥2-2</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘çº¦å®šçš„æ¢¦å¹»å²›2</p>
<p>ã€202101ã€‘ã€æ—¥ã€‘<strong>è½¬ç”Ÿæˆèœ˜è››åˆæ€æ ·</strong></p>
<h2 id="2020"><a class="header" href="#2020">2020</a></h2>
<p>ã€202010ã€‘ã€æ—¥ã€‘æˆç¥ä¹‹æ—¥</p>
<p>ã€202010ã€‘ã€æ—¥ã€‘é¬¼ç­ä¹‹åˆƒå‰§åœºç‰ˆ æ— é™åˆ—è½¦ç¯‡</p>
<p>ã€202010ã€‘ã€æ—¥ã€‘é­”å¥³ä¹‹æ—…1</p>
<p>ã€202010ã€‘ã€æ—¥ã€‘å…¨å‘˜æ¶ç‰</p>
<p>ã€202010ã€‘ã€æ—¥ã€‘*åœ¨é­”ç‹åŸè¯´æ™šå®‰</p>
<p>ã€202010ã€‘ã€æ—¥ã€‘*å’’æœ¯å›æˆ˜1</p>
<p>ã€202007ã€‘ã€å›½ã€‘é›¾å±±äº”è¡Œ1</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘ä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´»2.1</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘å¤§æ¬ºè¯ˆå¸ˆ</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘åˆ€å‰‘ç¥åŸŸ3 Alicization3-12</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘é«˜æ ¡ä¹‹ç¥-6</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘æ²¡è½è¦å¡/DECA-DENCE</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘åˆƒç‰™2</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘å¤©æ™´çƒ‚æ¼«</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘æˆ‘çš„é’æ˜¥æ‹çˆ±ç‰©è¯­æœç„¶æœ‰é—®é¢˜3-7</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘ç‚ç‚æ¶ˆé˜²é˜Ÿ2</p>
<p>ã€202007ã€‘ã€æ—¥ã€‘ç§Ÿç•Œå¥³å‹1</p>
<p>ã€202004ã€‘ã€æ—¥ã€‘é£ŸæˆŸä¹‹çµ5è±ªä¹‹çš¿-0</p>
<p>ã€202004ã€‘ã€æ—¥ã€‘éšç’ä¹‹äº‹</p>
<p>ã€202004ã€‘ã€æ—¥ã€‘æ ¼è±æ™®å°¼å°”1</p>
<p>ã€202004ã€‘ã€æ—¥ã€‘è¾‰å¤œå¤§å°å§æƒ³è®©æˆ‘å‘Šç™½2</p>
<p>ã€202004ã€‘ã€æ—¥ã€‘è½¬ç”Ÿæˆä¸ºäº†åªæœ‰ä¹™å¥³æ¸¸æˆç ´ç­Flagçš„é‚ªæ¶å¤§å°å§</p>
<p>ã€202004ã€‘ã€æ—¥ã€‘ç¥ä¹‹å¡”1</p>
<p>ã€202004ã€‘ã€æ—¥ã€‘åŠ¨ç‰©æ–°ä¸–ä»£/BNA</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘å› ä¸ºå¤ªæ€•ç—›å°±å…¨ç‚¹é˜²å¾¡åŠ›äº†</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘å¼‚ç§æ—é£ä¿—å¨˜è¯„é‰´æŒ‡å—</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘å¼‚åº¦å…¥ä¾µID:INVADED</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘è™šæ„æ¨ç†</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘é½æœ¨æ¥ é›„çš„ç¾éš¾ å§‹åŠ¨ç¯‡</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘æŸç§‘å­¦çš„è¶…ç”µç£ç‚®T-15</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘çŒé¾™é£èˆ¹</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘ç†ç§‘ç”Ÿå å…¥æƒ…ç½‘ï¼Œæ•…å°è¯•è¯æ˜</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘è¾¾å°”æ–‡æ¸¸æˆ</p>
<p>ã€202001ã€‘ã€æ—¥ã€‘<a href="https://www.agemys.cc/detail/20200054"><strong>æ¥è‡ªæ·±æ¸Š æ·±æ²‰çµé­‚çš„é»æ˜</strong></a></p>
<h2 id="2019"><a class="header" href="#2019">2019</a></h2>
<p>ã€201910ã€‘ã€æ—¥ã€‘è¿™ä¸ªå‹‡è€…æ˜æ˜è¶…å¼ºå´è¿‡åˆ†æ…é‡</p>
<p>ã€201910ã€‘ã€æ—¥ã€‘å¿ƒç†æµ‹é‡è€…3</p>
<p>ã€201910ã€‘ã€æ—¥ã€‘æˆ‘ä¸æ˜¯è¯´äº†èƒ½åŠ›è¦å¹³å‡å€¼ä¹ˆ</p>
<p>ã€201910ã€‘ã€æ—¥ã€‘é£ŸæˆŸä¹‹çµ4ç¥ä¹‹çš¿-0</p>
<p>ã€201910ã€‘ã€æ—¥ã€‘å…¥é—´åŒå­¦å…¥é­”äº†</p>
<p>ã€201910ã€‘ã€æ—¥ã€‘ä¸ƒå¤§ç½ª3</p>
<p>ã€201910ã€‘ã€æ—¥ã€‘åŠ¨ç‰©ç‹‚æƒ³æ›²BEASTARS1</p>
<p>ã€201910ã€‘ã€æ—¥ã€‘åˆ€å‰‘ç¥åŸŸ3 Alicization2</p>
<p>ã€201910ã€‘ã€å›½ã€‘ä¼å…­ä¸ƒä¹‹æœ€å¼ºå‘å‹å¸ˆ</p>
<p>ã€201908ã€‘ã€æ—¥ã€‘ä¸ºç¾å¥½çš„ä¸–ç•ŒçŒ®ä¸Šç¥ç¦ï¼çº¢ä¼ è¯´</p>
<p>ã€201907ã€‘ã€æ—¥ã€‘ç‚ç‚æ¶ˆé˜²é˜Ÿ1</p>
<p>ã€201907ã€‘ã€æ—¥ã€‘å¥³é«˜ä¸­ç”Ÿçš„è™šåº¦æ—¥å¸¸</p>
<p>ã€201907ã€‘ã€æ—¥ã€‘æµæ±—å§ï¼å¥èº«å°‘å¥³</p>
<p>ã€201907ã€‘ã€æ—¥ã€‘fate å›ä¸»Â·åŸƒå°”æ¢…ç½—äºŒä¸–äº‹ä»¶ç°¿ é­”çœ¼æ”¶é›†åˆ—è½¦ Grace note</p>
<p>ã€201907ã€‘ã€æ—¥ã€‘å†°å¯’æˆ˜è®°</p>
<p>ã€201907ã€‘ã€æ—¥ã€‘åœ¨åœ°ä¸‹åŸå¯»æ±‚é‚‚é€…æ˜¯å¦æé”™äº†ä»€ä¹ˆ2-8</p>
<p>ã€201905ã€‘ã€æ—¥ã€‘*æ™®ç½—ç±³äºš</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘å¼‚ä¸–ç•Œå››é‡å¥2</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘ä¸€æ‹³è¶…äºº2</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘ä¸€ä¸ªäººçš„OOå°æ—¥å­</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘è´¤è€…ä¹‹å­™</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘æ–‡è±ªé‡çŠ¬3</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘è¿›å‡»çš„å·¨äºº3</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘é¬¼ç­ä¹‹åˆƒ</p>
<p>ã€201904ã€‘ã€æ—¥ã€‘CAROLE &amp; TUESDAY</p>
<p>ã€201901ã€‘ã€æ—¥ã€‘çº¦å®šçš„æ¢¦å¹»å²›</p>
<p>ã€201901ã€‘ã€æ—¥ã€‘çµèƒ½ç™¾åˆ†ç™¾2</p>
<p>ã€201901ã€‘ã€æ—¥ã€‘ç‹‚èµŒä¹‹æ¸Š2</p>
<p>ã€201901ã€‘ã€æ—¥ã€‘è¾‰å¤œå¤§å°å§æƒ³è®©æˆ‘å‘Šç™½</p>
<p>ã€201901ã€‘ã€æ—¥ã€‘å¤šç½—ç½—</p>
<p>ã€201901ã€‘ã€æ—¥ã€‘ç›¾ä¹‹å‹‡è€…æˆåå½•</p>
<p>ã€201901ã€‘ã€æ—¥ã€‘ä¸å‰æ³¢æ™®ä¸ç¬‘</p>
<h2 id="2018"><a class="header" href="#2018">2018</a></h2>
<p>ã€201810ã€‘ã€æ—¥ã€‘ä½è´ºå¶åƒæ˜¯ä¼ å¥‡</p>
<p>ã€201810ã€‘ã€æ—¥ã€‘ç»ˆå°†æˆä¸ºä½ </p>
<p>ã€201810ã€‘ã€æ—¥ã€‘é’æ˜¥çŒªå¤´å°‘å¹´ä¸ä¼šæ¢¦åˆ°å…”å¥³éƒå­¦å§</p>
<p>ã€201810ã€‘ã€æ—¥ã€‘å¼ºé£å¹æ‹‚</p>
<p>ã€201810ã€‘ã€æ—¥ã€‘å…³äºæˆ‘è½¬ç”Ÿå˜æˆå²è±å§†è¿™ä»¶äº‹</p>
<p>ã€201810ã€‘ã€æ—¥ã€‘å“¥å¸ƒæ—æ€æ‰‹</p>
<p>ã€201810ã€‘ã€æ—¥ã€‘åˆ€å‰‘ç¥åŸŸ3 Alicization1</p>
<p>ã€201810ã€‘ã€æ—¥ã€‘JOJOçš„å¥‡å¦™å†’é™©5é»„é‡‘ä¹‹é£</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘æ¸¸æˆ3äººå¨˜</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘å¼‚ä¸–ç•Œé­”ç‹ä¸å¬å”¤å°‘å¥³çš„å¥´éš¶é­”æœ¯</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘æ€æˆ®å¤©ä½¿</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘åˆƒç‰™</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘è½»ç¾½é£æ‰¬</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘è¿›å‡»çš„å·¨äºº3</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘å·¥ä½œç»†èƒ</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘ç¢§è“ä¹‹æµ·</p>
<p>ã€201807ã€‘ã€æ—¥ã€‘Overlord2</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘å®…ç”·è…å¥³æ‹çˆ±çœŸéš¾</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘æˆ‘çš„è‹±é›„å­¦é™¢3</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘é£ŸæˆŸä¹‹çµova</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘èµ›é©¬å¨˜</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘å¥´éš¶åŒº</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘é­”æ€§ä¹‹çº¿</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘é­”æ³•å°‘å¥³ç½‘ç«™</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘é­”æ³•å°‘å¥³ä¿º</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘é»‘ç¤¾ä¼šçš„è¶…èƒ½åŠ›å¥³å„¿</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘è‹å¤©ä¹‹æ‹³1</p>
<p>ã€201804ã€‘ã€æ—¥ã€‘MegaloBOX1</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘ç´«ç½—å…°æ°¸æ’èŠ±å›­</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘æ¸¸æˆäººç”Ÿå‰§åœºç‰ˆ</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘æ‘‡æ›³éœ²è¥</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘ç‰™æ–—å…½å¨˜</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘é½æœ¨æ¥ é›„çš„ç¾éš¾2</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘ä¸ƒå¤§ç½ª2</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘é¾™ç‹çš„å·¥ä½œ</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘åˆ»åˆ»-æ—¶é—´æš‚åœ</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘åšå¤šè±šéª¨æ‹‰é¢</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘æ¯”å®‡å®™æ›´é¥è¿œçš„åœ°æ–¹</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘OVERLORD</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘darling</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘Citrusï½æŸ‘æ©˜å‘³é¦™æ°”ï½</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘Bï¼šå½¼ä¹‹åˆ</p>
<p>ã€201801ã€‘ã€æ—¥ã€‘A.I.C.O. Incarnation</p>
<h2 id="2017"><a class="header" href="#2017">2017</a></h2>
<p>ã€201710ã€‘ã€æ—¥ã€‘æ‚ ä¹…æŒæœ‰è€…! é­”æ³•è€å¸ˆ2</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘è¡€ç•Œæˆ˜çº¿2</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘é£ŸæˆŸä¹‹çµ3é¤ä¹‹çš¿</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘å°‘å¥³ç»ˆæœ«æ—…è¡Œ</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘å¥‡è¯ºä¹‹æ—…2</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘é­”æ³•ä½¿çš„æ–°å¨˜</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘å›½ç‹æ¸¸æˆ</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘å…³äºæˆ‘å¥³å‹æ˜¯ä¸€ä¸ªæ­£ç»çš„ç¢§æ± è¿™ä»¶äº‹</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘å¹²ç‰©å¦¹å°åŸ‹2</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘è°ƒæ•™å’–å•¡å…</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘*å®çŸ³ä¹‹å›½</p>
<p>ã€201710ã€‘ã€æ—¥ã€‘fate stay night heaven's feel å‰§åœºç‰ˆ</p>
<p>ã€201707ã€‘ã€æ—¥ã€‘NewGame2</p>
<p>ã€201707ã€‘ã€æ—¥ã€‘ç¬¨å¥³å­©</p>
<p>ã€201707ã€‘ã€æ—¥ã€‘å¸¦ç€æ™ºæ…§å‹æ‰‹æœºé—¯è¡å¼‚ä¸–ç•Œ</p>
<p>ã€201707ã€‘ã€æ—¥ã€‘æ¬¢è¿æ¥åˆ°å®åŠ›è‡³ä¸Šä¸»ä¹‰æ•™å®¤1</p>
<p>ã€201707ã€‘ã€æ—¥ã€‘ç‹‚èµŒä¹‹æ¸Š1</p>
<p>ã€201707ã€‘ã€æ—¥ã€‘<a href="https://www.agemys.cc/detail/20170051"><strong>æ¥è‡ªæ·±æ¸Š1</strong></a></p>
<p>ã€201707ã€‘ã€æ—¥ã€‘æ‹çˆ±ç¦æ­¢çš„ä¸–ç•Œ</p>
<p>ã€201707ã€‘ã€æ—¥ã€‘éª‘å£«ä¸é­”æ³•</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘æ¨±èŠ±ä»»åŠ¡</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘æ­¦è£…å°‘å¥³</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘æˆ‘çš„è‹±é›„å­¦é™¢2</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘æˆ‘çš„å¦¹å¦¹æ˜¯é»„æ¼«è€å¸ˆ</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘æœ«æ—¥æ—¶åœ¨åšä»€ä¹ˆï¼Ÿæœ‰æ²¡æœ‰ç©ºï¼Ÿå¯ä»¥æ¥æ‹¯æ•‘å—ï¼Ÿ</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘è·¯äººå¥³ä¸»çš„å…»æˆæ–¹å¼2</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘é›¶ä¹‹é­”æ³•ä¹¦</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘è¿›å‡»çš„å·¨äºº2</p>
<p>ã€201704ã€‘ã€æ—¥ã€‘Re:Creators</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘ACCA13åŒºç›‘å¯Ÿè¯¾</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘Hand Shakers</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘çƒ­è¯šä¼ è¯´2</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘é£™é€Ÿå®…ç”·3</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘çˆç™¾ç’ƒçš„å •è½</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘å…½å¨˜åŠ¨ç‰©å›­</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘å…½å¨˜åŠ¨ç‰©å›­</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘ä¸ºç¾å¥½çš„ä¸–ç•ŒçŒ®ä¸Šç¥ç¦2</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘å°æ—å®¶çš„é¾™å¥³ä»†</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘<strong>å°é­”å¥³å­¦å›­</strong></p>
<p>ã€201701ã€‘ã€æ—¥ã€‘äºšäººé…±æœ‰è¯è¦è¯´</p>
<p>ã€201701ã€‘ã€æ—¥ã€‘<strong>å¹¼å¥³æˆ˜è®°</strong></p>
<p>ã€201701ã€‘ã€æ—¥ã€‘æ”¿å®—å›çš„å¤ä»‡</p>
<h2 id="2016"><a class="header" href="#2016">2016</a></h2>
<p>ã€201610ã€‘ã€æ—¥ã€‘æˆ‘å¤ªå—æ¬¢è¿äº†è¯¥æ€ä¹ˆåŠ</p>
<p>ã€201610ã€‘ã€æ—¥ã€‘æˆ‘çš„è€å©†æ˜¯å­¦ç”Ÿä¼šé•¿2</p>
<p>ã€201610ã€‘ã€æ—¥ã€‘æ–‡è±ªé‡çŠ¬2</p>
<p>ã€201610ã€‘ã€æ—¥ã€‘å°‘å¥³ç¼–å·</p>
<p>ã€201610ã€‘ã€æ—¥ã€‘æ¼‚æµæ­¦å£«</p>
<p>ã€201610ã€‘ã€æ—¥ã€‘é­”æ³•å°‘å¥³è‚²æˆè®¡åˆ’</p>
<p>ã€201610ã€‘ã€æ—¥ã€‘è¶…è‡ªç„¶9äººç»„</p>
<p>ã€201610ã€‘ã€æ—¥ã€‘å†°ä¸Šçš„å°¤é‡Œ</p>
<p>ã€201610ã€‘ã€å›½ã€‘äºšäºº2</p>
<p>ã€201610ã€‘ã€å›½ã€‘å‡¸å˜è‹±é›„</p>
<p>ã€201607ã€‘ã€æ—¥ã€‘è¿™ä¸ªç¾æœ¯ç¤¾å¤§æœ‰é—®é¢˜ï¼</p>
<p>ã€201607ã€‘ã€æ—¥ã€‘é£ŸæˆŸä¹‹çµ2è´°ä¹‹çš¿</p>
<p>ã€201607ã€‘ã€æ—¥ã€‘çƒ­è¯šä¼ è¯´1</p>
<p>ã€201607ã€‘ã€æ—¥ã€‘é½æœ¨æ¥ é›„çš„ç¾éš¾1</p>
<p>ã€201607ã€‘ã€æ—¥ã€‘çµèƒ½ç™¾åˆ†ç™¾1</p>
<p>ã€201607ã€‘ã€æ—¥ã€‘å¼¹ä¸¸è®ºç ´3</p>
<p>ã€201607ã€‘ã€æ—¥ã€‘NEW GAME1</p>
<p>ã€201607ã€‘ã€å›½ã€‘ä¸€äººä¹‹ä¸‹</p>
<p>ã€201604ã€‘ã€æ—¥ã€‘åœ¨ä¸‹å‚æœ¬ï¼Œæœ‰ä½•è´µå¹²ï¼Ÿ</p>
<p>ã€201604ã€‘ã€æ—¥ã€‘çº¿ä¸Šæ¸¸æˆçš„è€å©†ä¸å¯èƒ½æ˜¯å¥³ç”Ÿï¼Ÿ</p>
<p>ã€201604ã€‘ã€æ—¥ã€‘æˆ‘çš„è‹±é›„å­¦é™¢1</p>
<p>ã€201604ã€‘ã€æ—¥ã€‘æ–‡è±ªé‡çŠ¬1</p>
<p>ã€201604ã€‘ã€æ—¥ã€‘ç”²é“åŸçš„å¡å·´å†…ç‘</p>
<p>ã€201604ã€‘ã€æ—¥ã€‘Reï¼šä»é›¶å¼€å§‹çš„å¼‚ç•Œç”Ÿæ´»</p>
<p>ã€201604ã€‘ã€æ—¥ã€‘jojoçš„å¥‡å¦™å†’é™©4 ä¸ç­é’»çŸ³</p>
<p>ã€201601ã€‘ã€æ—¥ã€‘åªæœ‰æˆ‘ä¸åœ¨çš„è¡—é“</p>
<p>ã€201601ã€‘ã€æ—¥ã€‘æ— å¤´éª‘å£«å¼‚é—»å½• x2 ç»“</p>
<p>ã€201601ã€‘ã€æ—¥ã€‘ä¸ºç¾å¥½çš„ä¸–ç•ŒçŒ®ä¸Šç¥ç¦1</p>
<p>ã€201601ã€‘ã€æ—¥ã€‘ç°ä¸å¹»æƒ³çš„æ ¼æ—å§†è¿¦å°”</p>
<p>ã€201601ã€‘ã€å›½ã€‘äºšäºº1</p>
<h2 id="2015"><a class="header" href="#2015">2015</a></h2>
<p>ã€201510ã€‘ã€æ—¥ã€‘æ¨±å­å°å§çš„è„šä¸‹åŸ‹ç€å°¸ä½“</p>
<p>ã€201510ã€‘ã€æ—¥ã€‘é‡è‰¯ç¥ ARAGOTO</p>
<p>ã€201510ã€‘ã€æ—¥ã€‘æˆ‘è¢«ç»‘æ¶åˆ°è´µæ—å¥³æ ¡å½“åº¶æ°‘æ ·æœ¬</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘å­¦å›­å­¤å²›</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘æ— å¤´éª‘å£«å¼‚é—»å½• x2 è½¬</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘æˆ‘è€å©†æ˜¯å­¦ç”Ÿä¼šé•¿</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘å™¬ç¥è€…</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘ç»…å£«å­¦å›­</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘é»‘è¡—GANGSTA</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘å¹²ç‰©å¦¹ï¼å°åŸ‹</p>
<p>ã€201507ã€‘ã€æ—¥ã€‘OVERLORD1</p>
<p>ã€201504ã€‘ã€æ—¥ã€‘è¡€ç•Œæˆ˜çº¿1</p>
<p>ã€201504ã€‘ã€æ—¥ã€‘é£ŸæˆŸä¹‹çµ1</p>
<p>ã€201504ã€‘ã€æ—¥ã€‘å¹å“å§ï¼ä¸Šä½éŸ³å·</p>
<h2 id="2014"><a class="header" href="#2014">2014</a></h2>
<p>ã€201310ã€‘ã€æ—¥ã€‘å¯„ç”Ÿå…½</p>
<p>ã€201310ã€‘ã€æ—¥ã€‘è®°å½•çš„åœ°å¹³çº¿2</p>
<p>ã€201410ã€‘ã€æ—¥ã€‘å¢ƒç•Œè§¦å‘è€…1</p>
<p>ã€201404ã€‘ã€æ—¥ã€‘è¿›å‡»çš„å·¨äºº1</p>
<p>ã€201401ã€‘ã€æ—¥ã€‘é‡è‰¯ç¥1</p>
<h2 id="2013"><a class="header" href="#2013">2013</a></h2>
<p>ã€201310ã€‘ã€æ—¥ã€‘è®°å½•çš„åœ°å¹³çº¿1</p>
<p>ã€201310ã€‘ã€æ—¥ã€‘æ–©æœå°‘å¥³</p>
<p>ã€201307ã€‘ã€æ—¥ã€‘æ‹çˆ±ç ”ç©¶æ‰€</p>
<p>ã€201304ã€‘ã€æ—¥ã€‘æŸç§‘å­¦çš„è¶…ç”µç£ç‚®S</p>
<h2 id="2012"><a class="header" href="#2012">2012</a></h2>
<p>ã€201209ã€‘ã€æ—¥ã€‘æ¥è‡ªæ–°ä¸–ç•Œ</p>
<p>ã€201201ã€‘ã€æ—¥ã€‘Another</p>
<h2 id="2011"><a class="header" href="#2011">2011</a></h2>
<h2 id="2010"><a class="header" href="#2010">2010</a></h2>
<p>ã€201010ã€‘ã€æ—¥ã€‘é­”æ³•ç¦ä¹¦ç›®å½•2</p>
<h2 id="2009"><a class="header" href="#2009">2009</a></h2>
<p>ã€200910ã€‘ã€æ—¥ã€‘æŸç§‘å­¦çš„è¶…ç”µç£ç‚®</p>
<h2 id="2008"><a class="header" href="#2008">2008</a></h2>
<p>ã€200810ã€‘ã€æ—¥ã€‘é­”æ³•ç¦ä¹¦ç›®å½•1</p>
<h2 id="2007"><a class="header" href="#2007">2007</a></h2>
<p>ã€200704ã€‘ã€æ—¥ã€‘å¤§å‰‘</p>
<h2 id="2006"><a class="header" href="#2006">2006</a></h2>
<p>ã€200610ã€‘ã€æ—¥ã€‘æ­»äº¡ç¬”è®°</p>
<h2 id="1995"><a class="header" href="#1995">1995</a></h2>
<p>ã€199510ã€‘ã€æ—¥ã€‘æ–°ä¸–çºªç¦éŸ³æˆ˜å£«</p>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;Linux&quot;
description = &quot;Linux quick start&quot;
tags = [&quot;techn&quot;, &quot;computer&quot;, &quot;os&quot;, &quot;Linux&quot;, &quot;__quick_start&quot;]</p>
<p>+++</p>
<h1 id="linux"><a class="header" href="#linux">Linux</a></h1>
<blockquote>
<p><a href="https://www.kernel.org/">å®˜ç½‘</a>ï¼›</p>
<p><a href="https://git.kernel.org/">ä»“åº“</a>ï¼›</p>
<p><a href="https://en.wikipedia.org/wiki/Linus_Torvalds">Linus Torvalds</a>ï¼›</p>
</blockquote>
<h2 id="ubuntu"><a class="header" href="#ubuntu">Ubuntu</a></h2>
<blockquote>
<p><a href="https://mirrors.aliyun.com/ubuntu-releases/">ubuntu é˜¿é‡Œäº‘é•œåƒ</a>ï¼›</p>
</blockquote>
<h3 id="root-å¯†ç è®¾ç½®"><a class="header" href="#root-å¯†ç è®¾ç½®">root å¯†ç è®¾ç½®</a></h3>
<pre><code class="language-shell">sudo passwd

# ç™»å½•root
su root
</code></pre>
<h3 id="vi"><a class="header" href="#vi">vi</a></h3>
<pre><code class="language-shell"># vi é»˜è®¤æƒ…å†µä¸‹ä¸Šä¸‹å·¦å³ã€backspaceç­‰æŒ‰é”®éæ­£å¸¸ä½œç”¨ï¼Œé¡»é…ç½®`/etc/vim/vimrc.tiny`
cat &gt;&gt; /etc/vim/vimrc.tiny &lt;&lt; EOF

set nocompatible
set backspace=2
EOF
</code></pre>
<h3 id="å¿«é€Ÿå…³æœº"><a class="header" href="#å¿«é€Ÿå…³æœº">å¿«é€Ÿå…³æœº</a></h3>
<pre><code class="language-shell"># å¿«é€Ÿå…³æœº
sed -i '/#DefaultTimeoutStartSec=90s/aDefaultTimeoutStartSec=5s' /etc/systemd/system.conf
sed -i '/#DefaultTimeoutStopSec=90s/aDefaultTimeoutStopSec=5s' /etc/systemd/system.conf
</code></pre>
<h3 id="ç½‘å¡é…ç½®"><a class="header" href="#ç½‘å¡é…ç½®">ç½‘å¡é…ç½®</a></h3>
<pre><code class="language-shell"># ç³»ç»Ÿä¼šè¯»å– `/etc/netplan/*.yaml`
cat &gt;&gt; /etc/netplan/02.yaml &lt;&lt; EOF
network:
  version: 2
  renderer: NetworkManager
  ethernets:
    enp0s0:
      dhcp4: false
      # gateway4: 192.168.1.1
      routes:
      - to: default
        via: 192.168.1.1  # gateway, same as gateway4
      addresses:
      - 192.168.1.10/24
      nameservers:
        addresses: [192.168.1.1,8.8.8.8] # DNS
        search: []
    enp0s3:
      dhcp4: false
      # gateway4: 192.168.31.1
      routes:
      - to: 192.168.31.0/24
        via: 192.168.31.1  # gateway, same as gateway4
      addresses:
      - 192.168.31.10/24
      nameservers:
        addresses: [192.168.31.1,8.8.8.8] # DNS
        search: []
EOF

# åº”ç”¨é…ç½®
netplan apply
</code></pre>
<h3 id="apt-æº"><a class="header" href="#apt-æº">apt æº</a></h3>
<pre><code class="language-shell">$ mv /etc/apt/sources.list /etc/apt/sources.list.bk
$ cat &gt; /etc/apt/sources.list &lt;&lt; EOF
deb http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse
EOF
# æ›´æ–°æº
$ apt update
</code></pre>
<h3 id="ssh-æœåŠ¡å¯ç”¨"><a class="header" href="#ssh-æœåŠ¡å¯ç”¨">ssh æœåŠ¡å¯ç”¨</a></h3>
<pre><code class="language-shell"># å®‰è£…
apt install -y openssh-server
# é»˜è®¤ç¦æ­¢è¿œç¨‹ç™»å½•ï¼Œéœ€ /etc/ssh/sshd_config ä¸­ PermitRootLogin å­—æ®µ
sed -i '/#PermitRootLogin prohibit-password/aPermitRootLogin yes' /etc/ssh/sshd_config
# é‡å¯
systemctl restart sshd
</code></pre>
<h3 id="http-ä»£ç†"><a class="header" href="#http-ä»£ç†">http ä»£ç†</a></h3>
<h3 id="https-è®¿é—®"><a class="header" href="#https-è®¿é—®">https è®¿é—®</a></h3>
<pre><code class="language-shell">apt install -y ca-certificates curl gnupg
</code></pre>
<h3 id="root-å›¾å½¢ç•Œé¢ç™»å½•"><a class="header" href="#root-å›¾å½¢ç•Œé¢ç™»å½•">root å›¾å½¢ç•Œé¢ç™»å½•</a></h3>
<pre><code class="language-shell"># ubuntuæ¡Œé¢ç‰ˆä¸å…è®¸å›¾å½¢ç•Œé¢ç™»å½•rootç”¨æˆ·ï¼Œé¡»æ³¨é‡Š`/etc/pam.d/gdm-password`&amp;`/etc/pam.d/gdm-autologin`æ–‡ä»¶ä¸­ auth required pam_succeed_if.so user != root quiet_success æ‰€åœ¨è¡Œ
sed -i 's/auth.*required.*pam_succeed_if.so user != root quiet_success/# auth\trequired\tpam_succeed_if.so user != root quiet_success/g' /etc/pam.d/gdm-password
sed -i 's/auth.*required.*pam_succeed_if.so user != root quiet_success/# auth\trequired\tpam_succeed_if.so user != root quiet_success/g' /etc/pam.d/gdm-autologin
</code></pre>
<h3 id="ç”¨æˆ·æ–‡ä»¶å¤¹"><a class="header" href="#ç”¨æˆ·æ–‡ä»¶å¤¹">ç”¨æˆ·æ–‡ä»¶å¤¹</a></h3>
<p>æŒ‡å®šDesktopã€Downloadsç­‰</p>
<pre><code class="language-shell">sed -i 's/XDG_DESKTOP_DIR=.*/XDG_DESKTOP_DIR=&quot;$HOME\/dirs\/Desktop&quot;/g' ~/.config/user-dirs.dirs
sed -i 's/XDG_DOWNLOAD_DIR=.*/XDG_DOWNLOAD_DIR=&quot;$HOME\/dirs\/Downloads&quot;/g' ~/.config/user-dirs.dirs
sed -i 's/XDG_TEMPLATES_DIR=.*/XDG_TEMPLATES_DIR=&quot;$HOME\/dirs\/Templates&quot;/g' ~/.config/user-dirs.dirs
sed -i 's/XDG_PUBLICSHARE_DIR=.*/XDG_PUBLICSHARE_DIR=&quot;$HOME\/dirs\/Public&quot;/g' ~/.config/user-dirs.dirs
sed -i 's/XDG_DOCUMENTS_DIR=.*/XDG_DOCUMENTS_DIR=&quot;$HOME\/dirs\/Documents&quot;/g' ~/.config/user-dirs.dirs
sed -i 's/XDG_MUSIC_DIR=.*/XDG_MUSIC_DIR=&quot;$HOME\/dirs\/Music&quot;/g' ~/.config/user-dirs.dirs
sed -i 's/XDG_PICTURES_DIR=.*/XDG_PICTURES_DIR=&quot;$HOME\/dirs\/Pictures&quot;/g' ~/.config/user-dirs.dirs
sed -i 's/XDG_VIDEOS_DIR=.*/XDG_VIDEOS_DIR=&quot;$HOME\/dirs\/Videos&quot;/g' ~/.config/user-dirs.dirs
# ç°åœ¨ä½¿ç”¨
nautilus -q
</code></pre>
<h2 id="centos"><a class="header" href="#centos">CentOS</a></h2>
<blockquote>
<p><a href="https://mirrors.aliyun.com/ubuntu-releases/">centosé˜¿é‡Œäº‘é•œåƒ</a>ï¼›</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;eBPF&quot;
description = &quot;it.os.linux.eBPF&quot;
tags = [&quot;it&quot;,&quot;os&quot;,&quot;linux&quot;]</p>
<p>+++</p>
<h1 id="ebpf"><a class="header" href="#ebpf">eBPF</a></h1>
<blockquote>
<p><a href="https://ebpf.io/">å®˜ç½‘</a>ï¼›</p>
<p><a href="https://cilium.readthedocs.io/en/stable/bpf/">eBPF å’Œ XDP å‚è€ƒæŒ‡å—</a> &amp; <a href="https://arthurchiao.art/blog/cilium-bpf-xdp-reference-guide-zh/">ç¿»è¯‘</a>ï¼›</p>
<p><a href="https://man7.org/linux/man-pages/man7/bpf-helpers.7.html">bpf-helpers</a>ï¼›</p>
<p><a href="https://arthurchiao.art/blog/bpf-advanced-notes-1-zh/">BPF ç¨‹åºç±»å‹è¯¦è§£</a>ï¼›</p>
<p><a href="https://arthurchiao.art/blog/bpf-advanced-notes-2-zh/">BPF Map ç±»å‹è¯¦è§£</a>ï¼›</p>
<p><a href="%E8%AE%A1/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/iovisor/bcc">iovisor/bcc</a>ï¼›</p>
<p>ä½¿ç”¨ python å¼€å‘ eBPF ç¨‹åºï¼›</p>
<p><a href="%E8%AE%A1/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/cilium/ebpf">cilium/ebpf</a>ï¼›</p>
<p><a href="https://github.com/iovisor/gobpf">iovisor/gobpf</a>ï¼›</p>
<p><a href="https://www.sobyte.net/post/2022-04/go-ebfp/">ä½¿ç”¨ Go è¯­è¨€å¼€å‘ eBPF ç¨‹åº</a>ï¼›</p>
</blockquote>
<h2 id="ç®€ä»‹"><a class="header" href="#ç®€ä»‹">ç®€ä»‹</a></h2>
<blockquote>
<p><a href="https://ebpf.io/what-is-ebpf#introduction-to-ebpf">eBPFç®€ä»‹</a>ï¼›</p>
</blockquote>
<p><img src="https://ebpf.io/static/go-1a1bb6f1e64b1ad5597f57dc17cf1350.png" alt="" /></p>
<h2 id="è¿‡ç¨‹"><a class="header" href="#è¿‡ç¨‹">è¿‡ç¨‹</a></h2>
<p><img src="%E8%AE%A1/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/./img/Linux.eBPF.%E8%BF%87%E7%A8%8B.svg" alt="" /></p>
<h2 id="æŠ€æœ¯æ ˆ"><a class="header" href="#æŠ€æœ¯æ ˆ">æŠ€æœ¯æ ˆ</a></h2>
<blockquote>
<p><a href="http://arthurchiao.art/blog/bpf-portability-and-co-re-zh/">[è¯‘] BPF å¯ç§»æ¤æ€§å’Œ CO-RE (compile once - run everywhere)</a>ï¼›<a href="https://facebookmicrosites.github.io/bpf/blog/2020/02/19/bpf-portability-and-co-re.html">BPF Portability and CO-RE</a>ï¼›</p>
</blockquote>
<p><img src="%E8%AE%A1/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/./img/Linux.eBPF.%E6%8A%80%E6%9C%AF%E6%A0%88.svg" alt="" /></p>
<h2 id="co-re"><a class="header" href="#co-re">CO-RE</a></h2>
<h3 id="btf"><a class="header" href="#btf">BTF</a></h3>
<p>æ£€æŸ¥BTFå¼€å¯</p>
<pre><code class="language-shell">$ cat /boot/config-`uname -r` | grep BTF
CONFIG_VIDEO_SONY_BTF_MPX=m
CONFIG_DEBUG_INFO_BTF=y
CONFIG_PAHOLE_HAS_SPLIT_BTF=y
CONFIG_DEBUG_INFO_BTF_MODULES=y
</code></pre>
<h3 id="vmlinuxh"><a class="header" href="#vmlinuxh">vmlinux.h</a></h3>
<pre><code class="language-shell"># ç”Ÿæˆvmlinux.h
$ bpftool btf dump file /sys/kernel/btf/vmlinux format c &gt; vmlinux.h
</code></pre>
<h2 id="bpf-prog"><a class="header" href="#bpf-prog">BPF prog</a></h2>
<pre><code class="language-c">#include &quot;vmlinux.h&quot;

#include &lt;bpf/bpf_helpers.h&gt;
#include &lt;bpf/bpf_tracing.h&gt;

SEC(&quot;&lt;bpf_type&gt;/&lt;trace_name&gt;&quot;)
int kprobe__do_sys_openat2(struct pt_regs *ctx)
{
    char file_name[256];
    bpf_probe_read(file_name, sizeof(file_name), PT_REGS_PARM2(ctx));

    char fmt[] = &quot;open file %s\n&quot;;
    bpf_trace_printk(fmt, sizeof(fmt), &amp;file_name);

    return 0;
}
</code></pre>
<p>vmlinux.hï¼šè§CO-RE vmlinux.h</p>
<p>bpf_typeï¼šä¸åŒçš„ç±»å‹æœ‰ä¸åŒçš„ä½¿ç”¨æ–¹å¼å’Œé™åˆ¶ï¼Œè¯¦è§ä¸‹é¢<a href="%E8%AE%A1/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Linux.eBPF.html#eBPF%E7%B1%BB%E5%9E%8B">eBPFç±»å‹</a>ã€‚</p>
<p>trace_nameï¼šå¯¹äº</p>
<h3 id="ç¼–è¯‘"><a class="header" href="#ç¼–è¯‘">ç¼–è¯‘</a></h3>
<pre><code class="language-makefile"></code></pre>
<h3 id="ç±»å‹"><a class="header" href="#ç±»å‹">ç±»å‹</a></h3>
<h3 id="kprobes"><a class="header" href="#kprobes">kprobes</a></h3>
<pre><code class="language-c">#include &quot;vmlinux.h&quot;

#include &lt;bpf/bpf_helpers.h&gt;
#include &lt;bpf/bpf_tracing.h&gt;

SEC(&quot;kprobe/do_sys_openat2&quot;)
int kprobe__do_sys_openat2(struct pt_regs *ctx)
{
    char file_name[256];
    bpf_probe_read(file_name, sizeof(file_name), PT_REGS_PARM2(ctx));

    char fmt[] = &quot;open file %s\n&quot;;
    bpf_trace_printk(fmt, sizeof(fmt), &amp;file_name);

    return 0;
}
</code></pre>
<h3 id="tracepoint"><a class="header" href="#tracepoint">tracepoint</a></h3>
<h3 id="raw_tracepoint"><a class="header" href="#raw_tracepoint">raw_tracepoint</a></h3>
<h2 id="bpf-map"><a class="header" href="#bpf-map">BPF map</a></h2>
<h2 id="vmlinux"><a class="header" href="#vmlinux">vmlinux</a></h2>
<h2 id="libbpfgo"><a class="header" href="#libbpfgo">libbpfgo</a></h2>
<blockquote>
<p><a href="https://github.com/aquasecurity/libbpfgo">aquasecurity/libbpfgo</a>ï¼šä¸€ä¸ªé€šè¿‡cgoè°ƒç”¨libbpfåº“çš„goè¯­è¨€å°è£…ã€‚</p>
<p><a href="https://mozillazg.com/2022/05/ebpf-libbpfgo-develop-env-and-hello-world.html">libbpfgo ä½¿ç”¨ç¤ºä¾‹ï¼šæ­å»ºå¼€å‘ç¯å¢ƒä»¥åŠç¼–å†™ç¬¬ä¸€ä¸ª ebpf ç¨‹åº</a>ï¼›</p>
<p><a href="https://libbpf.readthedocs.io/en/latest/program_types.html">æ–‡æ¡£</a>ï¼›</p>
</blockquote>
<h3 id="ä¾èµ–"><a class="header" href="#ä¾èµ–">ä¾èµ–</a></h3>
<pre><code class="language-shell"># å®‰è£…ï¼šclang llvm elf bpftool
$ apt install -y clang llvm libelf-dev linux-tools-common
# æ‰§è¡Œï¼šä»æ”¶åˆ°ä»¥ä¸‹æç¤º
$ bpftool 
WARNING: bpftool not found for kernel 5.15.0-52

  You may need to install the following packages for this specific kernel:
    linux-tools-5.15.0-52-generic
    linux-cloud-tools-5.15.0-52-generic

  You may also want to install one of the following packages to keep up to date:
    linux-tools-generic
    linux-cloud-tools-generic
# å®‰è£…
$ apt install -y linux-tools-5.15.0-52-generic
</code></pre>
<h3 id="makefile"><a class="header" href="#makefile">Makefile</a></h3>
<pre><code class="language-makefile">ROOT = ./
OUTPUT = ./build

$(OUTPUT):
	mkdir -p $(OUTPUT)

# ---------------- vmlinuxh
# vmlinuxh: vmlinux header file, generated by
# `bpftool btf dump file /sys/kernel/btf/vmlinux format c &gt; OUTPUT/vmlinux.h`
.PHONY: vmlinuxh
VMLINUXH = $(OUTPUT)/vmlinux.h
BPFTOOL = $(shell which bpftool || /bin/false)
BTFFILE = /sys/kernel/btf/vmlinux
DBGVMLINUX = /usr/lib/debug/boot/vmlinux-$(shell uname -r)

vmlinuxh: $(VMLINUXH)
$(VMLINUXH): $(OUTPUT)
ifeq ($(wildcard $(BPFTOOL)),)
	@echo &quot;ERROR: could not find bpftool&quot;
	@exit 1
endif
	@if [ -f $(DBGVMLINUX) ]; then \
		echo &quot;INFO: found dbg kernel, generating $(VMLINUXH) from $(DBGVMLINUX)&quot;; \
		$(BPFTOOL) btf dump file $(DBGVMLINUX) format c &gt; $(VMLINUXH); \
	fi
	@if [ ! -f $(BTFFILE) ] &amp;&amp; [ ! -f $(DBGVMLINUX) ]; then \
		echo &quot;ERROR: kernel does not seem to support BTF&quot;; \
		exit 1; \
	fi
	@if [ ! -f $(VMLINUXH) ]; then \
		echo &quot;INFO: generating $(VMLINUXH) from $(BTFFILE)&quot;; \
		$(BPFTOOL) btf dump file $(BTFFILE) format c &gt; $(VMLINUXH); \
	fi

# ---------------- c
# C
CC = gcc
CFLAGS = -ggdb -gdwarf -O2 -Wall -fpie -Wno-unused-variable -Wno-unused-function

# ---------------- libbpf
# libbpf: default static libbpf
LIBBPF_SRC = $(abspath ./3rdparty/libbpf/src)
LIBBPF_DST = $(abspath $(OUTPUT)/libbpf)
GIT = $(shell which git || /bin/false)

$(LIBBPF_SRC):
ifeq ($(wildcard $@), )
	echo &quot;INFO: updating submodule 'libbpf'&quot;
	$(GIT) submodule update --init --recursive
endif
$(LIBBPF_DST):
	mkdir -p $(LIBBPF_DST)

.PHONY: libbpf
libbpf: libbpf-static

# ---------------- ---------------- libbpf static
# libbpf static: static libbpf generation for the git submodule
LIBBPF_DESTDIR = $(abspath $(OUTPUT))
LIBBPF_OBJDIR = $(abspath $(OUTPUT)/libbpf)
LIBBPF_OBJ = $(abspath $(LIBBPF_OBJDIR)/libbpf.a)
LDFLAGS =

.PHONY: libbpf-static
libbpf-static: $(LIBBPF_OBJ)
$(LIBBPF_OBJ): $(LIBBPF_SRC) $(wildcard $(LIBBPF_SRC)/*.[ch]) | $(LIBBPF_DST)
	CC=&quot;$(CC)&quot; CFLAGS=&quot;$(CFLAGS)&quot; LD_FLAGS=&quot;$(LDFLAGS)&quot; \
	$(MAKE) -C $(LIBBPF_SRC) \
		BUILD_STATIC_ONLY=1 \
		DESTDIR=$(LIBBPF_DESTDIR) \
		OBJDIR=$(LIBBPF_OBJDIR) \
		INCLUDEDIR= LIBDIR= UAPIDIR= prefix= libdir= \
		install

# ---------------- ---------------- libbpf dynamic
# libbpf dynamic:
CGO_CFGLAGS_DYN = &quot;-I. -I/usr/include/&quot;
CGO_LDFLAGS_DYN = &quot;-lelf -lz -lbpf&quot;
CGO_EXTLDFLAGS_DYN = '-w'

.PHONY: libbpf-dynamic
libbpf-dynamic:
	echo nothing

# ---------------- program
PROGRAM = ytrace

# ---------------- bpf program
# bpf prog: clang -O2 -Wall -target bpf
CLANG = clang
BPF_SRC = $(abspath $(ROOT)/pkg/bpf)
BPF_CFLAGS_STATIC = &quot;-I$(abspath $(OUTPUT))&quot;
BPF_LDFLAGS_STATIC = &quot;-lelf -lz $(LIBBPF_OBJ)&quot;

.PHONY: $(PROGRAM).bpf.c
$(PROGRAM).bpf.o: $(PROGRAM).bpf.c | vmlinuxh
	$(CLANG) -D__TARGET_ARCH_x86 \
		$(CFLAGS) -target bpf -I. -I$(OUTPUT) \
		-c $&lt; -o $@

# ---------------- go program
# go prog
OS := $(shell uname -s)
ARCH := $(shell uname -m)
ARCH := $(subst x86_64,amd64,$(ARCH))
GOARCH := $(ARCH)
CGO_CFLAGS_STATIC = &quot;-I$(abspath $(OUTPUT))&quot;
CGO_LDFLAGS_STATIC = &quot;-lelf -lz $(LIBBPF_OBJ)&quot;
CGO_EXTLDFLAGS_STATIC = '-w -extldflags &quot;-static&quot;'

.PHONY: $(PROGRAM)
$(PROGRAM): libbpf | $(PROGRAM).bpf.o
	CC=$(CLANG) GOOS=linux GOARCH=$(GOARCH) \
	CGO_CFLAGS=$(CGO_CFLAGS_STATIC) CGO_LDFLAGS=$(CGO_LDFLAGS_STATIC) \
	go build -tags netgo -ldflags $(CGO_EXTLDFLAGS_STATIC) \
		-o $(PROGRAM) ./$(PROGRAM).go

# ---------------- all
all:
	$(MAKE) -C . $(PROGRAM)

# ---------------- clean
clean:
	$(MAKE) -C $(LIBBPF_SRC) clean
	rm -rf $(OUTPUT)
	rm -rf $(VMLINUXH)
	rm -rf $(PROGRAM) $(PROGRAM)-*static $(PROGRAM)-*dynamic
	rm -rf $(PROGRAM).bpf.o $(PROGRAM).o

</code></pre>
<p>ebpf/c/</p>
<pre><code class="language-c">#include &quot;vmlinux.h&quot;

#include &lt;bpf/bpf_helpers.h&gt;
#include &lt;bpf/bpf_tracing.h&gt;

SEC(&quot;kprobe/do_sys_openat2&quot;)
int kprobe__do_sys_openat2(struct pt_regs *ctx)
{
    char file_name[256];
    bpf_probe_read(file_name, sizeof(file_name), PT_REGS_PARM2(ctx));

    char fmt[] = &quot;open file %s\n&quot;;
    bpf_trace_printk(fmt, sizeof(fmt), &amp;file_name);

    return 0;
}
</code></pre>
<pre><code class="language-shell">clang -D__TARGET_ARCH_x86 -I. -I../c/  -target bpf -c bpf.o.c -o bpf.o
</code></pre>
<h2 id="å®éªŒåŸºäº-ebpf-çš„ç½‘ç»œè§‚æµ‹"><a class="header" href="#å®éªŒåŸºäº-ebpf-çš„ç½‘ç»œè§‚æµ‹">å®éªŒï¼šåŸºäº eBPF çš„ç½‘ç»œè§‚æµ‹</a></h2>
<blockquote>
<p><a href="https://blog.csdn.net/flynetcn/article/details/119487894">Linuxç½‘ç»œæ–°æŠ€æœ¯åŸºçŸ³ï¼šeBPF and XDP</a>ï¼›</p>
</blockquote>
<h2 id="traceeäºŒæ¬¡å¼€å‘"><a class="header" href="#traceeäºŒæ¬¡å¼€å‘">traceeäºŒæ¬¡å¼€å‘</a></h2>
<blockquote>
<p><a href="https://github.com/aquasecurity/tracee">aquasecurity/tracee</a>ï¼šä½¿ç”¨ Linux <strong>eBPF æŠ€æœ¯</strong>åœ¨è¿è¡Œæ—¶<strong>è·Ÿè¸ªæ‚¨çš„ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºï¼Œå¹¶åˆ†ææ”¶é›†çš„äº‹ä»¶ä»¥æ£€æµ‹</strong>å¯ç–‘çš„è¡Œä¸ºæ¨¡å¼ã€‚</p>
<p>tracee ä¾èµ–äº libbpf</p>
</blockquote>
<h3 id="libbpf"><a class="header" href="#libbpf">libbpf</a></h3>
<blockquote>
<p><a href="https://github.com/libbpf/libbpf">libbpf</a>ï¼šå¯ä»¥æ„å»ºæ”¯æŒ <a href="https://github.com/libbpf/libbpf#bpflibbpf-usage-and-questions">BPF CO-RE(Compile Once â€“ Run Everywhere)</a> çš„é«˜å¯ç§»æ¤æ€§ BPF ç¨‹åºã€‚ä¸ <a href="https://github.com/iovisor/bcc/">BCC</a> ç›¸æ¯”ï¼Œå®ƒä¸éœ€è¦å°† Clang/LLVM è¿è¡Œæ—¶éƒ¨ç½²åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå¹¶ä¸”ä¸ä¾èµ–äºå¯ç”¨çš„å†…æ ¸å¼€å‘å¤´æ–‡ä»¶ã€‚</p>
<p>BTFï¼šlibbpf ä¾èµ–äºå†…æ ¸ BTFï¼ŒRHEL 8.2+ã€Ubuntu 20.10 ç­‰å‘è¡Œç‰ˆéƒ½å·²ç»å†…ç½®å†…æ ¸ BTFï¼›å†…æ ¸ BTF éœ€è¦åœ¨<strong>ç¼–è¯‘</strong>å†…æ ¸æ—¶è®¾ç½®<code>CONFIG_DEBUG_INFO_BTF=y</code>æ„å»ºé€‰é¡¹ï¼›é€šè¿‡æŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ–‡ä»¶<code>/sys/kernel/btf/vmlinux</code>ä»¥æ£€æŸ¥å†…æ ¸æ˜¯å¦å†…ç½® BTF</p>
</blockquote>
<p>å®‰è£…</p>
<pre><code class="language-shell"># 

# libbpf åœ¨ tracee é¡¹ç›® make ä¸­çš„å®‰è£…æ–¹å¼
CC=&quot;clang&quot; \
CFLAGS=&quot;&quot;-fPIC&quot;&quot; \
LD_FLAGS=&quot;&quot; \
make \
-C ./3rdparty/libbpf/src \
BUILD_STATIC_ONLY=1 \
DESTDIR=/root/projects/github.com/tracee/dist/libbpf \
OBJDIR=/root/projects/github.com/tracee/dist/libbpf/obj \
INCLUDEDIR= LIBDIR= UAPIDIR= prefix= libdir= \
install install_uapi_headers
</code></pre>
<h3 id="å¯åŠ¨æµç¨‹"><a class="header" href="#å¯åŠ¨æµç¨‹">å¯åŠ¨æµç¨‹</a></h3>
<h3 id="è¿½è¸ªæµç¨‹"><a class="header" href="#è¿½è¸ªæµç¨‹">è¿½è¸ªæµç¨‹</a></h3>
<h3 id="å®ç°æ–°çš„è¿½è¸ª"><a class="header" href="#å®ç°æ–°çš„è¿½è¸ª">å®ç°æ–°çš„è¿½è¸ª</a></h3>
<p>tracee å®ç°äº† vfs_write è¿½è¸ªä½†å¹¶æ²¡æœ‰å®ç° vfs_read è¿½è¸ªï¼Œè¿™é‡Œå‚è€ƒ vfs_write è¿½è¸ª<strong>å®ç° vfs_read è¿½è¸ª</strong>ã€‚å¾—ç›Šäº tracee çš„ä»£ç å¯æ‰©å±•æ€§ï¼Œåªéœ€è¦å¦‚ä¸‹ä¸¤æ­¥ï¼š</p>
<ol>
<li>åœ¨ go ä»£ç ä¸­æ·»åŠ  vfs_read äº‹ä»¶å®šä¹‰</li>
</ol>
<pre><code class="language-go">// pkg/events/events.go

const (
	VfsRead  // æ·»åŠ  vfs_read äº‹ä»¶ID
    VfsWrite
)

var Definitions = eventDefinitions{
	events: map[ID]Event{
        // å‚è€ƒ VfsWrite å®šä¹‰å®ç° VfsRead å®šä¹‰
        VfsRead: {
			ID32Bit: sys32undefined,
			Name:    &quot;vfs_read&quot;,
			Probes: []probeDependency{
				{Handle: probes.VfsRead, Required: true},
				{Handle: probes.VfsReadRet, Required: true},
			},
			Sets: []string{},
			Params: []trace.ArgMeta{
				{Type: &quot;const char*&quot;, Name: &quot;pathname&quot;},
				{Type: &quot;dev_t&quot;, Name: &quot;dev&quot;},
				{Type: &quot;unsigned long&quot;, Name: &quot;inode&quot;},
				{Type: &quot;size_t&quot;, Name: &quot;count&quot;},
				{Type: &quot;off_t&quot;, Name: &quot;pos&quot;},
				{Type: &quot;unsigned int&quot;, Name: &quot;flags&quot;}, // é¡ºæ‰‹æ·»åŠ ä¸€ä¸ª flags
			},
		},
        VfsWrite: { /*...*/ },
    }
}
</code></pre>
<pre><code class="language-go">// pkg/ebpf/probes/probes.go

const (
	VfsRead    // æ·»åŠ å…¥å‚å¤„ç†æ ‡è¯†
    VfsReadRet // æ·»åŠ å‡ºå‚å¤„ç†æ ‡è¯†
	VfsWrite
	VfsWriteRet
)

// Init initializes a Probes interface
func Init(module *bpf.Module, netEnabled bool) (Probes, error) {
	allProbes := map[Handle]Probe{
		VfsRead:                   &amp;traceProbe{eventName: &quot;vfs_read&quot;, probeType: kprobe, programName: &quot;trace_vfs_read&quot;},        // æ³¨å†Œå…¥å‚æ¢é’ˆ
		VfsReadRet:                &amp;traceProbe{eventName: &quot;vfs_read&quot;, probeType: kretprobe, programName: &quot;trace_ret_vfs_read&quot;}, // æ³¨å†Œå‡ºå‚æ¢é’ˆ
		VfsWrite:                   &amp;traceProbe{eventName: &quot;vfs_write&quot;, probeType: kprobe, programName: &quot;trace_vfs_write&quot;},
		VfsWriteRet:                &amp;traceProbe{eventName: &quot;vfs_write&quot;, probeType: kretprobe, programName: &quot;trace_ret_vfs_write&quot;},
    }
}
</code></pre>
<ol start="2">
<li>ç¼–å†™ bpf ä»£ç </li>
</ol>
<pre><code class="language-c">// pkg/ebpf/c/tracee.bpf.c

enum tail_call_id_e // åŸæœ‰å†…å®¹
{
    TAIL_VFS_READ,
    TAIL_VFS_WRITE, // åŸæœ‰å†…å®¹
}

enum event_id_e // åŸæœ‰å†…å®¹
{
    VFS_READ,
    VFS_WRITE, // åŸæœ‰å†…å®¹
}

// å‚è€ƒæ–¹æ³• get_inode_nr_from_fileï¼Œé€šè¿‡å® READ_KERN è·å–ï¼Œå¦åˆ™å°†æŠ¥é”™å¯„å­˜å™¨å†…å­˜æœªåˆå§‹åŒ–
static __always_inline unsigned int get_flags_from_file(struct file *file)
{
    return READ_KERN(file-&gt;f_flags);
}

static __always_inline int
do_file_read_operation(struct pt_regs *ctx, u32 event_id, u32 tail_call_id)
{
    args_t saved_args;
    if (load_args(&amp;saved_args, event_id) != 0) {
        // missed entry or not traced
        return 0;
    }

    int zero = 0;
    config_entry_t *config = bpf_map_lookup_elem(&amp;config_map, &amp;zero);
    if (config == NULL)
        return 0;

    if (!should_submit(VFS_READ, config)) {
        bpf_tail_call(ctx, &amp;prog_array, tail_call_id);
        return 0;
    }

    loff_t start_pos;
    void *ptr;
    struct iovec *vec;
    size_t count;

    struct file *file = (struct file *) saved_args.args[0];
    void *file_path = get_path_str(GET_FIELD_ADDR(file-&gt;f_path));
    unsigned int flags = get_flags_from_file(file); // é¡ºæ‰‹åŠ ä¸ª flags

    ptr = (void *) saved_args.args[1];
    count = (size_t) saved_args.args[2];
    loff_t *pos = (loff_t *) saved_args.args[3];

    // Extract device id, inode number, and pos (offset)
    dev_t s_dev = get_dev_from_file(file);
    unsigned long inode_nr = get_inode_nr_from_file(file);
    bpf_probe_read(&amp;start_pos, sizeof(off_t), pos);

    bool char_dev = (start_pos == 0);
    u32 bytes_read = PT_REGS_RC(ctx);

    // Calculate read start offset
    if (start_pos != 0)
        start_pos -= bytes_read;

    event_data_t data = {};
    if (!init_event_data(&amp;data, ctx))
        return 0;

    if (should_submit(VFS_READ, data.config)) {
        save_str_to_buf(&amp;data, file_path, 0);
        save_to_submit_buf(&amp;data, &amp;s_dev, sizeof(dev_t), 1);
        save_to_submit_buf(&amp;data, &amp;inode_nr, sizeof(unsigned long), 2);
        save_to_submit_buf(&amp;data, &amp;count, sizeof(size_t), 3);
        save_to_submit_buf(&amp;data, &amp;start_pos, sizeof(off_t), 4);
        save_to_submit_buf(&amp;data, &amp;flags, sizeof(int), 5); // flags

        // Submit vfs_read(v) event
        events_perf_submit(&amp;data, event_id, PT_REGS_RC(ctx));
    }

    bpf_tail_call(ctx, &amp;prog_array, tail_call_id);
    return 0;
}

SEC(&quot;kprobe/vfs_read&quot;)
TRACE_ENT_FUNC(vfs_read, VFS_READ);

SEC(&quot;kretprobe/vfs_read&quot;)
int BPF_KPROBE(trace_ret_vfs_read)
{
    return do_file_read_operation(ctx, VFS_READ, TAIL_VFS_READ);
}
</code></pre>
<p>é‡æ–°ç¼–è¯‘å¹¶æ‰§è¡Œ</p>
<pre><code class="language-shell">$ make
make ./dist/tracee.bpf
clang \
	-D__TARGET_ARCH_x86 \
	-D__BPF_TRACING__ \
	-DCORE \
	-I./pkg/ebpf/c/ \
	-I./dist/tracee.bpf \
	-target bpf \
	-O2 -g \
	-march=bpf -mcpu=v2 \
	-c ./pkg/ebpf/c/tracee.bpf.c \
	-o dist/tracee.bpf.core.o
make ./dist/btfhub
make btfhub
GOOS=linux CC=clang GOARCH=amd64 CGO_CFLAGS=&quot;-I/root/projects/github.com/tracee/dist/libbpf&quot; CGO_LDFLAGS=&quot;-lelf  -lz  /root/projects/github.com/tracee/dist/libbpf/libbpf.a&quot; go build \
	-tags core,ebpf \
	-ldflags=&quot;-w \
		-extldflags \&quot;\&quot; \
		-X main.version=\&quot;v0.8.0\&quot; \
		&quot; \
	-v -o dist/tracee-ebpf \
	./cmd/tracee-ebpf
make[1]: â€œdist/btfhubâ€å·²æ˜¯æœ€æ–°ã€‚
make[1]: å¯¹â€œbtfhubâ€æ— éœ€åšä»»ä½•äº‹ã€‚
github.com/aquasecurity/tracee
github.com/aquasecurity/tracee/pkg/events
github.com/aquasecurity/tracee/pkg/events/derive
github.com/aquasecurity/tracee/pkg/bufferdecoder
github.com/aquasecurity/tracee/pkg/ebpf
github.com/aquasecurity/tracee/cmd/tracee-ebpf/internal/flags
github.com/aquasecurity/tracee/cmd/tracee-ebpf

$ ./dist/tracee-ebpf --trace event=vfs_read
TIME             UID    COMM             PID     TID     RET              EVENT                ARGS
22:14:26:651850  0      kubelet          17433   17433   549              vfs_read             pathname: /etc/selinux/config, dev: 265289728, inode: 51223044, count: 4096, pos: 0, flags: 32768
...
</code></pre>
<h3 id="å®¹å™¨è¿è¡Œ"><a class="header" href="#å®¹å™¨è¿è¡Œ">å®¹å™¨è¿è¡Œ</a></h3>
<p>builder ç›®å½•ä¸­æä¾›äº†ä¸€äº› Makefile &amp; Dockerfile</p>
<h3 id="è‡ªå®šä¹‰å®¹å™¨è¿è¡Œ"><a class="header" href="#è‡ªå®šä¹‰å®¹å™¨è¿è¡Œ">è‡ªå®šä¹‰å®¹å™¨è¿è¡Œ</a></h3>
<p>tracee æä¾›çš„ Makefile &amp; Dockerfile ä¸­åšäº†å¾ˆå¤šäº‹æƒ…ï¼ŒåŒ…æ‹¬åœ¨å®¹å™¨ä¸­ä¸‹è½½ä¸€äº›ç¼–è¯‘æ‰§è¡Œä¾èµ–ã€‚ä½†æˆ‘æ›´æƒ³è®© tracee-ebpf å¯æ‰§è¡Œæ–‡ä»¶æ‹·è´åˆ°æˆ‘è‡ªå·±è‡ªå®šä¹‰çš„å®¹å™¨ä¸­ç›´æ¥è¿è¡Œ</p>
<ol>
<li>ç¼–å†™ makefile.minimal</li>
</ol>
<pre><code class="language-makefile">.PHONY: build-binary build-container run-container clean

build-binary:
	GOOS=linux CC=clang GOARCH=amd64 CGO_CFLAGS=&quot;-I/root/projects/github.com/tracee/dist/libbpf&quot; CGO_LDFLAGS=&quot;-lelf  -lz  /root/projects/github.com/tracee/dist/libbpf/libbpf.a&quot; go build \
    	-tags core,ebpf \
    	-ldflags=&quot;-w \
    		-extldflags \&quot;\&quot; \
    		-X main.version=\&quot;v0.8.0\&quot; \
    		&quot; \
    	-v -o bin/tracee-ebpf \
    	./cmd/tracee-ebpf

build-container: build-binary
	docker build -f Dockerfile.minimal -t tracee-minimal:0.1 .

run-container: build-container
	docker run -it --name tracee-minimal tracee-minimal:0.1

clean:
	docker rm tracee-minimal
	docker rmi tracee-minimal:0.1
</code></pre>
<ol start="2">
<li>ç¼–å†™ dockerfile.minimal</li>
</ol>
<pre><code class="language-dockerfile">FROM alpine:3.15

# å› ä¸º bpf ç¨‹åºä¾èµ–äºä¸€äº› so åº“ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦ä¸€ä¸€æ‹·è´
COPY /usr/lib64/libelf.so.1 /lib64/libelf.so.1

COPY bin/tracee-ebpf /tracee/tracee-ebpf

ENTRYPOINT [&quot;sh&quot;,&quot;-c&quot;,&quot;/tracee/tracee-ebpf --trace container --trace event=vfs_write --trace event=vfs_read&quot;]
</code></pre>
<p>æµ‹è¯•è¿è¡Œ</p>
<pre><code class="language-shell">$ make -f Makefile.minimal run-container
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wsl"><a class="header" href="#wsl">WSL</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="windows"><a class="header" href="#windows">Windows</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ovnovs"><a class="header" href="#ovnovs">OVN/OVS</a></h1>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;è™šæ‹ŸåŒ–.è™šæ‹Ÿç½‘ç»œ&quot;
description = &quot;è™šæ‹ŸåŒ–.è™šæ‹Ÿè®¾å¤‡ quick start&quot;
tags = [&quot;techn&quot;, &quot;computer&quot;, &quot;è™šæ‹ŸåŒ–&quot;, &quot;è™šæ‹Ÿç½‘ç»œ&quot;, &quot;__quick_start&quot;]</p>
<p>+++</p>
<h1 id="è™šæ‹ŸåŒ–è™šæ‹Ÿç½‘ç»œ"><a class="header" href="#è™šæ‹ŸåŒ–è™šæ‹Ÿç½‘ç»œ">è™šæ‹ŸåŒ–.è™šæ‹Ÿç½‘ç»œ</a></h1>
<h2 id="è™šæ‹Ÿç½‘ç»œè®¾å¤‡"><a class="header" href="#è™šæ‹Ÿç½‘ç»œè®¾å¤‡">è™šæ‹Ÿç½‘ç»œè®¾å¤‡</a></h2>
<h3 id="tuntap"><a class="header" href="#tuntap">TUN/TAP</a></h3>
<blockquote>
<p><a href="https://www.zhaohuabing.com/post/2020-02-24-linux-taptun/">Linux Tun/Tap ä»‹ç»</a>ï¼›</p>
</blockquote>
<p>TUN/TAP æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­<strong>è½¯ä»¶å®ç°çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡</strong>ï¼Œä¸ç‰©ç†ç½‘ç»œè®¾å¤‡å®Œå…¨ç›¸åŒçš„<strong>é€»è¾‘</strong>åŠŸèƒ½ã€‚å®ç°ä¸Šçš„åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li>åœ¨ç‰©ç†ç½‘ç»œè®¾å¤‡ä¸Š<strong>æ•°æ®ä»¥æ¯”ç‰¹æµçš„å½¢å¼ç”±ç‰©ç†ä»‹è´¨æ‰¿è½½</strong>ï¼Œç‰©ç†ç½‘å¡ä»ç½‘çº¿æ¥å£ï¼ˆæˆ–æ— çº¿ä¿¡å·ï¼‰æ¥æ”¶æ•°æ®ï¼Œé€šè¿‡ DMA æ‹·è´æ•°æ®åˆ°å†…å­˜ï¼Œäº¤ç”±å†…æ ¸åè®®æ ˆå¤„ç†ï¼Œå‘é€åä¹‹</li>
<li>åœ¨è™šæ‹Ÿç½‘ç»œè®¾å¤‡ä¸Š<strong>æ•°æ®ä»¥å­—ç¬¦çš„å½¢å¼ç”±å†…å­˜æ‰¿è½½</strong>ï¼Œå‘é€æ•°æ®æ—¶ï¼Œåè®®æ ˆå°†æ•°æ®äº¤ç»™ï¼Œè™šæ‹Ÿç½‘å¡ä»å­—ç¬¦è®¾å¤‡ï¼ˆæ–‡ä»¶ï¼‰æ¥å—æ•°æ®</li>
</ul>
<p>TUN æ¨¡æ‹Ÿ L3 ç½‘ç»œå±‚è®¾å¤‡ï¼›TAP æ¨¡æ‹Ÿ L2 é“¾è·¯å±‚è®¾å¤‡ï¼Œä»¥å¤ªç½‘ï¼ˆEthernetï¼‰ç½‘å¡ã€‚</p>
<p><img src="%E8%AE%A1/%E8%99%9A%E6%8B%9F%E5%8C%96/./img/%E8%99%9A%E6%8B%9F%E5%8C%96.%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C.TUNTAP.drawio.svg" alt="" /></p>
<h3 id="veth-pair"><a class="header" href="#veth-pair">veth pair</a></h3>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/293659939">Linux veth pair è¯¦è§£</a>ï¼›</p>
<p><a href="https://www.cnblogs.com/bakari/p/10613710.html">Linux è™šæ‹Ÿç½‘ç»œè®¾å¤‡ veth-pair è¯¦è§£</a>ï¼›</p>
</blockquote>
<p>veth è®¾å¤‡å‡ä¸ºæˆå¯¹ä½¿ç”¨</p>
<p><img src="%E8%AE%A1/%E8%99%9A%E6%8B%9F%E5%8C%96/./img/%E8%99%9A%E6%8B%9F%E5%8C%96.%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C.veth_pair.drawio.svg" alt="" /></p>
<h2 id="éš§é“ç½‘ç»œ"><a class="header" href="#éš§é“ç½‘ç»œ">éš§é“ç½‘ç»œ</a></h2>
<h3 id="vxlan"><a class="header" href="#vxlan">vxlan</a></h3>
<blockquote>
<p><a href="https://community.cisco.com/t5/%E7%BD%91%E7%BB%9C%E5%8D%9A%E5%AE%A2/%E5%81%9A%E4%BA%86%E5%87%A0%E5%B9%B4%E7%9A%84%E7%BD%91%E5%B7%A5%E4%B9%9F%E6%9C%AA%E5%BF%85%E4%BA%86%E8%A7%A3vlan%E5%92%8Cvxlan%E7%9A%84%E5%8C%BA%E5%88%AB-%E4%BB%8A%E5%A4%A9%E6%88%91%E6%9D%A5%E5%91%8A%E8%AF%89%E4%BD%A0/ba-p/4383418">VLANå’ŒVXLANçš„åŒºåˆ«</a>ï¼›</p>
<p><a href="https://cizixs.com/2017/09/28/linux-vxlan/">linux ä¸Šå®ç° vxlan ç½‘ç»œ</a>ï¼›</p>
</blockquote>
<p>vlanï¼ˆè™šæ‹Ÿå±€åŸŸç½‘ï¼‰å°†åŒä¸€ç½‘ç»œåˆ’åˆ†ä¸ºå¤šä¸ªé€»è¾‘ä¸Šçš„è™šæ‹Ÿå­ç½‘ï¼Œåœ¨ä»¥å¤ªç½‘çš„åŸºç¡€ä¸Šå®ç°äº†å¹¿æ’­åŸŸéš”ç¦»ï¼Œè§£å†³äº†å¹¿æ’­æŠ¥æ–‡æ³›æ»¥çš„é—®é¢˜ï¼›</p>
<p>vxlan å°† header æ‰©å±•åˆ°äº† 8 å­—èŠ‚ï¼Œæ”¯æ’‘å¦‚ä»Šäº‘æœåŠ¡ç­‰å¤§è§„æ¨¡åœºæ™¯ï¼Œè§£å†³ç½‘ç»œåœ°å€é‡å é—®é¢˜ä»¥æ»¡è¶³å¤šç§Ÿæˆ·åœºæ™¯</p>
<h3 id="ipip"><a class="header" href="#ipip">ipip</a></h3>
<h3 id="bgp"><a class="header" href="#bgp">bgp</a></h3>
<h2 id="ç»„ç½‘æ¨¡å¼"><a class="header" href="#ç»„ç½‘æ¨¡å¼">ç»„ç½‘æ¨¡å¼</a></h2>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;Docker&quot;
description = &quot;Docker&quot;
tags = [&quot;it&quot;, &quot;container&quot;]</p>
<p>+++</p>
<h1 id="docker"><a class="header" href="#docker">Docker</a></h1>
<p>å®˜ç½‘ï¼šhttps://www.docker.com/ </p>
<p>ä»“åº“ï¼šhttps://hub.docker.com/</p>
<p>æ–‡æ¡£ï¼šhttps://docs.docker.com/reference/</p>
<p>å‘½ä»¤ï¼šhttps://docs.docker.com/engine/reference/commandline/docker/</p>
<h2 id="å¿«å¼€"><a class="header" href="#å¿«å¼€">å¿«å¼€</a></h2>
<h3 id="å®‰è£…"><a class="header" href="#å®‰è£…">å®‰è£…</a></h3>
<blockquote>
<p><a href="https://docs.docker.com/engine/install/">Install Docker Engine</a>ï¼›</p>
</blockquote>
<h4 id="ubuntu-1"><a class="header" href="#ubuntu-1">ubuntu</a></h4>
<blockquote>
<p><a href="https://docs.docker.com/engine/install/ubuntu/">Install Docker Engine on Ubuntu</a>ï¼›</p>
</blockquote>
<pre><code class="language-shell"># GPG å¯†é’¥
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
# å­˜å‚¨åº“
echo &quot;deb [arch=&quot;$(dpkg --print-architecture)&quot; signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu &quot;$(. /etc/os-release &amp;&amp; echo &quot;$VERSION_CODENAME&quot;)&quot; stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
# å®‰è£…
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io
</code></pre>
<h4 id="centos-1"><a class="header" href="#centos-1">centos</a></h4>
<blockquote>
<p><a href="https://docs.docker.com/engine/install/rhel/">Install Docker Engine on RHEL</a>ï¼›</p>
</blockquote>
<pre><code class="language-sh"># è®¾ç½®å­˜å‚¨åº“
cat &gt;/etc/yum.repos.d/docker.repo&lt;&lt;EOF
[docker-ce-stable]
name=Docker CE Stable - $basearch
baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/$releasever/$basearch/stable
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg
EOF

# å®‰è£… Docker Engine å’Œ containerdã€‚centos8 é»˜è®¤ä½¿ç”¨ podman ä»£æ›¿ dockerï¼Œä¼šæç¤ºå†²çªï¼Œæ ¹æ®æç¤ºä½¿ç”¨ --allowerasing æ›¿æ¢å†²çªçš„è½¯ä»¶åŒ…
yum install -y --allowerasing docker-ce docker-ce-cli containerd.io

# è®¾ç½®å¼€æœºå¯åŠ¨å¹¶ç«‹å³å¯åŠ¨
systemctl enable --now docker
</code></pre>
<h3 id="å¼€æœºå¯åŠ¨"><a class="header" href="#å¼€æœºå¯åŠ¨">å¼€æœºå¯åŠ¨</a></h3>
<pre><code class="language-shell">#æ£€æŸ¥
docker version
# å¼€æœºå¯åŠ¨
systemctl enable --now docker
</code></pre>
<h3 id="é…ç½®"><a class="header" href="#é…ç½®">é…ç½®</a></h3>
<blockquote>
<p>cgroup é©±åŠ¨ï¼š<a href="https://kubernetes.io/zh/docs/setup/production-environment/container-runtimes/#docker">systemd</a>ï¼›</p>
<p>å­˜å‚¨é©±åŠ¨ï¼šï¼›</p>
<p>å®¹å™¨é•œåƒä»“åº“ï¼š<a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">é˜¿é‡Œäº‘</a>ï¼›</p>
</blockquote>
<pre><code class="language-shell"># é€šç”¨é…ç½®
cat &gt; /etc/docker/daemon.json &lt;&lt; EOF
{
  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],
  &quot;log-driver&quot;: &quot;json-file&quot;,
  &quot;log-opts&quot;: {
    &quot;max-size&quot;: &quot;100m&quot;
  },
  
  &quot;storage-driver&quot;: &quot;overlay2&quot;,
  
  &quot;registry-mirrors&quot;: [&quot;mirror.xxx.com&quot;,&quot;https://ohm5orzk.mirror.aliyuncs.com&quot;],
  &quot;insecure-registries&quot;: [&quot;192.168.xxx.xxx:5000&quot;,&quot;registry.aliyuncs.com&quot;]
}
EOF

# æ£€æŸ¥
docker info
</code></pre>
<h3 id="ä»£ç†"><a class="header" href="#ä»£ç†">ä»£ç†</a></h3>
<pre><code class="language-shell">
# dockerd ä»£ç†é…ç½®
cat &gt; /etc/systemd/system/docker.service.d/proxy.conf &lt;&lt; EOF
[Service]
Environment=&quot;HTTP_PROXY=http://proxy.example.com:8080/&quot;
Environment=&quot;HTTPS_PROXY=https://proxy.example.com:8080/&quot;
Environment=&quot;NO_PROXY=127.0.0.1,ç§æœ‰ä»“åº“ip,example.com&quot;
EOF
</code></pre>
<h2 id="é•œåƒ"><a class="header" href="#é•œåƒ">é•œåƒ</a></h2>
<h3 id="é•œåƒåŠ é€Ÿé…ç½®"><a class="header" href="#é•œåƒåŠ é€Ÿé…ç½®">é•œåƒåŠ é€Ÿé…ç½®</a></h3>
<p>ä»https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors è·å–ä¸ªäººä¸“å±çš„é˜¿é‡Œdockeré•œåƒåŠ é€Ÿåœ°å€</p>
<p>/etc/docker/daemon.json</p>
<pre><code class="language-shell">cat &gt; /etc/docker/daemon.json &lt;&lt; EOF
{
  &quot;registry-mirrors&quot;: [&quot;https://ohm5orzk.mirror.aliyuncs.com&quot;]
}
EOF
</code></pre>
<p>ç„¶åé‡å¯dockerå³å¯</p>
<pre><code class="language-shell">systemctl restart docker
</code></pre>
<h3 id="é•œåƒä»“åº“"><a class="header" href="#é•œåƒä»“åº“">é•œåƒä»“åº“</a></h3>
<h4 id="http"><a class="header" href="#http">http</a></h4>
<p>docker-registry å®‰è£…ï¼šä½¿ç”¨å®˜æ–¹ <code>registry</code> é•œåƒæ¥å®‰è£…æ‰§è¡Œã€‚æ³¨æ„ï¼Œæ­¤æ—¶å¯ç”¨çš„ registry æ˜¯ä¸€ä¸ª http server</p>
<pre><code class="language-shell"># ä»“åº“é»˜è®¤è¢«åˆ›å»ºåœ¨å®¹å™¨çš„ /var/lib/registry ç›®å½•ä¸‹ï¼Œé€šè¿‡ -v æŒ‚è½½ä¸»æœºç›®å½•ï¼Œä»¥å°†é•œåƒæ–‡ä»¶æŒä¹…å­˜å‚¨åˆ°ä¸»æœº
docker run -d --restart=always --name registry -p 5000:5000 \
-v /var/lib/docker/registry:/var/lib/registry registry
</code></pre>
<p>åœ¨ Docker client ä¸Šï¼Œé»˜è®¤æ¥æ”¶ https å“åº”ï¼Œå› æ­¤è¿˜ push ä¸äº†é•œåƒï¼Œå°†å‡ºç°é”™è¯¯ <code>http: server gave HTTP response to HTTPS client</code>ï¼Œå¯ä»¥é€šè¿‡åœ¨ docker <strong>client æ‰€åœ¨ä¸»æœº</strong>çš„ <code>/etc/docker/daemon.json</code> ä¸­é…ç½®å–æ¶ˆè¿™ä¸ªé™åˆ¶ï¼Œ<code>192.168.31.11:5000</code> ä¸º <strong>registry server</strong> åœ°å€</p>
<pre><code class="language-json">{
  &quot;insecure-registries&quot;: [&quot;192.168.xxx.xxx:5000&quot;,&quot;registry.aliyuncs.com&quot;]
}
</code></pre>
<p>ä½†kubeleté€šè¿‡criè°ƒç”¨æ—¶é»˜è®¤ä½¿ç”¨httpsï¼Œå› æ­¤httpsæ›´ä½³</p>
<h4 id="httpsca"><a class="header" href="#httpsca">https(ca)</a></h4>
<p>åœ¨ registry server ä¸»æœºä¸Šåˆ›å»ºè¯ä¹¦ï¼ŒæŒ‡å®š server <a href="%E8%AE%A1/%E4%BA%91%E5%8E%9F%E7%94%9F/../it.crypto.tool.html#%E7%AD%BE%E5%8F%91%E9%85%8D%E7%BD%AE">é…ç½®</a>ã€‚</p>
<pre><code class="language-shell"># è¯ä¹¦ç­¾åè¯·æ±‚
$ cat &gt; docker-csr.json &lt;&lt;EOF
{
    &quot;CN&quot;: &quot;docker&quot;,
    &quot;hosts&quot;: [
      &quot;127.0.0.1&quot;,
      &quot;192.168.31.11&quot;
    ],
    &quot;key&quot;: {
        &quot;algo&quot;: &quot;rsa&quot;,
        &quot;size&quot;: 2048
    },
    &quot;names&quot;: [
        {
            &quot;C&quot;: &quot;CN&quot;,
            &quot;ST&quot;: &quot;BeiJing&quot;,
            &quot;L&quot;: &quot;BeiJing&quot;,
            &quot;O&quot;: &quot;docker&quot;,
            &quot;OU&quot;: &quot;docker&quot;
        }
    ]
}
EOF

# ç­¾å‘è¯ä¹¦
$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=server docker-csr.json | cfssljson -bare docker
</code></pre>
<p>å¯åŠ¨ https çš„ registry server</p>
<pre><code class="language-shell"># -v æŒ‚è½½è¯ä¹¦æ‰€åœ¨ç›®å½•ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šè¯ä¹¦å’Œkey
docker run -d --restart=always --name registry -p 5000:5000 \
-v /var/lib/docker/registry:/var/lib/registry \
-v /etc/docker/ssl:/etc/docker/ssl \
-e REGISTRY_HTTP_ADDR=0.0.0.0:5000 \
-e REGISTRY_HTTP_TLS_CERTIFICATE=/etc/docker/ssl/docker.pem \
-e REGISTRY_HTTP_TLS_KEY=/etc/docker/ssl/docker-key.pem \
registry
</code></pre>
<p>æ­¤æ—¶ docker client ä»ç„¶æ— æ³•è®¿é—®ç§æœ‰ä»“åº“ï¼Œå°†æŠ¥é”™<code>Get &quot;https://192.168.31.11:5000/v2/&quot;: x509: certificate signed by unknown authority</code>ï¼Œæ˜¯ç§æœ‰ä»“åº“ä½¿ç”¨ server è¯ä¹¦æ˜¯æˆ‘ä»¬è‡ªå·±ç”Ÿæˆçš„ ca è¯ä¹¦ç­¾åçš„è‡ªç­¾åè¯ä¹¦ï¼Œclient ä¸»æœºæ— æ³•å¯¹å…¶ CA è¿›è¡ŒéªŒè¯ï¼Œéœ€è¦ä¸‹è½½ ca è¯ä¹¦åˆ° <code>/etc/docker/certs.d/&lt;åœ°å€&gt;:&lt;ç«¯å£&gt;</code>æˆ–<code>/etc/docker/certs.d/&lt;åŸŸå&gt;</code>ç›®å½•ä¸‹</p>
<pre><code class="language-shell"># client ç«¯ä¸‹è½½ ca è¯ä¹¦
scp -r root@192.168.31.11:/root/ssl/ca.pem /etc/docker/certs.d/192.168.31.11:5000/ca.crt
docker push 192.168.31.11:5000/guestbook:1.0
</code></pre>
<h4 id="httpspw"><a class="header" href="#httpspw">https(pw)</a></h4>
<pre><code class="language-shell">mkdir /etc/docker/auth
# ç”Ÿæˆå¯†ç è®¤è¯
htpasswd -Bbn admin admin &gt; /etc/docker/auth/htpasswd
# runæ—¶æŒ‡å®š
docker run -d --restart=always --name registry -p 5000:5000 \
-v /var/lib/docker/registry:/var/lib/registry \
-v /etc/docker/auth:/etc/docker/auth \
-e REGISTRY_AUTH=htpasswd \
-e REGISTRY_AUTH_HTPASSWD_PATH=/etc/docker/auth/htpasswd \
-e REGISTRY_AUTH_HTPASSWD_REALM=&quot;Registry Realm&quot; \
registry

# ç™»å½•
docker login 192.168.31.11:5000
</code></pre>
<h3 id="é•œåƒç®¡ç†"><a class="header" href="#é•œåƒç®¡ç†">é•œåƒç®¡ç†</a></h3>
<h6 id="é•œåƒæœç´¢"><a class="header" href="#é•œåƒæœç´¢">é•œåƒæœç´¢</a></h6>
<h6 id="é•œåƒæ‹‰å–"><a class="header" href="#é•œåƒæ‹‰å–">é•œåƒæ‹‰å–</a></h6>
<h6 id="é•œåƒå¯¼å‡º"><a class="header" href="#é•œåƒå¯¼å‡º">é•œåƒå¯¼å‡º</a></h6>
<pre><code class="language-shell"># ä¸€èˆ¬å¯¼å‡ºå‘½ååç¼€ä¸º.tar
docker save arm64v8/centos:latest -o ./centos.arm64.tar
</code></pre>
<h6 id="é•œåƒå¯¼å…¥"><a class="header" href="#é•œåƒå¯¼å…¥">é•œåƒå¯¼å…¥</a></h6>
<pre><code class="language-shell">docker load &lt; centos.arm64.tar
</code></pre>
<h6 id="é•œåƒæ„å»º"><a class="header" href="#é•œåƒæ„å»º">é•œåƒæ„å»º</a></h6>
<p>https://www.runoob.com/docker/docker-build-command.html</p>
<pre><code class="language-shell"># é»˜è®¤ä½¿ç”¨å½“å‰ç›®å½•ä¸‹çš„ Dockerfile æ„å»ºé•œåƒ
$ docker build -t yuanya:1.0 .
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>option</th><th>description</th></tr></thead><tbody>
<tr><td>-f</td><td>æŒ‡å®šè¦ä½¿ç”¨çš„Dockerfile</td></tr>
<tr><td>-t;-tag</td><td>é•œåƒçš„åå­—åŠæ ‡ç­¾ï¼Œé€šå¸¸ name:tag æˆ–è€… name æ ¼å¼ï¼›å¯ä»¥åœ¨ä¸€æ¬¡æ„å»ºä¸­ä¸ºä¸€ä¸ªé•œåƒè®¾ç½®å¤šä¸ªæ ‡ç­¾ã€‚</td></tr>
</tbody></table>
</div>
<h6 id="æäº¤å®¹å™¨ä¸ºé•œåƒ"><a class="header" href="#æäº¤å®¹å™¨ä¸ºé•œåƒ">æäº¤å®¹å™¨ä¸ºé•œåƒ</a></h6>
<pre><code class="language-shell">docker commit 261314c94305 imagexxx
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>option</th><th>description</th></tr></thead><tbody>
<tr><td>-a</td><td>æäº¤çš„é•œåƒä½œè€…</td></tr>
<tr><td>-c</td><td>ä½¿ç”¨DockerfileæŒ‡ä»¤æ¥åˆ›å»ºé•œåƒï¼›</td></tr>
<tr><td>-m</td><td>æäº¤æ—¶çš„è¯´æ˜æ–‡å­—ï¼›</td></tr>
<tr><td>-p</td><td>åœ¨commitæ—¶ï¼Œå°†å®¹å™¨æš‚åœã€‚</td></tr>
</tbody></table>
</div>
<h3 id="è·¨å¹³å°æ„å»º"><a class="header" href="#è·¨å¹³å°æ„å»º">è·¨å¹³å°æ„å»º</a></h3>
<p>qemu-user-staticï¼šhttps://github.com/multiarch/qemu-user-static</p>
<p>https://juejin.cn/post/6844903605355577358</p>
<p>https://zhuanlan.zhihu.com/p/106054643</p>
<p>åœ¨x86æœºå™¨ä¸Šæ¨¡æ‹Ÿarmæ¶æ„æŒ‡ä»¤æ¥æ„å»ºarmæ¶æ„çš„é•œåƒï¼Œä½¿ç”¨ <a href="https://github.com/multiarch/qemu-user-static">multiarch/qemu-user-static</a> æ¥å®ç°åœ¨x86ä¸»æœºä¸Šæ¨¡æ‹Ÿarmç¯å¢ƒ</p>
<p><strong>multiarch/qemu-user-static</strong> æ˜¯é€šè¿‡ QEMU å’Œ binfmt_misc å¯ç”¨ä¸åŒå¤šæ¶æ„å®¹å™¨çš„æ‰§è¡Œã€‚ä»¥ä¸‹æ˜¯ Docker çš„ç¤ºä¾‹ã€‚</p>
<p>é€šè¿‡ qemu-user-static ï¼ˆè¯¥ç¨‹åºä½¿ç”¨å†…æ ¸ binfmt_misc æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½ï¼‰å¯ä»¥æ¨¡æ‹Ÿå„ç§ç¯å¢ƒ</p>
<pre><code class="language-shell"># æˆ‘çš„ç¯å¢ƒæ˜¯ centos8
$ uname -mrs
Linux 4.18.0-305.7.1.el8_4.x86_64 x86_64

# æ‹‰å–ä¸€ä¸ª arm çš„ centos é•œåƒ
$ docker pull arm64v8/centos

# åœ¨ x86 ä¸Šæ‰§è¡Œä¸€ä¸ª arm centos é•œåƒæ—¶ï¼Œä¼šå› æ— æ³•è§£æ arm æŒ‡ä»¤è€ŒæŠ¥é”™
$ docker run --rm -t arm64v8/centos uname -m
standard_init_linux.go:211: exec user process caused &quot;exec format error&quot;

# æ­¤æ—¶æ‰§è¡Œ qemu-user-static é•œåƒï¼Œå°†ä¸ºæˆ‘ä»¬è®¾ç½®æ¨¡æ‹Ÿ arm ç¯å¢ƒ
$ docker run --rm --privileged multiarch/qemu-user-static --reset -p yes
Setting /usr/bin/qemu-alpha-static as binfmt interpreter for alpha
Setting /usr/bin/qemu-arm-static as binfmt interpreter for arm
Setting /usr/bin/qemu-armeb-static as binfmt interpreter for armeb
Setting /usr/bin/qemu-sparc-static as binfmt interpreter for sparc
Setting /usr/bin/qemu-sparc32plus-static as binfmt interpreter for sparc32plus
Setting /usr/bin/qemu-sparc64-static as binfmt interpreter for sparc64
Setting /usr/bin/qemu-ppc-static as binfmt interpreter for ppc
Setting /usr/bin/qemu-ppc64-static as binfmt interpreter for ppc64
Setting /usr/bin/qemu-ppc64le-static as binfmt interpreter for ppc64le
Setting /usr/bin/qemu-m68k-static as binfmt interpreter for m68k
Setting /usr/bin/qemu-mips-static as binfmt interpreter for mips
Setting /usr/bin/qemu-mipsel-static as binfmt interpreter for mipsel
Setting /usr/bin/qemu-mipsn32-static as binfmt interpreter for mipsn32
Setting /usr/bin/qemu-mipsn32el-static as binfmt interpreter for mipsn32el
Setting /usr/bin/qemu-mips64-static as binfmt interpreter for mips64
Setting /usr/bin/qemu-mips64el-static as binfmt interpreter for mips64el
Setting /usr/bin/qemu-sh4-static as binfmt interpreter for sh4
Setting /usr/bin/qemu-sh4eb-static as binfmt interpreter for sh4eb
Setting /usr/bin/qemu-s390x-static as binfmt interpreter for s390x
Setting /usr/bin/qemu-aarch64-static as binfmt interpreter for aarch64
Setting /usr/bin/qemu-aarch64_be-static as binfmt interpreter for aarch64_be
Setting /usr/bin/qemu-hppa-static as binfmt interpreter for hppa
Setting /usr/bin/qemu-riscv32-static as binfmt interpreter for riscv32
Setting /usr/bin/qemu-riscv64-static as binfmt interpreter for riscv64
Setting /usr/bin/qemu-xtensa-static as binfmt interpreter for xtensa
Setting /usr/bin/qemu-xtensaeb-static as binfmt interpreter for xtensaeb
Setting /usr/bin/qemu-microblaze-static as binfmt interpreter for microblaze
Setting /usr/bin/qemu-microblazeel-static as binfmt interpreter for microblazeel
Setting /usr/bin/qemu-or1k-static as binfmt interpreter for or1k

# centos7ä¼šå‡ºç°æŠ¥é”™ sh: write error: Invalid argumentï¼Œå› ä¸ºä½¿ç”¨ -p yes é€‰é¡¹è‡³å°‘éœ€è¦å†…æ ¸ç‰ˆæœ¬ 4.10 ä¸Šçš„ binfmt_miscï¼Œhttps://github.com/multiarch/qemu-user-static/issues/100ã€‚å¯ä»¥å»æ‰ -p yes é€‰é¡¹ï¼Œä¹‹åè¿˜æœ‰ä¸€å †å…¶å®ƒé—®é¢˜ï¼Œç›´æ¥æ”¾å¼ƒï¼Œæ¢ centos8 äº†
$ docker run --rm --privileged multiarch/qemu-user-static --reset

# ä¹‹åå°±å¯ä»¥æ‰§è¡Œè¿™ä¸ª arm centos é•œåƒäº†ï¼Œå› ä¸º qemu-user-staticå°†armæ¶æ„çš„æŒ‡ä»¤è§£é‡Šæˆx86æ¶æ„çš„æŒ‡ä»¤æ‰§è¡Œ
$ docker run --rm -t arm64v8/centos uname -m
aarch64

# è¿™é‡Œå°† hello.arm æ‰€åœ¨ç›®å½•æŒ‚è½½è¿›æ¥æ‰§è¡Œ
docker run --rm -t -v /it/go/gopath/src/yuanyatianchi.io/hello/bin:/usr/bin/qemu-aarch64-static arm64v8/centos ls /go/bin
</code></pre>
<p>ç°åœ¨ arm64v8/centos å·²ç»å¯ä»¥ run äº†ï¼Œå°†å…¶ä½œä¸ºåŸºç¡€é•œåƒç¼–å†™ Dockerfile ï¼Œbuild å run èµ·æ¥å³å¯ï¼Œè¿™é‡Œç”¨ä¸€ä¸ª hello ä»£ç </p>
<pre><code class="language-go">package main

import &quot;fmt&quot;

func main() {
	fmt.Println(&quot;hello&quot;)
}
</code></pre>
<pre><code class="language-dockerfile">FROM arm64v8/centos

COPY ./bin/hello /usr/bin
</code></pre>
<pre><code class="language-makefile">.PHONY: build-hello build-image export-image clean

# æ„å»ºç¨‹åº
build-hello: ./cmd/hello.go
	CGO_ENABLED=0 GOOS=linux GOARCH=arm64 go build -o ./bin/hello ./cmd/hello.go

# æ„å»ºé•œåƒ
build-image: build-hello
	docker build . -t hello:v1.0

# å¯¼å‡ºé•œåƒ
export-image: build-image
	docker save hello:v1.0 -o ./bin/hello.tar

clean:
	rm -rf ./bin
</code></pre>
<pre><code class="language-shell"># æ„å»ºå¹¶å¯¼å‡ºé•œåƒ
$ make export-image
CGO_ENABLED=0 GOOS=linux GOARCH=arm64 go build -o ./bin/hello ./cmd/hello.go
docker build . -t hello:v1.0
Sending build context to Docker daemon  7.443MB
Step 1/2 : FROM arm64v8/centos
 ---&gt; a0477e85b8ae
Step 2/2 : COPY ./bin/hello /usr/bin
 ---&gt; 8a0e7d42e2f7
Successfully built 8a0e7d42e2f7
Successfully tagged hello:v1.0
docker save hello:v1.0 -o ./bin/hello.tar

# å¯ä»¥çœ‹åˆ°é•œåƒåŒ…
$ ls ./bin/
hello  hello.tar

# éªŒè¯ä¸€ä¸‹æ‰§è¡Œ hello
$ docker run --rm -t hello:v1.0 hello
hello
</code></pre>
<h2 id="å®¹å™¨"><a class="header" href="#å®¹å™¨">å®¹å™¨</a></h2>
<p>åŠ è½½é•œåƒè¿è¡Œå®¹å™¨</p>
<pre><code class="language-shell">docker run -it --name å®¹å™¨åç§° é•œåƒåç§° /bin.bash
</code></pre>
<p>å¯åŠ¨</p>
<p>åœæ­¢</p>
<h2 id="ç½‘ç»œ"><a class="header" href="#ç½‘ç»œ">ç½‘ç»œ</a></h2>
<h3 id="ä»£ç†-1"><a class="header" href="#ä»£ç†-1">ä»£ç†</a></h3>
<p>https://note.qidong.name/2020/05/docker-proxy/</p>
<p>æœ‰æ—¶å› ä¸ºç½‘ç»œåŸå› ï¼Œæ¯”å¦‚å…¬å¸NATï¼Œæˆ–å…¶å®ƒå•¥çš„ï¼Œéœ€è¦ä½¿ç”¨ä»£ç†ã€‚ Dockerçš„ä»£ç†é…ç½®ï¼Œç•¥æ˜¾å¤æ‚ï¼Œå› ä¸ºæœ‰ä¸‰ç§åœºæ™¯ã€‚ ä½†åŸºæœ¬åŸç†éƒ½æ˜¯ä¸€è‡´çš„ï¼Œéƒ½æ˜¯åˆ©ç”¨Linuxçš„<code>http_proxy</code>ç­‰ç¯å¢ƒå˜é‡ã€‚</p>
<h4 id="dockerd"><a class="header" href="#dockerd">dockerd</a></h4>
<p>https://docs.docker.com/config/daemon/systemd/</p>
<p>æ‰§è¡Œ<code>docker pull</code>æ—¶ï¼Œæ˜¯ç”±å®ˆæŠ¤è¿›ç¨‹<code>dockerd</code>æ¥æ‰§è¡Œã€‚ å› æ­¤ï¼Œä»£ç†éœ€è¦é…åœ¨<code>dockerd</code>çš„ç¯å¢ƒä¸­ã€‚ è€Œè¿™ä¸ªç¯å¢ƒï¼Œåˆ™æ˜¯å—<code>systemd</code>æ‰€ç®¡æ§ï¼Œå› æ­¤å®é™…æ˜¯<code>systemd</code>çš„é…ç½®ã€‚</p>
<pre><code class="language-shell">sudo mkdir -p /etc/systemd/system/docker.service.d
sudo touch /etc/systemd/system/docker.service.d/proxy.conf
</code></pre>
<p><code>proxy.conf</code>æ–‡ä»¶ï¼ˆå¯ä»¥æ˜¯ä»»æ„<code>*.conf</code>çš„å½¢å¼ï¼‰å†…å®¹å¦‚ä¸‹</p>
<pre><code class="language-ini">[Service]
Environment=&quot;HTTP_PROXY=http://proxy.example.com:8080/&quot;
Environment=&quot;HTTPS_PROXY=https://proxy.example.com:8080/&quot;
Environment=&quot;NO_PROXY=127.0.0.1,ç§æœ‰ä»“åº“ip,example.com&quot;
</code></pre>
<p>å…¶ä¸­ï¼Œ<code>proxy.example.com:8080</code>è¦æ¢æˆå¯ç”¨çš„å…å¯†ä»£ç†ã€‚ é€šå¸¸ä½¿ç”¨<code>cntlm</code>åœ¨æœ¬æœºè‡ªå»ºå…å¯†ä»£ç†ï¼Œå»å¯¹æ¥å…¬å¸çš„ä»£ç†ã€‚ å¯å‚è€ƒã€Š<a href="https://note.qidong.name/2018/11/cntlm-proxy/">Linuxä¸‹å®‰è£…é…ç½®Cntlmä»£ç†</a>ã€‹ã€‚</p>
<p>é‡å¯ã€‚<code>dockerd</code>ä»£ç†çš„ä¿®æ”¹æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒå®é™…ä¸Šæ˜¯æ”¹<code>systemd</code>çš„é…ç½®ï¼Œå› æ­¤éœ€è¦é‡è½½<code>systemd</code>å¹¶é‡å¯<code>dockerd</code>æ‰èƒ½ç”Ÿæ•ˆã€‚</p>
<pre><code class="language-shell">sudo systemctl daemon-reload
sudo systemctl restart docker
</code></pre>
<h4 id="container"><a class="header" href="#container">container</a></h4>
<p>https://docs.docker.com/network/proxy/</p>
<p>åœ¨å®¹å™¨è¿è¡Œé˜¶æ®µï¼Œå¦‚æœéœ€è¦ä»£ç†ä¸Šç½‘ï¼Œåˆ™éœ€è¦é…ç½®<code>~/.docker/config.json</code>ã€‚ ä»¥ä¸‹é…ç½®ï¼Œåªåœ¨Docker 17.07åŠä»¥ä¸Šç‰ˆæœ¬ç”Ÿæ•ˆã€‚</p>
<pre><code class="language-json">{
  &quot;proxies&quot;:
  {
    &quot;default&quot;:
    {
      &quot;httpProxy&quot;: &quot;http://proxy.example.com:8080&quot;,
      &quot;httpsProxy&quot;: &quot;http://proxy.example.com:8080&quot;,
      &quot;noProxy&quot;: &quot;localhost,127.0.0.1,.example.com&quot;
    }
  }
}
</code></pre>
<p>è¿™ä¸ªæ˜¯ç”¨æˆ·çº§çš„é…ç½®ï¼Œé™¤äº†<code>proxies</code>ï¼Œ<code>docker login</code>ç­‰ç›¸å…³ä¿¡æ¯ä¹Ÿä¼šåœ¨å…¶ä¸­ã€‚ è€Œä¸”è¿˜å¯ä»¥é…ç½®ä¿¡æ¯å±•ç¤ºçš„æ ¼å¼ã€æ’ä»¶å‚æ•°ç­‰ã€‚</p>
<p>æ­¤å¤–ï¼Œå®¹å™¨çš„ç½‘ç»œä»£ç†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨å…¶è¿è¡Œæ—¶é€šè¿‡<code>-e</code>æ³¨å…¥<code>http_proxy</code>ç­‰ç¯å¢ƒå˜é‡ã€‚ è¿™ä¸¤ç§æ–¹æ³•åˆ†åˆ«é€‚åˆä¸åŒåœºæ™¯ã€‚ <code>config.json</code>éå¸¸æ–¹ä¾¿ï¼Œé»˜è®¤åœ¨æ‰€æœ‰é…ç½®ä¿®æ”¹åå¯åŠ¨çš„å®¹å™¨ç”Ÿæ•ˆï¼Œé€‚åˆä¸ªäººå¼€å‘ç¯å¢ƒã€‚ åœ¨CI/CDçš„è‡ªåŠ¨æ„å»ºç¯å¢ƒã€æˆ–è€…å®é™…ä¸Šçº¿è¿è¡Œçš„ç¯å¢ƒä¸­ï¼Œè¿™ç§æ–¹æ³•å°±ä¸å¤ªåˆé€‚ï¼Œç”¨<code>-e</code>æ³¨å…¥è¿™ç§æ˜¾å¼é…ç½®ä¼šæ›´å¥½ï¼Œå‡è½»å¯¹æ„å»ºã€éƒ¨ç½²ç¯å¢ƒçš„ä¾èµ–ã€‚ å½“ç„¶ï¼Œåœ¨è¿™äº›ç¯å¢ƒä¸­ï¼Œæœ€å¥½ç”¨è‰¯å¥½çš„è®¾è®¡é¿å…é…ç½®ä»£ç†ä¸Šç½‘ã€‚</p>
<h4 id="docker-build"><a class="header" href="#docker-build">docker build</a></h4>
<p>https://docs.docker.com/engine/reference/commandline/cli/#automatic-proxy-configuration-for-containers</p>
<p>è™½ç„¶<code>docker build</code>çš„æœ¬è´¨ï¼Œä¹Ÿæ˜¯å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œä½†æ˜¯ç¯å¢ƒä¼šç•¥æœ‰ä¸åŒï¼Œç”¨æˆ·çº§é…ç½®æ— æ•ˆã€‚ åœ¨æ„å»ºæ—¶ï¼Œéœ€è¦æ³¨å…¥<code>http_proxy</code>ç­‰å‚æ•°ã€‚</p>
<pre><code class="language-sh">docker build . \
    --build-arg &quot;HTTP_PROXY=http://proxy.example.com:8080/&quot; \
    --build-arg &quot;HTTPS_PROXY=http://proxy.example.com:8080/&quot; \
    --build-arg &quot;NO_PROXY=localhost,127.0.0.1,.example.com&quot; \
    -t your/image:tag
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šæ— è®ºæ˜¯<code>docker run</code>è¿˜æ˜¯<code>docker build</code>ï¼Œé»˜è®¤æ˜¯ç½‘ç»œéš”ç»çš„ã€‚ å¦‚æœä»£ç†ä½¿ç”¨çš„æ˜¯<code>localhost:3128</code>è¿™ç±»ï¼Œåˆ™ä¼šæ— æ•ˆã€‚ è¿™ç±»ä»…é™æœ¬åœ°çš„ä»£ç†ï¼Œå¿…é¡»åŠ ä¸Š<code>--network host</code>æ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚ è€Œä¸€èˆ¬åˆ™éœ€è¦é…ç½®ä»£ç†çš„å¤–éƒ¨IPï¼Œè€Œä¸”ä»£ç†æœ¬èº«è¦å¼€å¯gatewayæ¨¡å¼ã€‚</p>
<h3 id="ä¿®æ”¹docker0é»˜è®¤ç½‘æ®µ"><a class="header" href="#ä¿®æ”¹docker0é»˜è®¤ç½‘æ®µ">ä¿®æ”¹Docker0é»˜è®¤ç½‘æ®µ</a></h3>
<p>https://blog.51cto.com/lisea/1940023</p>
<p>Docker æœåŠ¡å¯åŠ¨åé»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ª docker0 ç½‘æ¡¥ï¼ˆå…¶ä¸Šæœ‰ä¸€ä¸ª docker0 å†…éƒ¨æ¥å£ï¼‰ï¼Œå®ƒåœ¨å†…æ ¸å±‚è¿é€šäº†å…¶ä»–çš„ç‰©ç†æˆ–è™šæ‹Ÿç½‘å¡ï¼Œè¿™å°±å°†æ‰€æœ‰å®¹å™¨å’Œæœ¬åœ°ä¸»æœºéƒ½æ”¾åˆ°åŒä¸€ä¸ªç‰©ç†ç½‘ç»œã€‚Docker é»˜è®¤æŒ‡å®šäº† docker0 æ¥å£ çš„ IP åœ°å€å’Œå­ç½‘æ©ç ï¼Œè®©ä¸»æœºå’Œå®¹å™¨ä¹‹é—´å¯ä»¥é€šè¿‡ç½‘æ¡¥ç›¸äº’é€šä¿¡ï¼Œå®ƒè¿˜ç»™å‡ºäº† MTUï¼ˆæ¥å£å…è®¸æ¥æ”¶çš„æœ€å¤§ä¼ è¾“å•å…ƒï¼‰ï¼Œé€šå¸¸æ˜¯ 1500 Bytesï¼Œæˆ–å®¿ä¸»ä¸»æœºç½‘ç»œè·¯ç”±ä¸Šæ”¯æŒçš„é»˜è®¤å€¼ã€‚è¿™äº›å€¼éƒ½å¯ä»¥åœ¨æœåŠ¡å¯åŠ¨çš„æ—¶å€™è¿›è¡Œé…ç½®ã€‚</p>
<pre><code class="language-shell"># æŸ¥çœ‹
$ ifconfig docker0
docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:61:ff:7b:91  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<p>ä¿®æ”¹æ–‡ä»¶ <code>/etc/docker/daemon.json</code> æ·»åŠ å†…å®¹ <code>&quot;bip&quot;: &quot;ip/netmask&quot;</code> å³å¯ã€‚æ³¨æ„åˆ‡å‹¿ä¸å®¿ä¸»æœºåŒç½‘æ®µ</p>
<pre><code class="language-json">{
  &quot;bip&quot;: &quot;192.168.100.1/24&quot;
}
</code></pre>
<pre><code class="language-shell"># é‡å¯å³å¯
$ systemctl restart docker
</code></pre>
<h2 id="client"><a class="header" href="#client">client</a></h2>
<p>å‘½ä»¤ï¼š</p>
<h3 id="é•œåƒ-1"><a class="header" href="#é•œåƒ-1">é•œåƒ</a></h3>
<p>dockerä¸­ä¸€ä¸ªcentosé•œåƒå¤§å°200mä¸åˆ°ï¼Œdockerç›¸å½“äºéš”ç¦»äº†è¿›ç¨‹ï¼Œ</p>
<pre><code class="language-shell">$ docker images #æœ¬åœ°é•œåƒåˆ—è¡¨
$ docker search &lt;å…³é”®å­—&gt; #æ£€ç´¢é•œåƒ
$ docker pull &lt;é•œåƒå&gt;[:&lt;tag&gt;] #æ‹‰å–é•œåƒã€‚tagæŒ‡å®šç‰ˆæœ¬ï¼Œç¼ºçœåˆ™ä¸ºlatest
$ docker inspect &lt;é•œåƒå&gt;#æŸ¥çœ‹é•œåƒè¯¦ç»†ä¿¡æ¯
$ docker rmi &lt;é•œåƒid&gt; #åˆ é™¤æŒ‡å®šé•œåƒ

docker network ps
docker network rm &lt;ç½‘ç»œå&gt; #æ³¨æ„å‡ ä¸ªé»˜è®¤çš„ä¸è¦åˆ é™¤
</code></pre>
<h3 id="å®¹å™¨-1"><a class="header" href="#å®¹å™¨-1">å®¹å™¨</a></h3>
<ul>
<li>é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œå®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚</li>
<li>UnionFS (è”åˆæ–‡ä»¶ç³»ç»Ÿ) : Unionæ–‡ä»¶ç³»ç»Ÿ(UnionFS) æ˜¯ä¸€ç§åˆ†å±‚ã€ è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ”¯æŒå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚çš„å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹(unite several directories into a single virtual filesystem)ã€‚Union æ–‡ä»¶ç³»ç»Ÿæ˜¯Dockeré•œåƒçš„åŸºç¡€ã€‚é•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥è¿›è¡Œç»§æ‰¿ï¼ŒåŸºäºåŸºç¡€é•œåƒ(æ²¡æœ‰çˆ¶é•œåƒ)ï¼Œå¯ä»¥åˆ¶ä½œå„ç§å…·ä½“çš„åº”ç”¨é•œåƒã€‚
<ul>
<li>ç‰¹æ€§ï¼šä¸€æ¬¡åŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä»å¤–é¢çœ‹èµ·æ¥ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè”åˆåŠ è½½ä¼šæŠŠå„å±‚æ–‡ä»¶ç³»ç»Ÿå åŠ èµ·æ¥ï¼Œè¿™æ ·æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«æ‰€æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•</li>
</ul>
</li>
<li>Dockeré•œåƒåŠ è½½åŸç†ï¼šdockerçš„é•œåƒå®é™…ä¸Šç”±ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œè¿™ç§å±‚çº§çš„æ–‡ä»¶ç³»ç»ŸUnionFS.
<ul>
<li>bootfs(boot file system)ä¸»è¦åŒ…å«bootloaderå’Œkernelï¼Œbootloaderä¸»è¦æ˜¯å¼•å¯¼åŠ è½½kernelï¼ŒLinuxåˆšå¯åŠ¨æ—¶ä¼šåŠ è½½bootfsæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨Dockeré•œåƒçš„æœ€åº•å±‚æ˜¯bootfsã€‚è¿™ä¸€å±‚ä¸æˆ‘ä»¬å…¸å‹çš„Linux/Unixç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼ŒåŒ…å«bootåŠ è½½å™¨å’Œå†…æ ¸ã€‚å½“bootåŠ è½½å®Œæˆä¹‹åæ•´ä¸ªå†…æ ¸å°±éƒ½åœ¨å†…å­˜ä¸­äº†ï¼Œæ­¤æ—¶å†…å­˜çš„ä½¿ç”¨æƒå·±ç”±bootfsè½¬äº¤ç»™å†…æ ¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¹Ÿä¼šå¸è½½bootfsã€‚</li>
<li>rootfs (root file system)ï¼Œåœ¨bootfsä¹‹ ä¸Šã€‚ åŒ…å«çš„å°±æ˜¯å…¸å‹Linuxç³»ç»Ÿä¸­çš„/dev, /proc, /bin, /etcç­‰æ ‡å‡†ç›®å½•å’Œæ–‡ä»¶ã€‚rootfs å°±æ˜¯å„ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆï¼Œæ¯”å¦‚Ubuntuï¼ŒCentosç­‰ ç­‰ã€‚</li>
<li>å¯¹äºä¸€ä¸ªç²¾ç®€çš„OSï¼Œrootfså¯ä»¥å¾ˆå°ï¼Œåªéœ€è¦åŒ…æ‹¬æœ€åŸºæœ¬çš„å‘½ä»¤ã€å·¥å…·å’Œç¨‹åºåº“å°±å¯ä»¥äº†,å› ä¸ºåº•å±‚ç›´æ¥ç”¨Hostçš„kernel,è‡ªå·±åªéœ€è¦æä¾›rootfså°±è¡Œäº†ã€‚ç”±æ­¤å¯è§å¯¹äºä¸åŒçš„linuxå‘è¡Œç‰ˆ, bootfsåŸºæœ¬æ˜¯ä¸€è‡´çš„, rootfsä¼šæœ‰å·®åˆ«,å› æ­¤ä¸åŒçš„å‘è¡Œç‰ˆå¯ä»¥å…¬ç”¨bootfsã€‚</li>
</ul>
</li>
<li>åˆ†å±‚çš„é•œåƒï¼šä»¥æˆ‘ä»¬çš„pullä¸ºä¾‹ï¼Œåœ¨ä¸‹è½½çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°dockerçš„é•œåƒå¥½åƒæ˜¯åœ¨ä¸€å±‚ä¸€å±‚çš„åœ¨ä¸‹è½½å¾ˆå¤šé•œåƒ</li>
<li>æœ€å¤§çš„ä¸€ä¸ªå¥½å¤„å°±æ˜¯ï¼šå…±äº«èµ„æº
<ul>
<li>æ¯”å¦‚:æœ‰å¤šä¸ªé•œåƒéƒ½ä»ç›¸åŒçš„baseé•œåƒæ„å»ºè€Œæ¥ï¼Œé‚£ä¹ˆå®¿ä¸»æœºåªéœ€åœ¨ç£ç›˜ä¸Šä¿å­˜ä¸€-ä»½baseé•œåƒï¼ŒåŒæ—¶å†…å­˜ä¸­ä¹Ÿåªéœ€åŠ è½½ä¸€ä»½baseé•œåƒï¼Œå°±å¯ä»¥ä¸ºæ‰€æœ‰å®¹å™¨æœåŠ¡äº†ã€‚è€Œä¸”é•œåƒçš„æ¯ä¸€å±‚éƒ½å¯ä»¥è¢«å…±äº«ã€‚</li>
</ul>
</li>
<li>Dockeré•œåƒéƒ½æ˜¯åªè¯»çš„ã€‚å½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„å¯å†™å±‚è¢«åŠ è½½åˆ°é•œåƒçš„é¡¶éƒ¨ã€‚è¿™ä¸€å±‚é€šå¸¸è¢«ç§°ä½œâ€œå®¹å™¨å±‚â€ï¼Œâ€œå®¹ å™¨å±‚â€ä¹‹ä¸‹çš„éƒ½å«&quot;é•œåƒå±‚</li>
</ul>
<pre><code class="language-shell">$ docker ps #å®¹å™¨åˆ—è¡¨ã€‚-aè¡¨ç¤ºæ‰€æœ‰åŒ…æ‹¬æœªè¿è¡Œçš„å®¹å™¨
$ docker logs &lt;container-name | container-id&gt; #æŸ¥çœ‹æŒ‡å®šå®¹å™¨æ—¥å¿—
$ docker run [--name &lt;container-name&gt;] [-d|-it] [-p &lt;container-port&gt;:&lt;port&gt;] [-e &lt;key&gt;:&lt;value&gt;] &lt;image-id&gt;  #è¿è¡ŒæŒ‡å®šå®¹å™¨ã€‚--nameä¸ºå®¹å™¨å–åï¼›-då®ˆæŠ¤å¼è¿è¡Œï¼ˆå³åå°è¿è¡Œï¼‰ï¼Œ-itäº¤äº’å¼è¿è¡Œï¼ˆå³è¿›å…¥å®¹å™¨äº¤äº’ï¼‰ï¼›-pæŒ‡å®šå°†å®¹å™¨å†…çš„ç«¯å£æ˜ å°„åˆ°å®ä½“æœºçš„ç«¯å£ï¼›-eé…ç½®ç¯å¢ƒå‚æ•°
$ docker start &lt;container-name | container-id&gt; #å¯åŠ¨
$ docker restart &lt;container-name | container-id&gt; #é‡å¯
$ docker stop &lt;container-name | container-id&gt; #åœæ­¢
$ docker stop &lt;container-name | container-id&gt; #å¼ºåˆ¶åœæ­¢
$ docker rm &lt;container-id&gt; #åˆ é™¤æŒ‡å®šå®¹å™¨
$ docker rm -f $(docker ps -a -q) #æ¡ä»¶æ‰¹é‡åˆ é™¤
$ docker ps-a-q | xargs docker rm #æ¡ä»¶æ‰¹é‡åˆ é™¤

$ docker top &lt;container-id&gt;
$ docker commit &lt;container-id&gt; &lt;è¦åˆ›å»ºçš„ç›®æ ‡é•œåƒå:[æ ‡ç­¾å]&gt;  -a=&quot;&lt;ä½œè€…&gt;&quot; -m=&quot;&lt;æäº¤çš„æè¿°ä¿¡æ¯&gt;&quot;
 #æäº¤å®¹å™¨å‰¯æœ¬ä½¿ä¹‹æˆä¸ºä¸€ä¸ªæ–°çš„é•œåƒï¼Œå¯ä»¥docker ps -açœ‹åˆ°
</code></pre>
<p>åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨</p>
<pre><code class="language-sh">docker stop $(docker ps -q)
docker rm $(docker ps -aq)
</code></pre>
<p>æ‰§è¡Œå®¹å™¨</p>
<pre><code class="language-shell">$ docker exec -it &lt;container-id&gt; &lt;bashshell&gt; #æ‰§è¡Œä¼ªç»ˆç«¯ã€‚-itè¡¨ç¤º-i -tï¼Œå°†ä¸ºå®¹å™¨åˆ†é…ä¼ªç»ˆç«¯ï¼Œå¯ä»¥è¿›è¡Œäº¤äº’
$ docker exec -it &lt;container-id&gt; /bin/bash
$ docker exec -it &lt;container-id&gt; bash
$ docker exec -it &lt;container-id&gt; ls /
$ docker attach &lt;container-id&gt; #é‡æ–°è¿›å…¥
$ exit #é€€å‡ºå®¹å™¨äº¤äº’å¹¶åœæ­¢å®¹å™¨
ctrl+q+p #é€€å‡ºå®¹å™¨äº¤äº’ä½†å®¹å™¨ä¸åœæ­¢

$ docker cp &lt;container-id&gt;:/xxx/xxx.log /app/temp #æ‹·è´å®¹å™¨ä¸­çš„æ–‡ä»¶åˆ°æœ¬åœ°å®¿ä¸»ä¸»æœº
</code></pre>
<pre><code class="language-cmd">docker exec -it mysql8 bash #è¿›å…¥å®¹å™¨åä¸ºmysql8çš„å®¹å™¨
mysql -uroot -p123456 #è¿›å…¥mysql8åï¼Œå¯ä»¥ä½¿ç”¨mysqlå‘½ä»¤è¡Œï¼Œç™»å½•mysql

grant all privileges on *.* to 'root'@'%'; #æ·»åŠ æƒé™ï¼Œ%è¡¨ç¤ºæ‰€æœ‰ipå¯ä»¥ç™»å…¥ï¼Œ%å¯ä»¥æ›¿æ¢ä¸ºå…·ä½“ipä»¥ç»™æŸipå¼€æ”¾rootç™»å…¥æƒé™

#ä¹Ÿå¯ä»¥è¿™æ ·åˆ°è¡¨ä¸­ä¿®æ”¹æƒé™
use mysql; #è¿›åˆ°mysqlåº“
select host, user, plugin from user; #æŸ¥çœ‹userè¡¨ï¼Œå¯ä»¥çœ‹åˆ°rootçš„hostæ˜¯localhostï¼Œåªå…è®¸æœ¬åœ°ç™»å…¥
update user set host='%' where user='root' #ä¿®æ”¹æƒé™ï¼Œ%è¡¨ç¤ºæ‰€æœ‰ipå¯ä»¥ç™»å…¥ï¼Œ%å¯ä»¥æ›¿æ¢ä¸ºå…·ä½“ipä»¥ç»™æŸipå¼€æ”¾rootç™»å…¥æƒé™

flush privileges; #é‡æ–°åŠ è½½æƒé™
</code></pre>
<h2 id="å®¹å™¨æ•°æ®å·"><a class="header" href="#å®¹å™¨æ•°æ®å·">å®¹å™¨æ•°æ®å·</a></h2>
<ul>
<li>æŒä¹…åŒ–
<ul>
<li>å°†è¿ç”¨ä¸è¿è¡Œçš„ç¯å¢ƒæ‰“åŒ…å½¢æˆå®¹å™¨è¿è¡Œï¼Œè¿è¡Œå¯ä»¥ä¼´éšç€å®¹å™¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹æ•°æ®çš„è¦æ±‚å¸Œæœ›æ˜¯æŒä¹…åŒ–çš„</li>
<li>å®¹å™¨ä¹‹é—´å¸Œæœ›æœ‰å¯èƒ½å…±äº«æ•°æ®</li>
<li>Dockerå®¹å™¨äº§ç”Ÿçš„æ•°æ®ï¼Œå¦‚æœä¸é€šè¿‡docker commitç”Ÿæˆæ–°çš„é•œåƒï¼Œä½¿å¾—æ•°æ®åšä¸ºé•œåƒçš„ä¸€ éƒ¨åˆ†ä¿å­˜ä¸‹æ¥ï¼Œé‚£ä¹ˆå½“å®¹å™¨åˆ é™¤åï¼Œæ•°æ®è‡ªç„¶ä¹Ÿå°±æ²¡æœ‰äº†ã€‚</li>
<li>ä¸ºäº†èƒ½ä¿å­˜æ•°æ®åœ¨dockerä¸­æˆ‘ä»¬ä½¿ç”¨å·ã€‚</li>
</ul>
</li>
<li>å·å°±æ˜¯ç›®å½•æˆ–æ–‡ä»¶ï¼Œå­˜åœ¨äº-ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä¸­ï¼Œç”±dockeræŒ‚ è½½åˆ°å®¹å™¨ï¼Œä½†ä¸å±äºè”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤èƒ½å¤Ÿç»•è¿‡Union File Systemæä¾›ä¸€äº›ç”¨äºæŒç»­å­˜å‚¨æˆ–å…±äº«æ•°æ®çš„ç‰¹æ€§:å·çš„è®¾è®¡ç›®çš„å°±æ˜¯æ•°æ®çš„æŒä¹…åŒ–ï¼Œå®Œå…¨ç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå­˜å‘¨æœŸï¼Œå› æ­¤Dockerä¸ä¼šåœ¨å®¹å™¨åˆ é™¤æ—¶åˆ é™¤å…¶æŒ‚è½½çš„æ•°æ®å·
<ul>
<li>1:æ•°æ®å·å¯åœ¨å®¹å™¨ä¹‹é—´å…±äº«æˆ–é‡ç”¨æ•°æ®</li>
<li>2: å·ä¸­çš„æ›´æ”¹å¯ä»¥ç›´æ¥ç”Ÿæ•ˆ</li>
<li>3:æ•°æ®å·ä¸­çš„æ›´æ”¹ä¸ä¼šåŒ…å«åœ¨é•œåƒçš„æ›´æ–°ä¸­</li>
<li>4:æ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢</li>
</ul>
</li>
</ul>
<h3 id="å®¹å™¨å·æ·»åŠ "><a class="header" href="#å®¹å™¨å·æ·»åŠ ">å®¹å™¨å·æ·»åŠ </a></h3>
<h6 id="ç›´æ¥å‘½ä»¤æ·»åŠ "><a class="header" href="#ç›´æ¥å‘½ä»¤æ·»åŠ ">ç›´æ¥å‘½ä»¤æ·»åŠ </a></h6>
<pre><code class="language-shell">$ docker run &lt;æŒ‡å®šé•œåƒ&gt; -it -v &lt;/å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•&gt;:&lt;/å®¹å™¨å†…ç›®å½•&gt;  #-væŒ‡å®šhostä¸containerçš„æ•°æ®åŒæ­¥ç›®å½•ï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨åˆ™å°†åˆ›å»ºç›®å½•ï¼Œæ•°æ®å°†å®ç°å®æ—¶åŒæ­¥ï¼Œä¸¤è¾¹éƒ½å¯è¯»å†™ã€‚-vå‚æ•°å¯ä»¥å¤šä½¿ç”¨ï¼Œå½¢æˆä¸€ä¸€å¯¹åº”çš„å¤šå¯¹åŒæ­¥ç›®å½•
$ docker run &lt;æŒ‡å®šé•œåƒ&gt; -it -v &lt;/å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•&gt;:&lt;/å®¹å™¨å†…ç›®å½•:ro&gt; #é™åˆ¶å®¹å™¨ç›®å½•åªè¯»
</code></pre>
<h6 id="dockerfileæ·»åŠ "><a class="header" href="#dockerfileæ·»åŠ ">DockerFileæ·»åŠ </a></h6>
<ul>
<li>æ–°å»º/mydockeræ–‡ä»¶å¤¹å¹¶è¿›å…¥</li>
<li>åœ¨Dockerfileä¸­ä½¿ç”¨VOLUMEæŒ‡ä»¤æ¥ç»™é•œåƒæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å·
<ul>
<li>VOLUME[&quot;/dataVolumeContainer&quot;,&quot;/dataVolumeContainer2&quot;, &quot;/dataVolumeContainer3&quot;]</li>
<li>å‡ºäºå¯ç§»æ¤å’Œåˆ†äº«çš„è€ƒè™‘ï¼Œç”¨-vä¸»æœºç›®å½•:å®¹å™¨ç›®å½•è¿™ç§æ–¹æ³•ä¸èƒ½å¤Ÿç›´æ¥åœ¨Dockerfileä¸­å®ç°ã€‚ç”±äºå®¿ä¸»æœºç›®å½•æ˜¯ä¾èµ–äºç‰¹å®šå®¿ä¸»æœºçš„ï¼Œå¹¶ä¸èƒ½å¤Ÿä¿è¯åœ¨æ‰€æœ‰çš„å®¿ä¸»æœºä¸Šéƒ½å­˜åœ¨è¿™æ ·çš„ç‰¹å®šç›®å½•ã€‚ä½†æ˜¯ä¼šæœ‰é»˜è®¤çš„ç›®å½•ï¼Œé€šè¿‡<code>docker inspect</code>å³å¯æŸ¥çœ‹åˆ°</li>
</ul>
</li>
</ul>
<pre><code class="language-dockerfile">#dockerfileï¼ŒæŒ‰åºæ‰§è¡Œçš„è„šæœ¬ï¼Œæ¯ä¸ªFROMçš„é•œåƒéƒ½ä¼šä½œä¸ºä¸€å±‚ç¯å¢ƒè¢«è£…è½½
FROM centos
VOLUME [&quot; /dataVolumeContainerA&quot; ,&quot; /dataVolumeContainerB&quot; ]
CMD echo &quot;finished, -------- success1&quot;
CMD /bin/bash
</code></pre>
<ul>
<li>
<p>docker buildç”Ÿæˆé•œåƒ</p>
<pre><code class="language-shell">$ docker build -f /mydocker/dockerfile -t yuanya/centos . #-fæŒ‡å®šè¦æ„å»ºçš„dockerfileï¼›-tä¸ºç”Ÿæˆçš„é•œåƒå–å
$ docker run yuanya/centos -d #å¦‚æœåé¢å‡ºç°å®¹å™¨æ•°æ®å·åªèƒ½è¯»çš„æƒ…å†µï¼Œå°±åŠ ä¸Š--privileged=trueèµ‹äºˆå®¹å™¨æ‰©å±•çš„ç‰¹æƒ
$ docker inspect yuanya/centos
</code></pre>
</li>
</ul>
<h6 id="æ•°æ®å·å®¹å™¨"><a class="header" href="#æ•°æ®å·å®¹å™¨">æ•°æ®å·å®¹å™¨</a></h6>
<ul>
<li>å‘½åçš„å®¹å™¨æŒ‚è½½æ•°æ®å·ï¼Œå…¶å®ƒå®¹å™¨é€šè¿‡æŒ‚è½½è¿™ä¸ª(çˆ¶å®¹å™¨)å®ç°æ•°æ®å…±äº«ï¼ŒæŒ‚è½½æ•°æ®å·çš„å®¹å™¨ï¼Œç§°ä¹‹ä¸ºæ•°æ®å·å®¹å™¨</li>
<li>å³å®¹å™¨é—´ä¼ é€’å…±äº«(--volumes-from)</li>
</ul>
<pre><code class="language-shell">$ docker run yuanya/centos -it --name dc01 #å¯åŠ¨ä¸€ä¸ª01
$ docker run yuanya/centos -it --name dc02 --volumes-from dc01 #å°†ä½¿dc02ä¸dc01å…±äº«VOLUMEé…ç½®çš„æ•°æ®å·
$ docker run yuanya/centos -it --name dc03 --volumes-from dc01 #å°†ä½¿dc03ä¸dc01å…±äº«VOLUMEé…ç½®çš„æ•°æ®å·
#å³å®Œæˆdc01ã€dc02ã€dc03ä¹‹é—´ç›¸äº’å…±äº«VOLUMEé…ç½®çš„æ•°æ®å·
</code></pre>
<h2 id="dockerfile"><a class="header" href="#dockerfile">DockerFile</a></h2>
<ul>
<li>Dockerfileæ˜¯ç”¨æ¥æ„å»ºDockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬</li>
</ul>
<pre><code class="language-dockerfile">#ç›¸å½“äºdocker run æ—¶åŠ  bash
CMD /bin/bash
CMD [&quot;/bin/bash&quot;]
</code></pre>
<p>dockerfileè§£æè¿‡ç¨‹</p>
<ul>
<li>Dockerfileå†…å®¹åŸºç¡€çŸ¥è¯†
<ul>
<li>æ¯æ¡ä¿ç•™å­—æŒ‡ä»¤éƒ½å¿…é¡»ä¸ºå¤§å†™å­—æ¯ä¸”åé¢è¦è·Ÿéšè‡³å°‘ä¸€ä¸ªå‚æ•°</li>
<li>æŒ‡ä»¤æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹ï¼Œé¡ºåºæ‰§è¡Œ</li>
<li>#è¡¨ç¤ºæ³¨é‡Š</li>
<li>æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒå±‚ï¼Œå¹¶å¯¹é•œåƒè¿›è¡Œæäº¤</li>
</ul>
</li>
<li>ä¿ç•™å­—æŒ‡ä»¤ï¼ˆå…³é”®å­—ï¼‰
<ul>
<li>FROMï¼šåŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„</li>
<li>MAINTAINERï¼šé•œåƒç»´æŠ¤è€… çš„å§“åå’Œé‚®ç®±åœ°å€</li>
<li>RUNï¼šå®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤</li>
<li>EXPOSEï¼šå½“å‰å®¹å™¨å¯¹å¤–æš´éœ²å‡ºçš„ç«¯å£</li>
<li>WORKDIRï¼šæŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œè¿›å…¥å®¹å™¨ä¼ªç»ˆç«¯çš„é»˜è®¤å·¥ä½œç›®å½•</li>
<li>ENVï¼šç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡
<ul>
<li>å¦‚ ENV MY_ PATH /usr/mytestã€‚è¿™ä¸ªç¯å¢ƒå˜é‡å¯ä»¥åœ¨åç»­çš„ä»»ä½•RUNæŒ‡ä»¤ä¸­ä½¿ç”¨ï¼Œè¿™å°±å¦‚åŒåœ¨å‘½ä»¤å‰é¢æŒ‡å®šäº†ç¯å¢ƒå˜é‡å‰ç¼€ä¸€-æ ·ï¼›ä¹Ÿå¯ä»¥åœ¨å…¶å®ƒæŒ‡ä»¤ä¸­ç›´æ¥ä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚: WORKDIR $MY_ PATH</li>
</ul>
</li>
<li>ADDï¼šcopy + è§£å‹ç¼©ã€‚å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…</li>
<li>COPYï¼šç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ã€‚å°†ä»æ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­&lt;æºè·¯å¾„&gt;çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„&lt;ç›®æ ‡è·¯å¾„&gt;ä½ç½®
<ul>
<li>shellæ ¼å¼ï¼šCOPY src des</li>
<li>execæ ¼å¼ï¼šCOPY [&quot;src&quot;, &quot;dest&quot;]</li>
</ul>
</li>
<li>VOLUMEï¼šå®¹å™¨æ•°æ®å·ï¼Œ ç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ</li>
<li>CMD
<ul>
<li>æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚CMDæŒ‡ä»¤çš„æ ¼å¼å’ŒRUN ç›¸ä¼¼,ä¹Ÿæ˜¯ä¸¤ç§æ ¼å¼
<ul>
<li>shellæ ¼å¼ï¼šCMD &lt;å‘½ä»¤&gt;</li>
<li>execæ ¼å¼ï¼šCMD [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;ï¼Œâ€å‚æ•°1&quot;ï¼Œ â€œå‚æ•°2...]</li>
<li>å‚æ•°åˆ—è¡¨æ ¼å¼ï¼šCMD [&quot;å‚æ•°1&quot;ï¼Œâ€œå‚æ•°2&quot;...]ã€‚åœ¨æŒ‡å®šäº†ENTRYPOINT æŒ‡ä»¤åï¼Œç”¨CMD æŒ‡å®šå…·ä½“çš„å‚
æ•°ã€‚</li>
</ul>
</li>
<li>Dockerfileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä½†åªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼ŒCMDä¼šè¢«docker runä¹‹åçš„å‚æ•°æ›¿æ¢.ã€‚</li>
</ul>
</li>
<li>ENTRYPOINT
<ul>
<li>æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤</li>
<li>ENTRYPOINTçš„ç›®çš„å’ŒCMDä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°ï¼Œä½†æ˜¯å‘½ä»¤æ˜¯è¿½åŠ çš„ï¼Œä¸ä¼šè¦†ç›–å‰é¢çš„å‘½ä»¤ï¼Œæ¯”å¦‚åœ¨æ˜¯ ENTRYPOINT [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;ï¼Œâ€å‚æ•°1&quot;]ï¼Œè¿è¡Œæ—¶docker run xxx -iï¼Œå°†å˜ä¸ºENTRYPOINT [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;ï¼Œâ€å‚æ•°1&quot;ï¼Œ&quot;-i&quot;]ï¼Œç­‰äºå¯ä»¥è¿½åŠ å‚æ•°çš„æ•ˆæœ</li>
</ul>
</li>
<li>ONBUILDï¼šå½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„Dockerfileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­ç»§æ‰¿åçˆ¶é•œåƒçš„onbuildè¢«è§¦å‘</li>
</ul>
</li>
</ul>
<p>æ¡ˆä¾‹</p>
<ul>
<li>
<p>Baseé•œåƒ(scratch)ï¼šDockerHubä¸­99%çš„é•œåƒéƒ½æ˜¯é€šè¿‡åœ¨baseé•œåƒä¸­å®‰è£…å’Œé…ç½®éœ€è¦çš„è½¯ä»¶æ„å»ºå‡ºæ¥çš„</p>
<ul>
<li>scratchï¼šan explicitly empty image, especially for building images &quot;FROM scratch&quot;</li>
</ul>
</li>
<li>
<p>centosçš„é•œåƒå¾ˆç²¾ç®€ï¼Œæˆ‘ä»¬é€šè¿‡dockerfileè‡ªå®šä¹‰ä¸€ä¸ªcentosé•œåƒä½¿å…¶æ‹¥æœ‰vimã€ifconfigç­‰å‘½ä»¤åŠå…¶å®ƒè‡ªå®šä¹‰å†…å®¹</p>
<p>/mydocker/dockerfile01</p>
<pre><code class="language-dockerfile">from centos
MAINTAINER yuanya&lt;yuanyatianchi@google.com&gt;

ENV MY_PATH /tmp
WORKDIR $MY_PATH

RUN yum -y install vim
RUN yum -y install net-tools

EXPOSE 80

CMD echo $MY_PATH
CMD echo &quot;success-ok&quot;
CMD /bin/bash
</code></pre>
<pre><code class="language-shell">$ docker build -f /mydocker/dockerfile01 -t mycentos:1.0 #æ„å»º
$ docker run - it mycentos:1.0 #è¿è¡Œ
$ docker history &lt;å®¹å™¨id&gt; #æŸ¥çœ‹å†å²
</code></pre>
</li>
</ul>
<p>å®šåˆ¶tomcat9</p>
<pre><code class="language-dockerfile">FROM centos
MAINTAINER zzyy&lt; zzyybs@126. com&gt;
#æŠŠå®¿ä¸»æœºå½“å‰ä¸Šä¸‹æ–‡çš„C. txtæ‹·è´åˆ°å®¹å™¨/usr/local/è·¯å¾„ä¸‹
COPY c.txt /usr/local/cincontainer.txt
#æŠŠjavaä¸tomcatæ·»åŠ åˆ°å®¹å™¨ä¸­
ADD jdk 8u171- linux -x64. tar .gz /usr/local/
ADD apache tomcat 9.0.8. tar.gz /usr/local/
#å®‰è£…vimç¼–è¾‘å™¨
RUN yum -y install vim
#è®¾ç½®å·¥ä½œè®¿é—®æ—¶å€™çš„WORKDIRè·¯å¾„ï¼Œç™»å½•è½è„šç‚¹
ENV MYPATH /usr/local
WORKDIR $MYPATH
#é…ç½®javaä¸tomcatç¯å¢ƒå˜é‡
ENV JAVA HOME /usr/local/jdk1.8.0_ 171
ENV CLASSPATH $JAVA HOME/lib/dt . jar :$JAVA_ HOME/1ib/ tools. jan
ENV CATALINA HOME /usr/local/apache-tomcat-9.0.8
ENV CATALINA BASE /usr/ local/ apache-tomcat-9.0.8
ENV PATH $PATH:$JAVA_ HOME/bin: $CATAL INA HOME/lib: $CATAL INA HOME/bin
#å®¹å™¨è¿è¡Œæ—¶ç›‘å¬çš„ç«¯å£
EXPOSE 8080
#å¯åŠ¨æ—¶è¿è¡Œtomcat
# ENTRYPOINT [&quot; /usr/local/ apache -tomcat 9.0.8/bin/startup.sh&quot; ]
# CMD [&quot; /usr/local/apache -tomcat- 9.0. 8/bin/catalina. sh&quot; ,&quot;run&quot;]
CMD /usr/1ocal/apache-tomcat-9.0.8/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.8/bin/1ogs/catalina.out

</code></pre>
<pre><code class="language-shell">docker run -d -p 9080:8080 --name myt9
-V /zzyyuse/mydockerfile/tomcat9/tesf:/usr/local/apache-tomcat-9.0.8/webapps/ test
-V /zzyyuse/mydockerfile/tomcat9/tomcat9logs/:/usr/local/apache-tomcat-9.0.8/logs
--pr ivi leged=true
zzyytomcat9
#è®¾ç½®å®¹å™¨å·ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬ç›´æ¥æŠŠæœåŠ¡éƒ¨ç½²åˆ°ä¸»æœºtomcat9/testå³å¯åŒæ­¥åˆ°å®¹å™¨tomcat-9.0.8/webapps/testä¸Šè¿è¡Œäº†
</code></pre>
<h2 id="è½¯ä»¶"><a class="header" href="#è½¯ä»¶">è½¯ä»¶</a></h2>
<h6 id="mysql"><a class="header" href="#mysql">MySql</a></h6>
<pre><code class="language-shell">$ docker pull mysql:5.7
$ docker run mysql:5.7 --name mysql01 -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=yuanya #è®¾ç½®MYSQL_ROOT_PASSWORDï¼Œå¦åˆ™å¯†ç éšæœº
</code></pre>
<h6 id="elesticsearch"><a class="header" href="#elesticsearch">ElesticSearch</a></h6>
<pre><code class="language-shell">$ docker pull elasticsearch:7.5.2

$ docker run --name elasticsearch -d -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e &quot;ES_JAVA_OPTS=-Xms256m -Xmx256m&quot; elasticsearch:tag
</code></pre>
<h6 id="kibana"><a class="header" href="#kibana">Kibana</a></h6>
<pre><code class="language-shell">$ ocker pull kibana:7.5.2
$ docker run --name kibana --link elasticsearch_CONTAINER_ID:elasticsearch -d -p 5601:5601 kibana:tag
</code></pre>
<h6 id="rabbitmq"><a class="header" href="#rabbitmq">RabbitMQ</a></h6>
<p>å¸¦æœ‰managementçš„æ˜¯å¸¦æœ‰webæ§åˆ¶å°çš„ï¼Œé€šè¿‡15672ç«¯å£è®¿é—®æ§åˆ¶å°ï¼Œç¼ºçœè´¦å·å¯†ç guest</p>
<pre><code class="language-shell">$ docker pull rabbitmq:3.7.24-management 
$ docker run -d -p 5672:5672 -p 15672:15672 rabbitmq:3.7.24-management
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;kubernetes&quot;
description = &quot;it.cloud.kubernetes&quot;
tags = [&quot;it&quot;, &quot;cloud&quot;, &quot;kubernetes&quot;]</p>
<p>+++</p>
<h1 id="kuberneteså¼€å§‹"><a class="header" href="#kuberneteså¼€å§‹">kubernetes.å¼€å§‹</a></h1>
<h2 id="å®‰è£…-1"><a class="header" href="#å®‰è£…-1">å®‰è£…</a></h2>
<p>éµç…§<a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#%E5%87%86%E5%A4%87%E5%BC%80%E5%A7%8B">kubeadmå®‰è£…å‡†å¤‡</a>ï¼Œç¦ç”¨äº¤æ¢åˆ†åŒºï¼Œå¯ç”¨<a href="https://kubernetes.io/zh/docs/reference/ports-and-protocols/">å¿…éœ€ç«¯å£</a>å¹¶è¿›è¡Œ<a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#check-required-ports">æ£€æŸ¥</a>ï¼Œ<a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#%E5%85%81%E8%AE%B8-iptables-%E6%A3%80%E6%9F%A5%E6%A1%A5%E6%8E%A5%E6%B5%81%E9%87%8F">å…è®¸iptablesæ£€æŸ¥æ¡¥æ¥æµé‡</a>ã€‚</p>
<pre><code class="language-shell"># å…³é—­swapåˆ†åŒº(æ°¸ä¹…)ï¼šæŠŠåŠ è½½swapåˆ†åŒºçš„é‚£è¡Œè®°å½•æ³¨é‡Šæ‰ï¼Œé‡å¯ç”Ÿæ•ˆ
sed -ri 's/.*swap.*/#&amp;/' /etc/fstab

# é…ç½®br_netfilteræ¨¡å—
cat &lt;&lt;EOF | tee /etc/modules-load.d/k8s.conf
br_netfilter
EOF
# åŠ è½½ã€‚ä¹Ÿå¯ä»¥rebootä»¥åŠ è½½
modprobe  br_netfilter &amp;&amp; lsmod | grep br_netfilter

# å…è®¸iptablesæ£€æŸ¥æ¡¥æ¥æµé‡
cat &lt;&lt;EOF | tee /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
# ä½¿ç”Ÿæ•ˆ
sysctl --system
</code></pre>
<h3 id="ubuntu-2"><a class="header" href="#ubuntu-2">ubuntu</a></h3>
<pre><code class="language-shell"># å…³é—­swapåˆ†åŒº(ä¸´æ—¶)
swapoff -a

# é˜²ç«å¢™ï¼šå…³é—­é˜²ç«å¢™æˆ–è€…å¼€æ”¾å®˜æ–¹æŒ‡å—ä¸­æŒ‡å®šçš„ç«¯å£ã€‚ubuntué»˜è®¤ä¸ºå…³é—­çŠ¶æ€ï¼Œè¿™é‡Œä»…æŸ¥çœ‹
ufw status

# å¿…è¦å·¥å…·
apt install -y apt-transport-https ca-certificates curl gnupg lsb-release
</code></pre>
<h4 id="docker-1"><a class="header" href="#docker-1">docker</a></h4>
<blockquote>
<p><a href="https://yeasy.gitbook.io/docker_practice/install/ubuntu">ubuntuå®‰è£…docker</a>ï¼›</p>
</blockquote>
<pre><code class="language-shell"># å‹¿åœ¨æ²¡æœ‰é…ç½®Docker APTæºçš„æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨aptå‘½ä»¤å®‰è£…Docker
# å…ˆå¸è½½
apt remove -y docker.io
apt remove -y docker
apt remove -y docker-engine
</code></pre>
<p>ubuntu20.04åå°è¿è¡Œçš„openvpnä¼š<a href="https://askubuntu.com/questions/1302371/docker-ce-post-installation-configuration-failure-on-ubuntu-20-04">å½±å“docker-ceå®‰è£…</a>ï¼Œäº§ç”Ÿ<code>Errors were encountered while processing</code></p>
<pre><code class="language-shell"># åœæ­¢openvpn
service openvpn stop
</code></pre>
<pre><code class="language-shell"># GPGå¯†é’¥
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
# aptæº
echo &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot; | tee /etc/apt/sources.list.d/docker.list &gt; /dev/null

# å®‰è£…
apt update &amp;&amp; apt install -y docker-ce docker-ce-cli containerd.io
# å¼€æœºå¯åŠ¨å¹¶ç«‹å³å¯åŠ¨
systemctl enable --now docker &amp;&amp; systemctl status docker
</code></pre>
<h4 id="kubernetes"><a class="header" href="#kubernetes">kubernetes</a></h4>
<pre><code class="language-shell"># GPGå¯†é’¥
curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg
# aptæº
echo &quot;deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main&quot; | sudo tee /etc/apt/sources.list.d/kubernetes.list

# æŸ¥çœ‹ç‰ˆæœ¬ã€‚å°è¯•äº†kubeadm1.25+docker-ce20ç‰ˆæœ¬å‡ºé”™ï¼Œå› æ­¤é™ä½kubeadmç‰ˆæœ¬
apt-cache madison kubeadm | grep 1.23
# å®‰è£…
apt update &amp;&amp; apt install -y kubeadm=1.23.14-00 kubelet=1.23.14-00 kubectl=1.23.14-00

# å¼€æœºå¯åŠ¨å¹¶ç«‹å³å¯åŠ¨
# ä½†kubeletç°åœ¨æ¯éš”å‡ ç§’å°±ä¼šé‡å¯ï¼Œå› ä¸ºå®ƒé™·å…¥äº†ä¸€ä¸ªç­‰å¾…kubeadmæŒ‡ä»¤çš„æ­»å¾ªç¯
systemctl enable --now kubelet &amp;&amp; systemctl status kubelet
</code></pre>
<h3 id="centos-2"><a class="header" href="#centos-2">centos</a></h3>
<pre><code class="language-shell"># å…³é—­swapåˆ†åŒº(ä¸´æ—¶)
setenforce 0

# é˜²ç«å¢™ï¼šå…³é—­é˜²ç«å¢™æˆ–è€…å¼€æ”¾å®˜æ–¹æŒ‡å—ä¸­æŒ‡å®šçš„ç«¯å£
systemctl disable --now firewalld &amp;&amp; firewall-cmd --state
</code></pre>
<h4 id="docker-2"><a class="header" href="#docker-2">docker</a></h4>
<p>å®‰è£…å®¹å™¨è¿è¡Œæ—¶ï¼Œè¿™é‡Œé€‰æ‹©dockerï¼Œè®¾ç½® <a href="https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo">docker é˜¿é‡Œæº</a>å­˜å‚¨åº“ï¼Œç„¶å<a href="https://docs.docker.com/engine/install/rhel/#install-docker-engine">å®‰è£… Docker Engine å’Œ containerd</a> ã€‚</p>
<pre><code class="language-shell"># yumæº
cat &lt;&lt;EOF | tee /etc/yum.repos.d/docker.repo
[docker-ce-stable]
name=Docker CE Stable - $basearch
baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/\$releasever/\$basearch/stable
enabled=1
gpgcheck=1
gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg
EOF

# å®‰è£…Docker Engineå’Œ containerd
# centos8é»˜è®¤ä½¿ç”¨podmanä»£æ›¿ dockerï¼Œä¼šæç¤ºå†²çªï¼Œæ ¹æ®æç¤ºä½¿ç”¨--allowerasingå‚æ•°ï¼Œè¡¨ç¤ºæ›¿æ¢å†²çªçš„è½¯ä»¶åŒ…
yum install -y --allowerasing docker-ce docker-ce-cli containerd.io

# è®¾ç½®å¼€æœºå¯åŠ¨å¹¶ç«‹å³å¯åŠ¨
systemctl enable --now docker &amp;&amp; systemctl status docker
</code></pre>
<h4 id="kubernetes-1"><a class="header" href="#kubernetes-1">kubernetes</a></h4>
<p>ä½¿ç”¨ centos8 åŸç”ŸåŒ…ç®¡ç†å·¥å…·<a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#%E5%AE%89%E8%A3%85-kubeadm-kubelet-%E5%92%8C-kubectl">å®‰è£… kubeadmã€kubelet å’Œ kubectl</a>ï¼Œä½¿ç”¨ <a href="https://mirrors.aliyun.com/kubernetes/yum/repos/">kubernetes é˜¿é‡Œæº</a>ã€‚</p>
<pre><code class="language-shell">cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt; EOF
[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-\$basearch
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
exclude=kubelet kubeadm kubectl
EOF

# å°† SELinux è®¾ç½®ä¸º permissive æ¨¡å¼ï¼ˆç›¸å½“äºå°†å…¶ç¦ç”¨ï¼‰ã€‚ä¸´æ—¶è®¾ç½®ç«‹å³ç”Ÿæ•ˆï¼Œå¹¶æ°¸ä¹…ç¦ç”¨
setenforce 0
sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config

# å®‰è£…ã€‚kubelet-x.x.x kubeadm-x.x.x kubectl-x.x.x å¯ä»¥æŒ‡å®šç‰ˆæœ¬
yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes
# è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨å¹¶ç«‹å³å¯åŠ¨ï¼Œä½† kubelet ç°åœ¨æ¯éš”å‡ ç§’å°±ä¼šé‡å¯ï¼Œå› ä¸ºå®ƒé™·å…¥äº†ä¸€ä¸ªç­‰å¾… kubeadm æŒ‡ä»¤çš„æ­»å¾ªç¯
systemctl enable --now kubelet
# æŸ¥çœ‹ kubelet
systemctl status kubelet
</code></pre>
<h3 id="äºŒè¿›åˆ¶"><a class="header" href="#äºŒè¿›åˆ¶">äºŒè¿›åˆ¶</a></h3>
<h4 id="kubectl"><a class="header" href="#kubectl">kubectl</a></h4>
<blockquote>
<p><a href="https://kubernetes.io/zh-cn/docs/tasks/tools/install-kubectl-linux/">å®‰è£…kubectl</a>ã€‚</p>
</blockquote>
<pre><code class="language-shell"># kubectl
curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot;
# æ ¡éªŒå’Œ
curl -LO &quot;https://dl.k8s.io/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl.sha256&quot;
# æ ¡éªŒ
echo &quot;$(cat kubectl.sha256)  kubectl&quot; | sha256sum --check
# ç§»åŠ¨
mv kubectl /usr/local/bin
</code></pre>
<h2 id="å‡†å¤‡"><a class="header" href="#å‡†å¤‡">å‡†å¤‡</a></h2>
<h3 id="é…ç½®å®¹å™¨-cgroup-é©±åŠ¨"><a class="header" href="#é…ç½®å®¹å™¨-cgroup-é©±åŠ¨">é…ç½®å®¹å™¨ cgroup é©±åŠ¨</a></h3>
<blockquote>
<p><a href="https://kubernetes.io/zh/docs/setup/production-environment/container-runtimes/#docker">dokceré…ç½®systemdä½œcgroupé©±åŠ¨</a>ï¼›</p>
<p><a href="https://kubernetes.io/zh/docs/tasks/administer-cluster/kubeadm/configure-cgroup-driver/#%E9%85%8D%E7%BD%AE-kubelet-%E7%9A%84-cgroup-%E9%A9%B1%E5%8A%A8">kubeleté…ç½®systemdä½œcgroupé©±åŠ¨</a>ï¼›</p>
</blockquote>
<p>1.22åŠä¹‹å<code>kubeadm init</code>é»˜è®¤ä½¿ç”¨ <code>systemd</code> ä½œä¸º kubelet çš„ cgroup é©±åŠ¨ï¼Œè€Œä¸æ˜¯ <code>cgroupfs</code>ã€‚è¿™é‡Œé¡ºæ‰‹åŠ ä¸Šã€‚</p>
<pre><code class="language-shell"># dockeré…ç½®systemdä½œcgroupé©±åŠ¨ã€‚
# å¦åˆ™kubeadm initæŠ¥é”™dial tcp 127.0.0.1:10248: connect: connection refused
# å¦å¤–é…ç½®äº†æ—¥å¿—ã€é•œåƒæºã€å…è¯ä¹¦éªŒè¯ä»“åº“
cat &lt;&lt;EOF | tee /etc/docker/daemon.json
{
  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],
  &quot;log-driver&quot;: &quot;json-file&quot;,
  &quot;log-opts&quot;: {
    &quot;max-size&quot;: &quot;100m&quot;
  },
  &quot;storage-driver&quot;: &quot;overlay2&quot;,
  &quot;registry-mirrors&quot;: [&quot;https://ohm5orzk.mirror.aliyuncs.com&quot;],
  &quot;insecure-registries&quot;: [&quot;registry.aliyuncs.com&quot;] # [&quot;192.168.xxx.xxx:5000&quot;,&quot;registry.aliyuncs.com&quot;]
}
EOF
# å¯ç”¨é…ç½®å¹¶é‡å¯docker
systemctl daemon-reload &amp;&amp; systemctl restart docker

# kubeleté…ç½®systemdä½œcgroupé©±åŠ¨ã€‚1.23ç‰ˆæœ¬é»˜è®¤ä¸ºsystemdï¼Œæ— éœ€é…ç½®
</code></pre>
<h3 id="æ§åˆ¶å¹³é¢å‡†å¤‡"><a class="header" href="#æ§åˆ¶å¹³é¢å‡†å¤‡">æ§åˆ¶å¹³é¢å‡†å¤‡</a></h3>
<pre><code class="language-shell"># è®¾ç½® hostname
hostnamectl set-hostname 192.168.31.11

# ä¸»èŠ‚ç‚¹æ·»åŠ æœ¬æœº DNS æ˜ å°„
sed -i '$a192.168.31.11 kubecpe' /etc/hosts
</code></pre>
<h3 id="æ•°æ®å¹³é¢å‡†å¤‡"><a class="header" href="#æ•°æ®å¹³é¢å‡†å¤‡">æ•°æ®å¹³é¢å‡†å¤‡</a></h3>
<pre><code class="language-shell"># è®¾ç½® hostname
hostnamectl set-hostname 192.168.31.15
</code></pre>
<h2 id="é›†ç¾¤åˆ›å»º"><a class="header" href="#é›†ç¾¤åˆ›å»º">é›†ç¾¤åˆ›å»º</a></h2>
<p>å‡†å¤‡3å°å®Œæˆå®‰è£…çš„æœºå™¨</p>
<h3 id="kubeadm"><a class="header" href="#kubeadm">kubeadm</a></h3>
<p><a href="https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/">kubeadm å‚è€ƒæŒ‡å—</a>ã€‚</p>
<h4 id="æ§åˆ¶å¹³é¢"><a class="header" href="#æ§åˆ¶å¹³é¢">æ§åˆ¶å¹³é¢</a></h4>
<p><a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8E%A7%E5%88%B6%E5%B9%B3%E9%9D%A2%E8%8A%82%E7%82%B9">åˆå§‹åŒ–æ§åˆ¶å¹³é¢èŠ‚ç‚¹</a>ã€‚æ³¨æ„è¦å†æ¬¡è¿è¡Œ <code>kubeadm init</code>ï¼Œå¿…é¡»é¦–å…ˆ<a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#tear-down">å¸è½½é›†ç¾¤</a>ã€‚å¦‚æœæ˜¯érootç”¨æˆ·</p>
<pre><code class="language-shell"># --apiserver-advertise-address è®¾ç½® master ip
# --image-repository æŒ‡å®šé˜¿é‡Œäº‘é•œåƒä»“åº“åœ°å€ï¼Œå› ä¸ºé»˜è®¤æ‹‰å–é•œåƒåœ°å€ k8s.gcr.io å›½å†…æ— æ³•è®¿é—®ï¼›
$ kubeadm init \
--node-name 192.168.31.11 \
--control-plane-endpoint=kubecpe \
--apiserver-advertise-address=192.168.31.11 \
--pod-network-cidr=10.244.0.0/16 \
--image-repository registry.aliyuncs.com/google_containers

# åˆ›å»ºæˆåŠŸåå¾—åˆ°å¦‚ä¸‹æ“ä½œæç¤º
......
Your Kubernetes control-plane has initialized successfully!

# å¦‚ä½•å¼€å§‹ä½¿ç”¨é›†ç¾¤ï¼ˆkubectlï¼‰
To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME/.kube
  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
  sudo chown $(id -u):$(id -g) $HOME/.kube/config

Alternatively, if you are the root user, you can run:

  export KUBECONFIG=/etc/kubernetes/admin.conf

# å¦‚ä½•å®‰è£… pod ç½‘ç»œ
You should now deploy a pod network to the cluster.
Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:
  https://kubernetes.io/docs/concepts/cluster-administration/addons/

# å¦‚ä½•æ·»åŠ æ§åˆ¶å¹³é¢èŠ‚ç‚¹
You can now join any number of control-plane nodes by copying certificate authorities
and service account keys on each node and then running the following as root:

  kubeadm join kubecpe:6443 --token nhn70c.ck1r8ceu4j4pq3ep \
        --discovery-token-ca-cert-hash sha256:55b9644fc941d4928f40baa30a700973cf375b826fdb8e00012797cdbe0c90c1 \
        --control-plane

# å¦‚ä½•æ·»åŠ å·¥ä½œèŠ‚ç‚¹
Then you can join any number of worker nodes by running the following on each as root:

kubeadm join kubecpe:6443 --token nhn70c.ck1r8ceu4j4pq3ep \
        --discovery-token-ca-cert-hash sha256:55b9644fc941d4928f40baa30a700973cf375b826fdb8e00012797cdbe0c90c1
</code></pre>
<h4 id="ä½¿ç”¨é›†ç¾¤"><a class="header" href="#ä½¿ç”¨é›†ç¾¤">ä½¿ç”¨é›†ç¾¤</a></h4>
<p>å¤åˆ¶ /etc/kubernetes/admin.conf åˆ° $HOME/.kube/config å³å¯ä½¿ç”¨ kubectl</p>
<pre><code class="language-shell">mkdir ~/.kube
cp -i /etc/kubernetes/admin.conf ~/.kube/config
chown $(id -u):$(id -g) ~/.kube/config
</code></pre>
<h4 id="pod-ç½‘ç»œ"><a class="header" href="#pod-ç½‘ç»œ">pod ç½‘ç»œ</a></h4>
<p><a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#pod-network">å®‰è£… pod ç½‘ç»œ</a>ã€‚ä» <a href="https://github.com/flannel-io/flannel/blob/v0.15.1/Documentation/kube-flannel.yml">flannel github</a> ä¸Šå¤åˆ¶ä¸‹æ¥ä½¿ç”¨ï¼Œä½¿ç”¨ -f ç›´æ¥æŒ‡å®šæˆ–è€…ä½¿ç”¨ wget ä¸‹è½½å -f æŒ‡å®šï¼Œéƒ½ä¼šå‡ºç° yaml è§£æé”™è¯¯</p>
<p>å¦‚æœ‰éœ€è¦è¯·<a href="https://huangzhongde.cn/istio/Chapter6/Chapter6-8.html">é…ç½®ç½‘å¡</a>ã€‚</p>
<pre><code class="language-shell"># éƒ¨ç½² kube-flannel
kubectl apply -f /mnt/share/kube-flannel.yaml
</code></pre>
<h4 id="å·¥ä½œèŠ‚ç‚¹"><a class="header" href="#å·¥ä½œèŠ‚ç‚¹">å·¥ä½œèŠ‚ç‚¹</a></h4>
<p>é›†ç¾¤<a href="https://kubernetes.io/zh/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#join-nodes">åŠ å…¥èŠ‚ç‚¹</a>ã€‚å¦‚æœå‰é¢æç¤ºçš„ token å’Œ hash å·²ç»æ‰¾ä¸åˆ°äº†ï¼Œå¯ä»¥åœ¨æ§åˆ¶å¹³é¢èŠ‚ç‚¹ä¸ŠæŸ¥çœ‹ token å’Œ hash</p>
<pre><code class="language-shell"># æŸ¥çœ‹ token åˆ—è¡¨
kubeadm token list
# æˆ–è€…åˆ›å»ºæ–°çš„ token
kubeadm token create
# æŸ¥çœ‹ CA å…¬é’¥çš„å“ˆå¸Œå€¼
openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //'
</code></pre>
<p>ç„¶ååœ¨å·¥ä½œèŠ‚ç‚¹ä¸Šé€šè¿‡ <code>kubeadm join --token &lt;token&gt; &lt;control-plane-host&gt;:&lt;control-plane-port&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;</code> åŠ å…¥é›†ç¾¤ã€‚</p>
<pre><code class="language-shell"># å·¥ä½œèŠ‚ç‚¹æ·»åŠ æ§åˆ¶å¹³é¢èŠ‚ç‚¹çš„ DNS æ˜ å°„
sed -i '$a192.168.31.11 kubecpe' /etc/hosts
# åŠ å…¥é›†ç¾¤
kubeadm join kubecpe:6443 \
--node-name 192.168.31.11 \
--token st4khy.2j4qmbuge5mh1d76 \
--discovery-token-ca-cert-hash sha256:55b9644fc941d4928f40baa30a700973cf375b826fdb8e00012797cdbe0c90c1
</code></pre>
<h4 id="èŠ‚ç‚¹åˆ é™¤"><a class="header" href="#èŠ‚ç‚¹åˆ é™¤">èŠ‚ç‚¹åˆ é™¤</a></h4>
<blockquote>
<p>èŠ‚ç‚¹æ¸…ç†</p>
</blockquote>
<p>å…ˆåœ¨èŠ‚ç‚¹ä¸Šé‡ç½® kubeadm å®‰è£…çš„çŠ¶æ€ï¼Œç„¶åé€šè¿‡ kubectl åˆ é™¤èŠ‚ç‚¹å³å¯ã€‚ä¸»èŠ‚ç‚¹åªéœ€è°ƒç”¨ <code>kubeadm reset</code> ä¼šè¿›è¡Œå°½åŠ›è€Œä¸ºçš„æ¸…ç†</p>
<pre><code class="language-shell"># ä½¿èŠ‚ç‚¹ä¸è°ƒåº¦
kubectl drain &lt;node name&gt; --delete-emptydir-data --force --ignore-daemonsets
kubeadm reset
kubectl delete node &lt;node_name&gt;
</code></pre>
<h4 id="ç½‘ç»œå¸è½½"><a class="header" href="#ç½‘ç»œå¸è½½">ç½‘ç»œå¸è½½</a></h4>
<p>é‡ç½®è¿‡ç¨‹ <code>kubeadm reset</code> ä¸ä¼šé‡ç½®æˆ–æ¸…é™¤ iptables è§„åˆ™æˆ– IPVS è¡¨</p>
<pre><code class="language-shell"># iptablesæ¸…ç†
iptables -F &amp;&amp; iptables -t nat -F &amp;&amp; iptables -t mangle -F &amp;&amp; iptables -X
</code></pre>
<pre><code class="language-shell"># IPVS æ¸…ç†
ipvsadm -C
</code></pre>
<p>ç½‘å¡æ¸…ç†</p>
<pre><code class="language-shell"># flannelï¼Œæ¸…ç†å®Œéœ€é‡å¯ kubelet
kubectl delete -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
ifconfig cni0 down
ip link delete cni0
ifconfig flannel.1 down
ip link delete flannel.1
rm -rf /var/lib/cni/
rm -f /etc/cni/net.d/*
systemctl restart kubelet
</code></pre>
<h3 id="æœ€ä½³å®è·µ"><a class="header" href="#æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</a></h3>
<h4 id="tls-è¯ä¹¦å’Œç§˜é’¥"><a class="header" href="#tls-è¯ä¹¦å’Œç§˜é’¥">TLS è¯ä¹¦å’Œç§˜é’¥</a></h4>
<p>å®‰è£… CFSSL</p>
<pre><code class="language-shell">$ go get -u github.com/cloudflare/cfssl/cmd/...
$ ls $GOPATH/bin/cfssl*
/root/go/path/bin/cfssl         /root/go/path/bin/cfssl-certinfo  /root/go/path/bin/cfssl-newkey
/root/go/path/bin/cfssl-bundle  /root/go/path/bin/cfssljson       /root/go/path/bin/cfssl-scan
</code></pre>
<h5 id="ca-è¯ä¹¦"><a class="header" href="#ca-è¯ä¹¦">CA è¯ä¹¦</a></h5>
<p>åˆ›å»º CA é…ç½®æ–‡ä»¶ã€‚</p>
<pre><code class="language-shell">$ cfssl print-defaults config &gt; config.json
$ cfssl print-defaults csr &gt; csr.json

# æ ¹æ® config.json æ–‡ä»¶çš„æ ¼å¼åˆ›å»ºå¦‚ä¸‹çš„ ca-config.json æ–‡ä»¶ï¼Œè¿‡æœŸæ—¶é—´è®¾ç½®æˆäº† 87600h
$ cat &gt; ca-config.json &lt;&lt;EOF
{
  &quot;signing&quot;: {
    &quot;default&quot;: {
      &quot;expiry&quot;: &quot;87600h&quot;
    },
    &quot;profiles&quot;: {
      &quot;kubernetes&quot;: {
        &quot;usages&quot;: [
            &quot;signing&quot;,
            &quot;key encipherment&quot;,
            &quot;server auth&quot;,
            &quot;client auth&quot;
        ],
        &quot;expiry&quot;: &quot;87600h&quot;
      }
    }
  }
}
EOF
</code></pre>
<p>å­—æ®µè¯´æ˜ï¼š</p>
<ul>
<li><code>ca-config.json</code>ï¼šå¯ä»¥å®šä¹‰å¤šä¸ª profilesï¼Œåˆ†åˆ«æŒ‡å®šä¸åŒçš„è¿‡æœŸæ—¶é—´ã€ä½¿ç”¨åœºæ™¯ç­‰å‚æ•°ï¼›åç»­åœ¨ç­¾åè¯ä¹¦æ—¶ä½¿ç”¨æŸä¸ª profileï¼›</li>
<li><code>signing</code>ï¼šè¡¨ç¤ºè¯¥è¯ä¹¦å¯ç”¨äºç­¾åå…¶å®ƒè¯ä¹¦ï¼›ç”Ÿæˆçš„ ca.pem è¯ä¹¦ä¸­ <code>CA=TRUE</code>ï¼›</li>
<li><code>server auth</code>ï¼šè¡¨ç¤ºclientå¯ä»¥ç”¨è¯¥ CA å¯¹serveræä¾›çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼›</li>
<li><code>client auth</code>ï¼šè¡¨ç¤ºserverå¯ä»¥ç”¨è¯¥CAå¯¹clientæä¾›çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼›</li>
</ul>
<p>åˆ›å»º CA è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶</p>
<pre><code class="language-shell">cat &gt; ca-csr.json &lt;&lt; EOF
&gt; {
&gt;   &quot;CN&quot;: &quot;kubernetes&quot;,
&gt;   &quot;key&quot;: {
&gt;     &quot;algo&quot;: &quot;rsa&quot;,
&gt;     &quot;size&quot;: 2048
&gt;   },
&gt;   &quot;names&quot;: [
&gt;     {
&gt;       &quot;C&quot;: &quot;CN&quot;,
&gt;       &quot;ST&quot;: &quot;BeiJing&quot;,
&gt;       &quot;L&quot;: &quot;BeiJing&quot;,
&gt;       &quot;O&quot;: &quot;k8s&quot;,
&gt;       &quot;OU&quot;: &quot;System&quot;
&gt;     }
&gt;   ],
&gt;     &quot;ca&quot;: {
&gt;        &quot;expiry&quot;: &quot;87600h&quot;
&gt;     }
&gt; }
&gt; EOF
</code></pre>
<p>å­—æ®µè¯´æ˜ï¼š</p>
<ul>
<li>&quot;CN&quot;ï¼š<code>Common Name</code>ï¼Œkube-apiserver ä»è¯ä¹¦ä¸­æå–è¯¥å­—æ®µä½œä¸ºè¯·æ±‚çš„ç”¨æˆ·å (User Name)ï¼›æµè§ˆå™¨ä½¿ç”¨è¯¥å­—æ®µéªŒè¯ç½‘ç«™æ˜¯å¦åˆæ³•ï¼›</li>
<li>&quot;O&quot;ï¼š<code>Organization</code>ï¼Œkube-apiserver ä»è¯ä¹¦ä¸­æå–è¯¥å­—æ®µä½œä¸ºè¯·æ±‚ç”¨æˆ·æ‰€å±çš„ç»„ (Group)ï¼›</li>
</ul>
<p><strong>ç”Ÿæˆ CA è¯ä¹¦å’Œç§é’¥</strong>ã€‚</p>
<pre><code class="language-shell">$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca
$ ls ca*
ca-config.json  ca.csr  ca-csr.json  ca-key.pem  ca.pem
</code></pre>
<h5 id="kubernetes-è¯ä¹¦"><a class="header" href="#kubernetes-è¯ä¹¦">kubernetes è¯ä¹¦</a></h5>
<p>åˆ›å»º kubernetes è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶</p>
<pre><code class="language-shell">$ cat &gt; kubernetes-csr.json &lt;&lt; EOF
&gt; {
&gt;     &quot;CN&quot;: &quot;kubernetes&quot;,
&gt;     &quot;hosts&quot;: [
&gt;       &quot;127.0.0.1&quot;,
&gt;       &quot;172.20.0.112&quot;,
&gt;       &quot;172.20.0.113&quot;,
&gt;       &quot;172.20.0.114&quot;,
&gt;       &quot;172.20.0.115&quot;,
&gt;       &quot;10.254.0.1&quot;,
&gt;       &quot;kubernetes&quot;,
&gt;       &quot;kubernetes.default&quot;,
&gt;       &quot;kubernetes.default.svc&quot;,
&gt;       &quot;kubernetes.default.svc.cluster&quot;,
        &quot;algo&quot;: &quot;rsa&quot;,
&gt;       &quot;kubernetes.default.svc.cluster.local&quot;
&gt;     ],
&gt;     &quot;key&quot;: {
&gt;         &quot;algo&quot;: &quot;rsa&quot;,
&gt;         &quot;size&quot;: 2048
&gt;     },
&gt;     &quot;names&quot;: [
&gt;         {
&gt;             &quot;C&quot;: &quot;CN&quot;,
&gt;             &quot;ST&quot;: &quot;BeiJing&quot;,
&gt;             &quot;L&quot;: &quot;BeiJing&quot;,
&gt;             &quot;O&quot;: &quot;k8s&quot;,
&gt;             &quot;OU&quot;: &quot;System&quot;
&gt;         }
&gt;     ]
&gt; }
&gt; EOF
</code></pre>
<ul>
<li>å¦‚æœ hosts å­—æ®µä¸ä¸ºç©ºåˆ™éœ€è¦æŒ‡å®šæˆæƒä½¿ç”¨è¯¥è¯ä¹¦çš„ <strong>IP æˆ–åŸŸååˆ—è¡¨</strong>ï¼Œç”±äºè¯¥è¯ä¹¦åç»­è¢« <code>etcd</code> é›†ç¾¤å’Œ <code>kubernetes master</code> é›†ç¾¤ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸Šé¢åˆ†åˆ«æŒ‡å®šäº† <code>etcd</code> é›†ç¾¤ã€<code>kubernetes master</code> é›†ç¾¤çš„ä¸»æœº IP å’Œ <strong><code>kubernetes</code> æœåŠ¡çš„æœåŠ¡ IP</strong>ï¼ˆä¸€èˆ¬æ˜¯ <code>kube-apiserver</code> æŒ‡å®šçš„ <code>service-cluster-ip-range</code> ç½‘æ®µçš„ç¬¬ä¸€ä¸ªIPï¼Œå¦‚ 10.254.0.1ï¼‰ã€‚</li>
<li>è¿™æ˜¯æœ€å°åŒ–å®‰è£…çš„kubernetesé›†ç¾¤ï¼ŒåŒ…æ‹¬ä¸€ä¸ªç§æœ‰é•œåƒä»“åº“ï¼Œä¸‰ä¸ªèŠ‚ç‚¹çš„kubernetesé›†ç¾¤ï¼Œä»¥ä¸Šç‰©ç†èŠ‚ç‚¹çš„IPä¹Ÿå¯ä»¥æ›´æ¢ä¸ºä¸»æœºåã€‚</li>
</ul>
<p><strong>ç”Ÿæˆ kubernetes è¯ä¹¦å’Œç§é’¥</strong></p>
<pre><code class="language-shell">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kubernetes-csr.json | cfssljson -bare kubernetes
$ ls kubernetes*
kubernetes.csr  kubernetes-csr.json  kubernetes-key.pem  kubernetes.pem
</code></pre>
<h5 id="admin-è¯ä¹¦"><a class="header" href="#admin-è¯ä¹¦">admin è¯ä¹¦</a></h5>
<p>åˆ›å»º admin è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶</p>
<pre><code class="language-shell">$ cat &gt; admin-csr.json &lt;&lt; EOF
&gt; {
&gt;   &quot;CN&quot;: &quot;admin&quot;,
&gt;   &quot;hosts&quot;: [],
&gt;   &quot;key&quot;: {
&gt;     &quot;algo&quot;: &quot;rsa&quot;,
&gt;     &quot;size&quot;: 2048
&gt;   },
&gt;   &quot;names&quot;: [
&gt;     {
&gt;       &quot;C&quot;: &quot;CN&quot;,
&gt;       &quot;ST&quot;: &quot;BeiJing&quot;,
&gt;       &quot;L&quot;: &quot;BeiJing&quot;,
&gt;       &quot;O&quot;: &quot;system:masters&quot;,
&gt;       &quot;OU&quot;: &quot;System&quot;
&gt;     }
&gt;   ]
&gt; }
&gt; EOF
</code></pre>
<ul>
<li>åç»­ <code>kube-apiserver</code> ä½¿ç”¨ <code>RBAC</code> å¯¹å®¢æˆ·ç«¯(å¦‚ <code>kubelet</code>ã€<code>kube-proxy</code>ã€<code>Pod</code>)è¯·æ±‚è¿›è¡Œæˆæƒï¼›</li>
<li><code>kube-apiserver</code> é¢„å®šä¹‰äº†ä¸€äº› <code>RBAC</code> ä½¿ç”¨çš„ <code>RoleBindings</code>ï¼Œå¦‚ <code>cluster-admin</code> å°† Group <code>system:masters</code> ä¸ Role <code>cluster-admin</code> ç»‘å®šï¼Œè¯¥ Role æˆäºˆäº†è°ƒç”¨<code>kube-apiserver</code> çš„<strong>æ‰€æœ‰ API</strong>çš„æƒé™ï¼›</li>
<li>O æŒ‡å®šè¯¥è¯ä¹¦çš„ Group ä¸º <code>system:masters</code>ï¼Œ<code>kubelet</code> ä½¿ç”¨è¯¥è¯ä¹¦è®¿é—® <code>kube-apiserver</code> æ—¶ ï¼Œç”±äºè¯ä¹¦è¢« CA ç­¾åï¼Œæ‰€ä»¥è®¤è¯é€šè¿‡ï¼ŒåŒæ—¶ç”±äºè¯ä¹¦ç”¨æˆ·ç»„ä¸ºç»è¿‡é¢„æˆæƒçš„ <code>system:masters</code>ï¼Œæ‰€ä»¥è¢«æˆäºˆè®¿é—®æ‰€æœ‰ API çš„æƒé™ï¼›</li>
</ul>
<p><strong>ç”Ÿæˆ admin è¯ä¹¦å’Œç§é’¥</strong></p>
<pre><code class="language-shell">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes admin-csr.json | cfssljson -bare admin
$ ls admin*
admin.csr  admin-csr.json  admin-key.pem  admin.pem
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šè¿™ä¸ªadmin è¯ä¹¦ï¼Œæ˜¯å°†æ¥ç”Ÿæˆç®¡ç†å‘˜ç”¨çš„kube config é…ç½®æ–‡ä»¶ç”¨çš„ï¼Œç°åœ¨æˆ‘ä»¬ä¸€èˆ¬å»ºè®®ä½¿ç”¨RBAC æ¥å¯¹kubernetes è¿›è¡Œè§’è‰²æƒé™æ§åˆ¶ï¼Œ kubernetes å°†è¯ä¹¦ä¸­çš„CN å­—æ®µ ä½œä¸ºUserï¼Œ O å­—æ®µä½œä¸º Groupï¼ˆå…·ä½“å‚è€ƒ<a href="https://jimmysong.io/kubernetes-handbook/guide/authentication.html"> Kubernetesä¸­çš„ç”¨æˆ·ä¸èº«ä»½è®¤è¯æˆæƒ</a>ä¸­ X509 Client Certs ä¸€æ®µï¼‰ã€‚</p>
<p>åœ¨æ­å»ºå®Œ kubernetes é›†ç¾¤åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤: <code>kubectl get clusterrolebinding cluster-admin -o yaml</code> ,æŸ¥çœ‹åˆ° <code>clusterrolebinding cluster-admin</code> çš„ subjects çš„ kind æ˜¯ Groupï¼Œname æ˜¯ <code>system:masters</code>ã€‚ <code>roleRef</code> å¯¹è±¡æ˜¯ <code>ClusterRole cluster-admin</code>ã€‚ æ„æ€æ˜¯å‡¡æ˜¯ <code>system:masters Group</code> çš„ user æˆ–è€… <code>serviceAccount</code> éƒ½æ‹¥æœ‰ <code>cluster-admin</code> çš„è§’è‰²ã€‚ å› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨ kubectl å‘½ä»¤æ—¶å€™ï¼Œæ‰æ‹¥æœ‰æ•´ä¸ªé›†ç¾¤çš„ç®¡ç†æƒé™ã€‚</p>
<pre><code class="language-yaml">$ kubectl get clusterrolebinding cluster-admin -o yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  annotations:
    rbac.authorization.kubernetes.io/autoupdate: &quot;true&quot;
  creationTimestamp: 2017-04-11T11:20:42Z
  labels:
    kubernetes.io/bootstrapping: rbac-defaults
  name: cluster-admin
  resourceVersion: &quot;52&quot;
  selfLink: /apis/rbac.authorization.k8s.io/v1/clusterrolebindings/cluster-admin
  uid: e61b97b2-1ea8-11e7-8cd7-f4e9d49f8ed0
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: Group
  name: system:masters
</code></pre>
<h5 id="kube-proxy-è¯ä¹¦"><a class="header" href="#kube-proxy-è¯ä¹¦">kube-proxy è¯ä¹¦</a></h5>
<p>åˆ›å»º kube-proxy è¯ä¹¦ç­¾åè¯·æ±‚æ–‡ä»¶</p>
<pre><code class="language-shell">$ cat &gt; kube-proxy-csr.json &lt;&lt; EOF
&gt; {
&gt;   &quot;CN&quot;: &quot;system:kube-proxy&quot;,
&gt;   &quot;hosts&quot;: [],
&gt;   &quot;key&quot;: {
&gt;     &quot;algo&quot;: &quot;rsa&quot;,
&gt;     &quot;size&quot;: 2048
&gt;   },
&gt;   &quot;names&quot;: [
&gt;     {
&gt;       &quot;C&quot;: &quot;CN&quot;,
&gt;       &quot;ST&quot;: &quot;BeiJing&quot;,
&gt;       &quot;L&quot;: &quot;BeiJing&quot;,
&gt;       &quot;O&quot;: &quot;k8s&quot;,
&gt;       &quot;OU&quot;: &quot;System&quot;
&gt;     }
&gt;   ]
&gt; }
&gt; EOF
</code></pre>
<ul>
<li>CN æŒ‡å®šè¯¥è¯ä¹¦çš„ User ä¸º <code>system:kube-proxy</code>ï¼›</li>
<li><code>kube-apiserver</code> é¢„å®šä¹‰çš„ RoleBinding <code>system:node-proxier</code> å°†User <code>system:kube-proxy</code> ä¸ Role <code>system:node-proxier</code> ç»‘å®šï¼Œè¯¥ Role æˆäºˆäº†è°ƒç”¨ <code>kube-apiserver</code> Proxy ç›¸å…³ API çš„æƒé™ï¼›</li>
</ul>
<p>ç”Ÿæˆ kube-proxy å®¢æˆ·ç«¯è¯ä¹¦å’Œç§é’¥</p>
<pre><code class="language-shell">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes  kube-proxy-csr.json | cfssljson -bare kube-proxy
$ ls kube-proxy*
</code></pre>
<h5 id="æ ¡éªŒè¯ä¹¦"><a class="header" href="#æ ¡éªŒè¯ä¹¦">æ ¡éªŒè¯ä¹¦</a></h5>
<h6 id="ä½¿ç”¨-openssl"><a class="header" href="#ä½¿ç”¨-openssl">ä½¿ç”¨ openssl</a></h6>
<p>ä»¥ Kubernetes è¯ä¹¦ä¸ºä¾‹ï¼Œä½¿ç”¨ openssl å‘½ä»¤è¯»å–è¯ä¹¦ä¿¡æ¯</p>
<ul>
<li>ç¡®è®¤ <code>Issuer</code> å­—æ®µçš„å†…å®¹å’Œ <code>ca-csr.json</code> ä¸€è‡´ï¼›</li>
<li>ç¡®è®¤ <code>Subject</code> å­—æ®µçš„å†…å®¹å’Œ <code>kubernetes-csr.json</code> ä¸€è‡´ï¼›</li>
<li>ç¡®è®¤ <code>X509v3 Subject Alternative Name</code> å­—æ®µçš„å†…å®¹å’Œ <code>kubernetes-csr.json</code> ä¸€è‡´ï¼›</li>
<li>ç¡®è®¤ <code>X509v3 Key Usageã€Extended Key Usage</code> å­—æ®µçš„å†…å®¹å’Œ <code>ca-config.json</code> ä¸­ <code>kubernetes</code> profile ä¸€è‡´ï¼›</li>
</ul>
<pre><code class="language-shell">$ openssl x509  -noout -text -in  kubernetes.pem
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            03:0e:b4:83:5e:6d:02:fa:bf:62:21:aa:37:47:f1:c4:88:f4:8a:0c
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C = CN, ST = BeiJing, L = BeiJing, O = k8s, OU = System, CN = kubernetes
        Validity
            Not Before: Mar 12 12:04:00 2022 GMT
            Not After : Mar  9 12:04:00 2032 GMT
        Subject: C = CN, ST = BeiJing, L = BeiJing, O = k8s, OU = System, CN = kubernetes
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    ......
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage:
                TLS Web Server Authentication, TLS Web Client Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Subject Key Identifier:
                B7:15:10:43:1B:E1:53:B0:6A:12:56:5B:A5:CD:EF:77:E4:A0:79:F4
            X509v3 Subject Alternative Name:
                DNS:kubernetes, DNS:kubernetes.default, DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster, DNS:kubernetes.default.svc.cluster.local, IP Address:127.0.0.1, IP Address:172.20.0.112, IP Address:172.20.0.113, IP Address:172.20.0.114, IP Address:172.20.0.115, IP Address:10.254.0.1
    Signature Algorithm: sha256WithRSAEncryption
         ......
</code></pre>
<h6 id="ä½¿ç”¨cfssl-certinfo"><a class="header" href="#ä½¿ç”¨cfssl-certinfo">ä½¿ç”¨cfssl-certinfo</a></h6>
<pre><code class="language-shell">cfssl-certinfo -cert kubernetes.pem
{
  &quot;subject&quot;: {
    &quot;common_name&quot;: &quot;kubernetes&quot;,
    &quot;country&quot;: &quot;CN&quot;,
    &quot;organization&quot;: &quot;k8s&quot;,
    &quot;organizational_unit&quot;: &quot;System&quot;,
    &quot;locality&quot;: &quot;BeiJing&quot;,
    &quot;province&quot;: &quot;BeiJing&quot;,
    &quot;names&quot;: [
      &quot;CN&quot;,
      &quot;BeiJing&quot;,
      &quot;BeiJing&quot;,
      &quot;k8s&quot;,
      &quot;System&quot;,
      &quot;kubernetes&quot;
    ]
  },
  &quot;issuer&quot;: {
    &quot;common_name&quot;: &quot;kubernetes&quot;,
    &quot;country&quot;: &quot;CN&quot;,
    &quot;organization&quot;: &quot;k8s&quot;,
    &quot;organizational_unit&quot;: &quot;System&quot;,
    &quot;locality&quot;: &quot;BeiJing&quot;,
    &quot;province&quot;: &quot;BeiJing&quot;,
    &quot;names&quot;: [
      &quot;CN&quot;,
      &quot;BeiJing&quot;,
      &quot;BeiJing&quot;,
      &quot;k8s&quot;,
      &quot;System&quot;,
      &quot;kubernetes&quot;
    ]
  },
  &quot;serial_number&quot;: &quot;17454907659222183176468532411310969421540133388&quot;,
  &quot;sans&quot;: [
    &quot;kubernetes&quot;,
    &quot;kubernetes.default&quot;,
    &quot;kubernetes.default.svc&quot;,
    &quot;kubernetes.default.svc.cluster&quot;,
    &quot;kubernetes.default.svc.cluster.local&quot;,
    &quot;127.0.0.1&quot;,
    &quot;172.20.0.112&quot;,
    &quot;172.20.0.113&quot;,
    &quot;172.20.0.114&quot;,
    &quot;172.20.0.115&quot;,
    &quot;10.254.0.1&quot;
  ],
  &quot;not_before&quot;: &quot;2022-03-12T12:04:00Z&quot;,
  &quot;not_after&quot;: &quot;2032-03-09T12:04:00Z&quot;,
  &quot;sigalg&quot;: &quot;SHA256WithRSA&quot;,
  &quot;authority_key_id&quot;: &quot;&quot;,
  &quot;subject_key_id&quot;: &quot;B7:15:10:43:1B:E1:53:B0:6A:12:56:5B:A5:CD:EF:77:E4:A0:79:F4&quot;,
  &quot;pem&quot;: &quot;-----BEGIN CERTIFICATE-----\nMIIEajCCA1KgAwIBAgIUAw60g15tAvq/YiGqN0fxxIj0igwwDQYJKoZIhvcNAQEL\nBQAwZTELMAkGA1UEBhMCQ04xEDAOBgNVBAgTB0JlaUppbmcxEDAOBgNVBAcTB0Jl\naUppbmcxDDAKBgNVBAoTA2s4czEPMA0GA1UECxMGU3lzdGVtMRMwEQYDVQQDEwpr\ndWJlcm5ldGVzMB4XDTIyMDMxMjEyMDQwMFoXDTMyMDMwOTEyMDQwMFowZTELMAkG\nA1UEBhMCQ04xEDAOBgNVBAgTB0JlaUppbmcxEDAOBgNVBAcTB0JlaUppbmcxDDAK\nBgNVBAoTA2s4czEPMA0GA1UECxMGU3lzdGVtMRMwEQYDVQQDEwprdWJlcm5ldGVz\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3QrEXpJnjVNsYnFGnu4f\nJG99y/P49uL0VTEZP4+6X/NRN1Fq9clX8acDHQcYBPud6OSI2Lvah9hxKQTpmIIQ\nky2lEnA64c9BDU5x0CUP5UOzwryjddFshHfvNOg7dySR3hzOKiKac31RKCtOo3OB\nlVctX+ksm1dAsTuGoAvYXKTl2fbR6p+Ew7tkMjbtaghXS9MXVy3RN1t7G3X9Xj9U\ndHnfdTCtTVxJF6kRrOBuP3ad+YDj6QAk8jXKefkFzfezj+w1g1zPJXcTtSko/YiH\n9A0lfiKxiv+6RGoXWQRnMT1J2Or8sKP0yWb0qLkk/+jINCiNulLL+mDQrEVlSSn3\ncwIDAQABo4IBEDCCAQwwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF\nBwMBBggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMB0GA1UdDgQWBBS3FRBDG+FTsGoS\nVlulze935KB59DCBrQYDVR0RBIGlMIGiggprdWJlcm5ldGVzghJrdWJlcm5ldGVz\nLmRlZmF1bHSCFmt1YmVybmV0ZXMuZGVmYXVsdC5zdmOCHmt1YmVybmV0ZXMuZGVm\nYXVsdC5zdmMuY2x1c3RlcoIka3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVy\nLmxvY2FshwR/AAABhwSsFABwhwSsFABxhwSsFAByhwSsFABzhwQK/gABMA0GCSqG\nSIb3DQEBCwUAA4IBAQAJTaKt98jCvsRo2vq9RvK732UO4tgYdhyAcQTREvsEyjdT\nYlA85xix0I9j5MlBgyfplQLCIobGjjdmkIdVcJsciPaqRdCjurHkDF5pBs4m/qlr\nfhxjEjZr36aT3/taq5xUA//TkCTb9p8Ijm+3AMdPGxovXE/TokEYcXDNasaVYsLY\naBxKDv3Bymwv9RIzPDrcNnn7llsCba6IX+L8u3TB4GIOxv7yH6XwVhqAFKh1yXUZ\n6H8Wky5z8l91virnRBfi3y4jJsl/odIznp16We8VnWCA36eTzBwOOEZiU3MvlPYc\nei7FKCGN5U3ZwwLsTMH2WzWX+Zw+dZGA97FmDYnX\n-----END CERTIFICATE-----\n&quot;
}
</code></pre>
<h5 id="é¢å‘è¯ä¹¦"><a class="header" href="#é¢å‘è¯ä¹¦">é¢å‘è¯ä¹¦</a></h5>
<p>å°†ç”Ÿæˆçš„è¯ä¹¦å’Œç§˜é’¥æ–‡ä»¶ï¼ˆåç¼€åä¸º<code>.pem</code>ï¼‰æ‹·è´åˆ°æ‰€æœ‰ï¼ˆéœ€è¦çš„ï¼‰æœºå™¨ï¼ˆåŒ…æ‹¬å½“å‰ï¼‰çš„ <code>/etc/kubernetes/ssl</code> ç›®å½•ä¸‹å¤‡ç”¨</p>
<pre><code class="language-shell">mkdir -p /etc/kubernetes/ssl &amp;&amp; cp *.pem /etc/kubernetes/ssl
</code></pre>
<h4 id="kubelet"><a class="header" href="#kubelet">kubelet</a></h4>
<pre><code class="language-shell">export KUBE_APISERVER=&quot;https://kubecpe:6443&quot;

# è®¾ç½®é›†ç¾¤å‚æ•°
kubectl config set-cluster kubernetes \
  --certificate-authority=/etc/kubernetes/ssl/ca.pem \
  --embed-certs=true \
  --server=${KUBE_APISERVER}
# è®¾ç½®å®¢æˆ·ç«¯è®¤è¯å‚æ•°
kubectl config set-credentials admin \
  --client-certificate=/etc/kubernetes/ssl/admin.pem \
  --embed-certs=true \
  --client-key=/etc/kubernetes/ssl/admin-key.pem
# è®¾ç½®ä¸Šä¸‹æ–‡å‚æ•°
kubectl config set-context kubernetes \
  --cluster=kubernetes \
  --user=admin
# è®¾ç½®é»˜è®¤ä¸Šä¸‹æ–‡
kubectl config use-context kubernetes
</code></pre>
<ul>
<li><code>admin.pem</code> è¯ä¹¦ OU å­—æ®µå€¼ä¸º <code>system:masters</code>ï¼Œ<code>kube-apiserver</code> é¢„å®šä¹‰çš„ RoleBinding <code>cluster-admin</code> å°† Group <code>system:masters</code> ä¸ Role <code>cluster-admin</code> ç»‘å®šï¼Œè¯¥ Role æˆäºˆäº†è°ƒç”¨<code>kube-apiserver</code> ç›¸å…³ API çš„æƒé™ï¼›</li>
<li>ç”Ÿæˆçš„ kubeconfig è¢«ä¿å­˜åˆ° <code>~/.kube/config</code> æ–‡ä»¶ï¼›</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong><code>~/.kube/config</code>æ–‡ä»¶æ‹¥æœ‰å¯¹è¯¥é›†ç¾¤çš„æœ€é«˜æƒé™ï¼Œè¯·å¦¥å–„ä¿ç®¡ã€‚</p>
<h4 id="kubeconfig"><a class="header" href="#kubeconfig">kubeconfig</a></h4>
<h5 id="tls-bootstrapping-token"><a class="header" href="#tls-bootstrapping-token">TLS Bootstrapping Token</a></h5>
<p>Tokenå¯ä»¥æ˜¯ä»»æ„çš„åŒ…å«128 bitçš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨å®‰å…¨çš„éšæœºæ•°å‘ç”Ÿå™¨ç”Ÿæˆã€‚</p>
<pre><code class="language-shell">export BOOTSTRAP_TOKEN=$(head -c 16 /dev/urandom | od -An -t x | tr -d ' ')

cat &gt; token.csv &lt;&lt;EOF
${BOOTSTRAP_TOKEN},kubelet-bootstrap,10001,&quot;system:kubelet-bootstrap&quot;
EOF

# æ£€æŸ¥ token.csv æ–‡ä»¶ï¼Œç¡®è®¤å…¶ä¸­çš„ ${BOOTSTRAP_TOKEN} ç¯å¢ƒå˜é‡å·²ç»è¢«çœŸå®çš„å€¼æ›¿æ¢
cat token.csv
c16e2aa67b2d10569d68ee176af17017,kubelet-bootstrap,10001,&quot;system:kubelet-bootstrap&quot;
</code></pre>
<p><strong>BOOTSTRAP_TOKEN</strong> å°†è¢«å†™å…¥åˆ° kube-apiserver ä½¿ç”¨çš„ token.csv æ–‡ä»¶å’Œ kubelet ä½¿ç”¨çš„ <code>bootstrap.kubeconfig</code> æ–‡ä»¶ï¼Œå¦‚æœåç»­é‡æ–°ç”Ÿæˆäº† BOOTSTRAP_TOKENï¼Œåˆ™éœ€è¦ï¼š</p>
<ol>
<li>æ›´æ–° token.csv æ–‡ä»¶ï¼Œåˆ†å‘åˆ°æ‰€æœ‰æœºå™¨ (master å’Œ nodeï¼‰çš„ /etc/kubernetes/ ç›®å½•ä¸‹ï¼Œåˆ†å‘åˆ°nodeèŠ‚ç‚¹ä¸Šéå¿…éœ€ï¼›</li>
<li>é‡æ–°ç”Ÿæˆ bootstrap.kubeconfig æ–‡ä»¶ï¼Œåˆ†å‘åˆ°æ‰€æœ‰ node æœºå™¨çš„ /etc/kubernetes/ ç›®å½•ä¸‹ï¼›</li>
<li>é‡å¯ kube-apiserver å’Œ kubelet è¿›ç¨‹ï¼›</li>
<li>é‡æ–° approve kubelet çš„ csr è¯·æ±‚ï¼›</li>
</ol>
<pre><code class="language-shell">cp token.csv /etc/kubernetes/
</code></pre>
<h5 id="kubelet-bootstrapping-kubeconfig"><a class="header" href="#kubelet-bootstrapping-kubeconfig">kubelet bootstrapping kubeconfig</a></h5>
<pre><code class="language-shell">cd /etc/kubernetes
export KUBE_APISERVER=&quot;https://kubecpe:6443&quot;

# è®¾ç½®é›†ç¾¤å‚æ•°
kubectl config set-cluster kubernetes \
  --certificate-authority=/etc/kubernetes/ssl/ca.pem \
  --embed-certs=true \
  --server=${KUBE_APISERVER} \
  --kubeconfig=bootstrap.kubeconfig

# è®¾ç½®å®¢æˆ·ç«¯è®¤è¯å‚æ•°
kubectl config set-credentials kubelet-bootstrap \
  --token=${BOOTSTRAP_TOKEN} \
  --kubeconfig=bootstrap.kubeconfig

# è®¾ç½®ä¸Šä¸‹æ–‡å‚æ•°
kubectl config set-context default \
  --cluster=kubernetes \
  --user=kubelet-bootstrap \
  --kubeconfig=bootstrap.kubeconfig

# è®¾ç½®é»˜è®¤ä¸Šä¸‹æ–‡
kubectl config use-context default --kubeconfig=bootstrap.kubeconfig
</code></pre>
<ul>
<li><code>--embed-certs</code> ä¸º <code>true</code> æ—¶è¡¨ç¤ºå°† <code>certificate-authority</code> è¯ä¹¦å†™å…¥åˆ°ç”Ÿæˆçš„ <code>bootstrap.kubeconfig</code> æ–‡ä»¶ä¸­ï¼›</li>
<li>è®¾ç½®å®¢æˆ·ç«¯è®¤è¯å‚æ•°æ—¶<strong>æ²¡æœ‰</strong>æŒ‡å®šç§˜é’¥å’Œè¯ä¹¦ï¼Œåç»­ç”± <code>kube-apiserver</code> è‡ªåŠ¨ç”Ÿæˆï¼›</li>
</ul>
<h5 id="kube-proxy-kubeconfig"><a class="header" href="#kube-proxy-kubeconfig">kube-proxy kubeconfig</a></h5>
<pre><code class="language-shell">export KUBE_APISERVER=&quot;https://172.20.0.113:6443&quot;
# è®¾ç½®é›†ç¾¤å‚æ•°
kubectl config set-cluster kubernetes \
  --certificate-authority=/etc/kubernetes/ssl/ca.pem \
  --embed-certs=true \
  --server=${KUBE_APISERVER} \
  --kubeconfig=kube-proxy.kubeconfig
# è®¾ç½®å®¢æˆ·ç«¯è®¤è¯å‚æ•°
kubectl config set-credentials kube-proxy \
  --client-certificate=/etc/kubernetes/ssl/kube-proxy.pem \
  --client-key=/etc/kubernetes/ssl/kube-proxy-key.pem \
  --embed-certs=true \
  --kubeconfig=kube-proxy.kubeconfig
# è®¾ç½®ä¸Šä¸‹æ–‡å‚æ•°
kubectl config set-context default \
  --cluster=kubernetes \
  --user=kube-proxy \
  --kubeconfig=kube-proxy.kubeconfig
# è®¾ç½®é»˜è®¤ä¸Šä¸‹æ–‡
kubectl config use-context default --kubeconfig=kube-proxy.kubeconfig
</code></pre>
<h5 id="åˆ†å‘-kubeconfig"><a class="header" href="#åˆ†å‘-kubeconfig">åˆ†å‘ kubeconfig</a></h5>
<p>å°†ä¸¤ä¸ª kubeconfig æ–‡ä»¶åˆ†å‘åˆ°æ‰€æœ‰ Node æœºå™¨çš„ <code>/etc/kubernetes/</code> ç›®å½•</p>
<pre><code class="language-shell">cp bootstrap.kubeconfig kube-proxy.kubeconfig /etc/kubernetes/
</code></pre>
<h4 id="etcd"><a class="header" href="#etcd">etcd</a></h4>
<h5 id="å‡†å¤‡-1"><a class="header" href="#å‡†å¤‡-1">å‡†å¤‡</a></h5>
<p>æ·»åŠ  hosts</p>
<pre><code class="language-shell">sed -i '$a192.168.43.201 kubecpe' /etc/hosts
</code></pre>
<h5 id="å®‰è£…-2"><a class="header" href="#å®‰è£…-2">å®‰è£…</a></h5>
<pre><code class="language-shell">wget https://github.com/etcd-io/etcd/releases/download/v3.4.18/etcd-v3.4.18-linux-amd64.tar.gz
tar -xvf etcd-v3.4.18-linux-amd64.tar.gz
mv etcd-v3.1.5-linux-amd64/etcd* /usr/local/bin
</code></pre>
<h5 id="åˆ›å»º-etcd-çš„-systemd-unit-æ–‡ä»¶"><a class="header" href="#åˆ›å»º-etcd-çš„-systemd-unit-æ–‡ä»¶">åˆ›å»º etcd çš„ systemd unit æ–‡ä»¶</a></h5>
<p>åœ¨/usr/lib/systemd/system/ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶etcd.serviceï¼Œå†…å®¹å¦‚ä¸‹ã€‚æ³¨æ„æ›¿æ¢IPåœ°å€ä¸ºä½ è‡ªå·±çš„etcdé›†ç¾¤çš„ä¸»æœºIPã€‚</p>
<pre><code class="language-toml">[Unit]
Description=Etcd Server
After=network.target
After=network-online.target
Wants=network-online.target
Documentation=https://github.com/coreos

[Service]
Type=notify
WorkingDirectory=/var/lib/etcd/
EnvironmentFile=-/etc/etcd/etcd.conf
ExecStart=/usr/local/bin/etcd \
  --name ${ETCD_NAME} \
  --cert-file=/etc/kubernetes/ssl/kubernetes.pem \
  --key-file=/etc/kubernetes/ssl/kubernetes-key.pem \
  --peer-cert-file=/etc/kubernetes/ssl/kubernetes.pem \
  --peer-key-file=/etc/kubernetes/ssl/kubernetes-key.pem \
  --trusted-ca-file=/etc/kubernetes/ssl/ca.pem \
  --peer-trusted-ca-file=/etc/kubernetes/ssl/ca.pem \
  --initial-advertise-peer-urls ${ETCD_INITIAL_ADVERTISE_PEER_URLS} \
  --listen-peer-urls ${ETCD_LISTEN_PEER_URLS} \
  --listen-client-urls ${ETCD_LISTEN_CLIENT_URLS},http://127.0.0.1:2379 \
  --advertise-client-urls ${ETCD_ADVERTISE_CLIENT_URLS} \
  --initial-cluster-token ${ETCD_INITIAL_CLUSTER_TOKEN} \
  --initial-cluster infra1=https://etce01:2380,infra2=https://etce02:2380,infra3=https://etce03:2380 \
  --initial-cluster-state new \
  --data-dir=${ETCD_DATA_DIR}
Restart=on-failure
RestartSec=5
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
</code></pre>
<ul>
<li>æŒ‡å®š <code>etcd</code> çš„å·¥ä½œç›®å½•ä¸º <code>/var/lib/etcd</code>ï¼Œæ•°æ®ç›®å½•ä¸º <code>/var/lib/etcd</code>ï¼Œéœ€åœ¨å¯åŠ¨æœåŠ¡å‰åˆ›å»ºè¿™ä¸ªç›®å½•ï¼Œå¦åˆ™å¯åŠ¨æœåŠ¡çš„æ—¶å€™ä¼šæŠ¥é”™â€œFailed at step CHDIR spawning /usr/bin/etcd: No such file or directoryâ€ï¼›</li>
<li>ä¸ºäº†ä¿è¯é€šä¿¡å®‰å…¨ï¼Œéœ€è¦æŒ‡å®š etcd çš„å…¬ç§é’¥(cert-fileå’Œkey-file)ã€Peers é€šä¿¡çš„å…¬ç§é’¥å’Œ CA è¯ä¹¦(peer-cert-fileã€peer-key-fileã€peer-trusted-ca-file)ã€å®¢æˆ·ç«¯çš„CAè¯ä¹¦ï¼ˆtrusted-ca-fileï¼‰ï¼›</li>
<li>åˆ›å»º <code>kubernetes.pem</code> è¯ä¹¦æ—¶ä½¿ç”¨çš„ <code>kubernetes-csr.json</code> æ–‡ä»¶çš„ <code>hosts</code> å­—æ®µ<strong>åŒ…å«æ‰€æœ‰ etcd èŠ‚ç‚¹çš„IP</strong>ï¼Œå¦åˆ™è¯ä¹¦æ ¡éªŒä¼šå‡ºé”™ï¼›</li>
<li><code>--initial-cluster-state</code> å€¼ä¸º <code>new</code> æ—¶ï¼Œ<code>--name</code> çš„å‚æ•°å€¼å¿…é¡»ä½äº <code>--initial-cluster</code> åˆ—è¡¨ä¸­ï¼›</li>
</ul>
<p>å®Œæ•´ unit æ–‡ä»¶è§ï¼š<a href="https://jimmysong.io/kubernetes-handbook/systemd/etcd.service">etcd.service</a></p>
<p>ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶<code>/etc/etcd/etcd.conf</code>ã€‚</p>
<pre><code class="language-ini"># [member]
ETCD_NAME=infra1
ETCD_DATA_DIR=&quot;/var/lib/etcd&quot;
ETCD_LISTEN_PEER_URLS=&quot;https://172.20.0.113:2380&quot;
ETCD_LISTEN_CLIENT_URLS=&quot;https://172.20.0.113:2379&quot;

#[cluster]
ETCD_INITIAL_ADVERTISE_PEER_URLS=&quot;https://172.20.0.113:2380&quot;
ETCD_INITIAL_CLUSTER_TOKEN=&quot;etcd-cluster&quot;
ETCD_ADVERTISE_CLIENT_URLS=&quot;https://172.20.0.113:2379&quot;
</code></pre>
<h2 id="æ—¶é—´åŒæ­¥"><a class="header" href="#æ—¶é—´åŒæ­¥">æ—¶é—´åŒæ­¥</a></h2>
<pre><code class="language-shell"># åœ¨å„èŠ‚ç‚¹ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤
yum install ntpdate -y
ntpdate time.windows.com
</code></pre>
<h2 id="å‘½ä»¤è¡¥å…¨--åˆ«å"><a class="header" href="#å‘½ä»¤è¡¥å…¨--åˆ«å">å‘½ä»¤è¡¥å…¨ &amp; åˆ«å</a></h2>
<blockquote>
<p>è¯¦è§ <a href="https://kubernetes.io/zh-cn/docs/tasks/tools/included/optional-kubectl-configs-bash-linux/">Linux ç³»ç»Ÿä¸­çš„ bash è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½</a>ã€‚</p>
</blockquote>
<p>å‘ <code>~/.bashrc</code> ä¸­æ·»åŠ å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰bash-completionéœ€è¦å…ˆ</p>
<pre><code class="language-shell"># å®‰è£…bash-completion
apt install -y bash-completion

# åŠ è½½
cat &gt;&gt; ~/.bashrc &lt;&lt; EOF


# bash-completion
source /usr/share/bash-completion/bash_completion
# kubectl
source &lt;(kubectl completion bash)
alias kc=kubectl
complete -o default -F __start_kubectl kc
EOF

# æ›´æ–°
source .bashrc
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;prometheus&quot;
description = &quot;prometheus&quot;
tags = [&quot;it&quot;, &quot;cloud&quot;, &quot;prometheus&quot;]</p>
<p>+++</p>
<h1 id="prometheus"><a class="header" href="#prometheus">prometheus</a></h1>
<h2 id="cadvisor"><a class="header" href="#cadvisor">cAdvisor</a></h2>
<p>Kubelet å†…ç½® cAdvisorï¼Œæ— éœ€å•ç‹¬å®‰è£…ï¼Œå¯é€šè¿‡ https://127.0.0.1:10250/metrics/cadvisor è®¿é—®</p>
<pre><code class="language-shell"># åˆ›å»º ServiceAccount
kubectl create serviceaccount cadvisor-sa -n monitoring
# åˆ›å»º ClusterRoleBinding å¹¶ç»‘å®š ClusterRole åˆ° ServiceAccountï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨ cluster-admin
kubectl create clusterrolebinding cadvisor-crb --clusterrole=cluster-admin --serviceaccount=monitoring:cadvisor-sa
# æŸ¥çœ‹ secret
kubectl get secret -n monitoring
kubectl describe secret cadvisor-sa-token-&lt;xxxxx&gt; -n monitoring
# é€šè¿‡ http è®¿é—®
curl https://127.0.0.1:10250/metrics/cadvisor -k -H &quot;Authorization: Bearer &lt;token&gt;&quot;
</code></pre>
<h2 id="grafana"><a class="header" href="#grafana">Grafana</a></h2>
<blockquote>
<p><a href="https://grafana.com/docs/grafana/latest/setup-grafana/installation/kubernetes/">åœ¨ Kubernetes ä¸Šéƒ¨ç½² Grafana</a>ã€‚</p>
<p><a href="http://www.mydlq.club/article/111/">Kubernetes éƒ¨ç½²å›¾è¡¨å·¥å…· Grafana</a>ã€‚</p>
</blockquote>
<pre><code class="language-yaml">apiVersion: v1
kind: PersistentVolume
metadata:
  name: grafana-pv
  labels:
    app: grafana
spec:
  storageClassName: grafana-storage
  capacity:
    storage: 5Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: &quot;/mnt/data/grafana&quot;
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: grafana-pvc
spec:
  selector:
    matchLabels:
      app: grafana
  storageClassName: grafana-storage
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
apiVersion: v1
kind: Service
metadata:
  name: grafana-svc
  labels:
    app: grafana
spec:
  type: NodePort
  ports:
  - name: http-grafana
    port: 3000
    nodePort: 30300
    targetPort: http-grafana
  selector:
    app: grafana
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: grafana
  labels:
    app: grafana
spec:
  selector:
    matchLabels:
      app: grafana
  template:
    metadata:
      labels:
        app: grafana
    spec:
      securityContext:
        fsGroup: 472
        supplementalGroups:
          - 0
      initContainers: # åˆå§‹åŒ–å®¹å™¨ï¼Œç”¨äºä¿®æ”¹æŒ‚è½½çš„å­˜å‚¨çš„æ–‡ä»¶å¤¹å½’å±ç»„ä¸å½’å±ç”¨æˆ·
        - name: init-file
          image: busybox:latest
          imagePullPolicy: IfNotPresent
          securityContext:
            runAsUser: 0
          command: ['chown', '-R', &quot;472:0&quot;, &quot;/var/lib/grafana&quot;]
          volumeMounts:
            - name: grafana-volume
              mountPath: &quot;/var/lib/grafana&quot;
              subPath: grafana-subpath
      containers:
        - name: grafana
          image: grafana/grafana:latest
          imagePullPolicy: IfNotPresent
          ports:
            - name: http-grafana
              containerPort: 3000
          readinessProbe: # å°±ç»ªæ¢é’ˆ
            failureThreshold: 3
            httpGet:
              path: /robots.txt
              port: 3000
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 30
            successThreshold: 1
            timeoutSeconds: 2
          livenessProbe: # å­˜æ´»æ¢é’ˆ
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 10
            successThreshold: 1
            tcpSocket:
              port: 3000
            timeoutSeconds: 1
          env: # é…ç½®ç¯å¢ƒå˜é‡ï¼Œè®¾ç½® Grafana çš„é»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·å/å¯†ç 
            - name: GF_SECURITY_ADMIN_USER
              value: &quot;admin&quot;
            - name: GF_SECURITY_ADMIN_PASSWORD
              value: &quot;admin&quot;
          resources:
            requests:
              cpu: 250m
              memory: 750Mi
          securityContext: # å®¹å™¨å®‰å…¨ç­–ç•¥ï¼Œè®¾ç½®è¿è¡Œå®¹å™¨ä½¿ç”¨çš„å½’å±ç»„ä¸ç”¨æˆ·
            runAsUser: 472
          volumeMounts:
            - name: grafana-volume
              mountPath: &quot;/var/lib/grafana&quot;
              subPath: grafana-subpath
      volumes:
        - name: grafana-volume
          persistentVolumeClaim:
            claimName: grafana-pvc
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;Title.sub_title&quot;
description = &quot;Title sub_title quick_start&quot;
tags = [&quot;techn&quot;, &quot;computer&quot;, &quot;tagx&quot;, &quot;Title&quot;, &quot;_sub_title&quot;, &quot;__quick_start(content)&quot;]</p>
<p>+++</p>
<h1 id="sealos"><a class="header" href="#sealos">Sealos</a></h1>
<blockquote>
<p><a href="https://docs.sealos.io/zh-Hans/">å®˜ç½‘</a>ï¼›</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;Go&quot;
description = &quot;Go quick start&quot;
tags = [&quot;techn&quot;, &quot;computer&quot;, &quot;lang&quot;, &quot;Go&quot;, &quot;__quick_start&quot;]</p>
<p>+++</p>
<h1 id="go"><a class="header" href="#go">Go</a></h1>
<blockquote>
<p><a href="https://go.dev/">å®˜ç½‘</a>ï¼›</p>
</blockquote>
<h2 id="go-1"><a class="header" href="#go-1">go</a></h2>
<blockquote>
<p><a href="https://go.dev/dl/">ä¸‹è½½</a>ï¼šé€‰æ‹© <code>.linux-amd64.tar.gz</code>ï¼ŒWin é€‰æ‹© .windows-amd64.zipï¼›</p>
</blockquote>
<p>å®‰è£…ï¼šè§£å‹å³å¯</p>
<pre><code class="language-shell">tar -zxf gox.x.x.linux-amd64.tar.gz
</code></pre>
<p>ç¯å¢ƒå˜é‡ï¼šå¯¼å…¥åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œæˆ–è€…é€šè¿‡å‘½ä»¤å¦‚ <code>go env -w GOROOT=</code> å†™å…¥</p>
<pre><code class="language-shell">export GOROOT=~/compute/lang/go/go
export GOPATH=~/compute/lang/go/path
# go install å®‰è£…çš„ç¨‹åºå°†ä¿å­˜åˆ° $GOPATH/bin ä¸‹
export PATH=$PATH:$GOROOT/bin:$GOPATH/bin
# ä»£ç†ï¼šä¸ƒç‰›äº‘ä»£ç† goproxy.cn,directï¼›é˜¿é‡Œä»£ç† mirrors.aliyun.com/goproxy/
export GOPROXY=https://goproxy.cn,direct

# gomodï¼šgo 1.14 åé»˜è®¤å¼€å¯
export GO111MODULE=on
# ç§æœ‰åº“ï¼šè®¾ç½®ç§æœ‰åº“ä»¥è·³è¿‡ä»£ç†ï¼Œæ¯”å¦‚å…¬å¸ä½¿ç”¨ Gitlabã€Gitee ç­‰ï¼Œå¤šç§æœ‰åº“é€—å·åˆ†éš”
export GOPRIVATE=*.gitlab.com,*.gitee.com
# ç”¨äºéªŒè¯åŒ…çš„æœ‰æ•ˆæ€§çš„æœåŠ¡åœ°å€ï¼Œé»˜è®¤ sum.golang.orgã€‚æœ‰æ—¶å€™å¦‚ go mod vendor ä¼šç”¨åˆ°ï¼Œæ— æ³•è¿æ¥åˆ™è®¾ç½®å¯è¿æ¥çš„åœ°å€å¦‚ sum.golang.google.cnï¼Œè¿™æ˜¯ä¸“ä¸ºå›½å†…æä¾›çš„ sum éªŒè¯æœåŠ¡åœ°å€ï¼Œæˆ–è€…ç›´æ¥å…³é—­å³å¯ã€‚ç§æœ‰ä»“åº“è‡ªåŠ¨å¿½ç•¥éªŒè¯
export GOSUMDB=off

# å¦‚å†™å…¥ ~/.bashrc åˆ™åˆ·æ–°
source ~/.bashrc
</code></pre>
<h2 id="vs-code"><a class="header" href="#vs-code">vs code</a></h2>
<blockquote>
<p><a href="https://learn.microsoft.com/zh-cn/azure/developer/go/configure-visual-studio-code">ä¸º Go å¼€å‘é…ç½® Visual Studio Code</a>ï¼›</p>
</blockquote>
<ol>
<li><code>Ctrl+Shift+X</code> æ‰“å¼€æ‰©å±•è§†å›¾ï¼Œæœç´¢ <code>Go</code> æ’ä»¶å¹¶å®‰è£…</li>
<li><code>Ctrl+Shift+P</code> æ‰“å¼€ vs code å‘½ä»¤æ¡†ï¼Œæœç´¢ <code>Go: Install/Update tools</code> å¹¶æ‰§è¡Œ</li>
</ol>
<h2 id="hello-world"><a class="header" href="#hello-world">hello world</a></h2>
<p>helloworld.go</p>
<pre><code class="language-go">package main

import &quot;fmt&quot;

func main() {
	fmt.Println(&quot;Hello world!&quot;)
}
</code></pre>
<pre><code class="language-shell">$ go build -o ./helloworld-exec ./helloworld.go
$ ./helloworld-exec
Hello world!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><p>+++</p>
<p>title = &quot;Git&quot;
description = &quot;Git&quot;
tags = [&quot;it&quot;, &quot;versioncontrol&quot;]</p>
<p>+++</p>
<h1 id="git"><a class="header" href="#git">Git</a></h1>
<blockquote>
<p><a href="https://git-scm.com/">å®˜ç½‘</a>ï¼›</p>
</blockquote>
<h2 id="å¿«å¼€-1"><a class="header" href="#å¿«å¼€-1">å¿«å¼€</a></h2>
<h3 id="å®‰è£…-3"><a class="header" href="#å®‰è£…-3">å®‰è£…</a></h3>
<blockquote>
<p><a href="https://git-scm.com/downloads">ä¸‹è½½</a>ï¼›</p>
</blockquote>
<pre><code class="language-shell">apt install -y git
</code></pre>
<h3 id="é…ç½®-1"><a class="header" href="#é…ç½®-1">é…ç½®</a></h3>
<ul>
<li>ä»“åº“é…ç½®ï¼š<code>&lt;git-repository&gt;/.git/config</code>ï¼›</li>
<li>å…¨å±€é…ç½®ï¼š<code>~/.gitconfig</code>ï¼›</li>
</ul>
<pre><code class="language-shell">cat &gt; ~/.gitconfig &lt;&lt;EOF
[core]
  # å…³é—­ quotepathï¼Œä½¿ä¸­æ–‡ä¸ä»¥å…«è¿›åˆ¶çš„å­—ç¬¦ç¼–ç æ˜¾ç¤ºï¼Œè€Œæ˜¯æ˜¾ç¤ºæ±‰å­—
  quotepath=false
[user]
  name = YuanyaTianchi
  email = yuanyatianchi@gmail.com
[alias]
  st = status
  co = commit
  ch = checkout
  br = branch
  lg = log --graph --abbrev-commit --pretty=oneline
  rebh = git rebase -i HEAD~

[http]
  # http ä»£ç†
  proxy = http://&lt;proxy_server_ip&gt;:&lt;port&gt;
[https]
  # https ä»£ç†
  proxy = https://&lt;proxy_server_ip&gt;:&lt;port&gt;
  # å…³é—­è¯ä¹¦æ ¡éªŒ
  sslVerify = false
EOF
# æŸ¥çœ‹
git config --list
</code></pre>
<h3 id="gitignore"><a class="header" href="#gitignore">.gitignore</a></h3>
<blockquote>
<p><a href="https://gist.github.com/octocat/9257657">.gitignoreå¸¸ç”¨é…ç½®</a></p>
</blockquote>
<pre><code class="language-shell">.idea
</code></pre>
<h2 id="åŸºæ“"><a class="header" href="#åŸºæ“">åŸºæ“</a></h2>
<h3 id="æœ¬åœ°ä»“"><a class="header" href="#æœ¬åœ°ä»“">æœ¬åœ°ä»“</a></h3>
<h3 id="è¿œç¨‹ä»“"><a class="header" href="#è¿œç¨‹ä»“">è¿œç¨‹ä»“</a></h3>
<pre><code class="language-shell"># æ·»åŠ 
git remote add &lt;origin_name&gt; &lt;git@x.x:x/x.git or https://x.x/x/x.git&gt;
# åˆ é™¤

# ä¿®æ”¹ url
git remote set-url &lt;origin_name&gt; &lt;git@x.x:x/x.git or https://x.x/x/x.git&gt;
# æŸ¥çœ‹
git remote
# æŸ¥çœ‹è¯¦ç»†åœ°å€
git remote -v
</code></pre>
<ul>
<li>git remote remove <repositoryName>ï¼šåˆ é™¤è¿œç¨‹çš„ä»“åº“çš„æ‰€æœ‰è·Ÿè¸ªåˆ†æ”¯å’Œé…ç½®è®¾ç½®</li>
<li>git remote rename <oldName> <newName>ï¼šé‡å‘½åè¿œç¨‹ä»“åº“åœ¨æœ¬åœ°çš„ç®€ç§°</li>
<li>git remote show <repositoryName>ï¼šæŸ¥çœ‹æŸä¸ªè¿œç¨‹ä»“åº“çš„è¯¦ç»†ä¿¡æ¯</li>
<li></li>
<li>git pull &lt;--rebase&gt; <repositoryName> <branchName> &lt;--allow-unrelated-histories&gt;ï¼šè·å–è¿œç¨‹ä»“åº“é¡¹ç›®æ–‡ä»¶
<ul>
<li>--allow-unrelated-historiesï¼šå¯é€‰å‚æ•°ï¼Œå¯ä»¥åˆå¹¶ä¸¤ä¸ªç‹¬ç«‹å¯åŠ¨ä»“åº“çš„å†å²</li>
</ul>
</li>
<li>æäº¤åˆ°æœ¬åœ°ä»“åº“åå†æ¨é€åˆ°è¿œç¨‹ä»“åº“</li>
<li>git push &lt;--set-upstream&gt; <repositoryName> <branchName>ï¼šæ¨é€åˆ°è¿œç¨‹ä»“åº“</li>
<li>git remote rmï¼šåˆ é™¤æº(origin)</li>
</ul>
<h2 id="æ¦‚å¿µ"><a class="header" href="#æ¦‚å¿µ">æ¦‚å¿µ</a></h2>
<ul>
<li>192.30.253.113 <a href="http://github.com">github.com</a>ï¼šä¿®æ”¹hostï¼Œæé«˜GitHubçš„pushå’Œpullé€Ÿåº¦</li>
<li>å‘½ä»¤è¡Œç¬¦å·
<ul>
<li>[ ]ï¼šå¯å†™å¯ä¸å†™</li>
<li>&lt;&gt;ï¼šå¿…é¡»å†™ä¸”éœ€è¦ç”¨ä½ è‡ªå·±çš„å†…å®¹æ›¿æ¢</li>
<li>{ }ï¼šå¿…é¡»åœ¨å…¶ä¸­åšå‡ºé€‰æ‹©(é€‰é¡¹ä¹‹é—´ä»¥ | éš”å¼€)</li>
</ul>
</li>
<li>ç»“æ„
<ul>
<li>å·¥ä½œåŒº</li>
<li>æš‚å­˜åŒº</li>
<li>æœ¬åœ°åº“</li>
</ul>
</li>
</ul>
<p>https://www.yiibai.com/git</p>
<h2 id="æ“ä½œ"><a class="header" href="#æ“ä½œ">æ“ä½œ</a></h2>
<h3 id="æ¨æ‹‰"><a class="header" href="#æ¨æ‹‰">æ¨æ‹‰</a></h3>
<h4 id="pull"><a class="header" href="#pull">pull</a></h4>
<ul>
<li><code>git pull [option]... &lt;è¿œç¨‹ä¸»æœºå&gt; [branch-name]:[local-branch-name]</code>
<ul>
<li>-qï¼š</li>
</ul>
</li>
</ul>
<pre><code class="language-shell">git pull origin remoteBranch:localBranch #è·å–è¿œç¨‹originä¸Šçš„åˆ†æ”¯branch1ï¼Œå¹¶åˆå¹¶åˆ°æœ¬åœ°çš„åˆ†æ”¯branch2
</code></pre>
<h4 id="push"><a class="header" href="#push">push</a></h4>
<h4 id="clone"><a class="header" href="#clone">clone</a></h4>
<p>cloneã€‚ä¸€èˆ¬å»ºè®®ä½¿ç”¨sshï¼Œhttpsæœ‰å¯èƒ½å‡ºä¸€äº›ä¸çŸ¥æ‰€ä»¥çš„é—®é¢˜</p>
<pre><code class="language-shell">#ssh
git clone git@github.com:YuanyaTianchi/yuanyatianchi.git
#https
git clone https://github.com/YuanyaTianchi/yuanyatianchi.git
</code></pre>
<h3 id="ç‰ˆæœ¬"><a class="header" href="#ç‰ˆæœ¬">ç‰ˆæœ¬</a></h3>
<h4 id="log"><a class="header" href="#log">log</a></h4>
<ul>
<li>git log</li>
</ul>
<pre><code class="language-shell">git log --graph --abbrev-commit --pretty=oneline #å›¾å½¢åŒ–ï¼Œhashå€¼ç®€åŒ–ï¼Œå•è¡Œ
</code></pre>
<h4 id="revert"><a class="header" href="#revert">revert</a></h4>
<p>https://juejin.im/post/6844903614767448072</p>
<p>é‡æå›é€€ç‰ˆæœ¬</p>
<pre><code class="language-shell">git revert -n xxxxxxx
git commit -m &quot;æ¢å¤åˆ°xxxxxxxç‰ˆæœ¬&quot;
</code></pre>
<p>é‡æå›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œå°†æ­¤æ¬¡å›é€€ä½œä¸ºæ–°çš„æäº¤é‡æï¼Œä¸åˆ é™¤è¯¥ç‰ˆæœ¬ä¹‹åçš„æäº¤ã€‚æ•ˆæœå¦‚ä¸‹</p>
<pre><code class="language-shell">$ git log
xxxxxx3 ç¬¬3æ¬¡æäº¤
xxxxxx2 ç¬¬2æ¬¡æäº¤
xxxxxx1 ç¬¬1æ¬¡æäº¤
$ git revert -n xxxxxx2
$ git commit -m &quot;æ¢å¤åˆ°ç¬¬2æ¬¡æäº¤&quot;
$ git log
xxxxxx4 æ¢å¤åˆ°ç¬¬2æ¬¡æäº¤
xxxxxx3 ç¬¬3æ¬¡æäº¤
xxxxxx2 ç¬¬2æ¬¡æäº¤
xxxxxx1 ç¬¬1æ¬¡æäº¤
</code></pre>
<p>æ¨èä½¿ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å°†å›é€€ç‰ˆæœ¬çš„åé¢çš„æäº¤å·²æ¨é€åˆ°è¿œç¨‹ä»“åº“æ—¶ï¼Œrevert åä¹Ÿèƒ½ç®€å•ç›´æ¥æäº¤</p>
<h4 id="reset"><a class="header" href="#reset">reset</a></h4>
<p>é‡è®¾å›é€€ç‰ˆæœ¬</p>
<pre><code class="language-shell"># HEAD ç›´æ¥æŒ‡å‘æŒ‡å®šç‰ˆæœ¬å·
git reset --hard xxxxxxx
# å‰ç§» HEADï¼Œå‡ ä¸ª^è¡¨ç¤ºå‰ç§»å‡ ä¸ªç‰ˆæœ¬
git reset --hard HEAD^
</code></pre>
<p>é‡è®¾å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ä¹‹åçš„æäº¤éƒ½å°†è¢«åˆ é™¤ã€‚æ•ˆæœå¦‚ä¸‹</p>
<pre><code class="language-shell">$ git log
xxxxxx3 ç¬¬3æ¬¡æäº¤
xxxxxx2 ç¬¬2æ¬¡æäº¤
xxxxxx1 ç¬¬1æ¬¡æäº¤
$ git reset --hard HEAD^
$ git log
xxxxxx2 ç¬¬2æ¬¡æäº¤
xxxxxx1 ç¬¬1æ¬¡æäº¤
</code></pre>
<p>å‚æ•°</p>
<ul>
<li>--softï¼š å›é€€åaåˆ†æ”¯ä¿®æ”¹çš„ä»£ç è¢«ä¿ç•™å¹¶æ ‡è®°ä¸ºaddçš„çŠ¶æ€ï¼ˆgit status æ˜¯ç»¿è‰²çš„çŠ¶æ€ï¼‰</li>
<li>--mixedï¼š é‡ç½®ç´¢å¼•ï¼Œä½†ä¸é‡ç½®å·¥ä½œæ ‘ï¼Œæ›´æ”¹åçš„æ–‡ä»¶æ ‡è®°ä¸ºæœªæäº¤ï¼ˆaddï¼‰çš„çŠ¶æ€ã€‚é»˜è®¤æ“ä½œã€‚</li>
<li>--hardï¼š é‡ç½®ç´¢å¼•å’Œå·¥ä½œæ ‘ï¼Œå¹¶ä¸”aåˆ†æ”¯ä¿®æ”¹çš„æ‰€æœ‰æ–‡ä»¶å’Œä¸­é—´çš„æäº¤ï¼Œæ²¡æäº¤çš„ä»£ç éƒ½è¢«ä¸¢å¼ƒäº†ã€‚</li>
<li>--mergeï¼š å’Œ--hardç±»ä¼¼ï¼Œåªä¸è¿‡å¦‚æœåœ¨æ‰§è¡Œresetå‘½ä»¤ä¹‹å‰ä½ æœ‰æ”¹åŠ¨ä¸€äº›æ–‡ä»¶å¹¶ä¸”æœªæäº¤ï¼Œmergeä¼šä¿ç•™ä½ çš„è¿™äº›ä¿®æ”¹ï¼Œhardåˆ™ä¸ä¼šã€‚ã€æ³¨ï¼šå¦‚æœä½ çš„è¿™äº›ä¿®æ”¹addè¿‡æˆ–commitè¿‡ï¼Œmergeå’Œhardéƒ½å°†åˆ é™¤ä½ çš„æäº¤ã€‘ </li>
<li>--keepï¼š å’Œ--hardç±»ä¼¼ï¼Œæ‰§è¡Œresetä¹‹å‰æ”¹åŠ¨æ–‡ä»¶å¦‚æœæ˜¯aåˆ†æ”¯ä¿®æ”¹äº†çš„ï¼Œä¼šæç¤ºä½ ä¿®æ”¹äº†ç›¸åŒçš„æ–‡ä»¶ï¼Œä¸èƒ½åˆå¹¶ã€‚å¦‚æœä¸æ˜¯aåˆ†æ”¯ä¿®æ”¹çš„æ–‡ä»¶ï¼Œä¼šç§»é™¤ç¼“å­˜åŒºã€‚git statusè¿˜æ˜¯å¯ä»¥çœ‹åˆ°ä¿æŒäº†è¿™äº›ä¿®æ”¹ã€‚</li>
</ul>
<p>è§†æƒ…å†µä½¿ç”¨ï¼Œå°¤å…¶ä¸å»ºè®®åœ¨å°†å›é€€ç‰ˆæœ¬çš„åé¢çš„æäº¤å·²æ¨é€åˆ°è¿œç¨‹ä»“åº“æ—¶ä½¿ç”¨ï¼Œå¦åˆ™æœ¬åœ°ç‰ˆæœ¬è½åäºè¿œç¨‹ç‰ˆæœ¬ï¼Œåªæœ‰å¼ºæ¨æ‰èƒ½è¦†ç›–æ¨é€ï¼Œé£é™©è¾ƒå¤§</p>
<h3 id="åˆ†æ”¯"><a class="header" href="#åˆ†æ”¯">åˆ†æ”¯</a></h3>
<h4 id="branch"><a class="header" href="#branch">branch</a></h4>
<h4 id="merge"><a class="header" href="#merge">merge</a></h4>
<p>æˆ‘çš„éœ€æ±‚åœ¨<code>feature/tianchi/xxx</code>åˆ†æ”¯ä¸Šå†™å®Œï¼Œè¦åˆå¹¶åˆ°<code>develop</code>é‡Œé¢ï¼Œéœ€è¦å…ˆé€‰æ‹©åˆ°å¼€å‘åˆ†æ”¯å†å»mergeæˆ‘çš„åˆ†æ”¯ï¼Œä¼šæ˜¯<code>Merge branch 'feature/tianchi/xxx' into 'develop'</code>ï¼Œåƒä¸‡<strong>ä¸è¦</strong>åœ¨æˆ‘çš„åˆ†æ”¯ä¸Šå»mergeå¼€å‘åˆ†æ”¯ï¼Œä¼šå˜æˆ<code>Merge branch 'develop' into 'feature/tianchi/xxx'</code></p>
<pre><code class="language-shell">#æ­£ç¡®æ“ä½œå¦‚ä¸‹
git pull origin develop:develop
git checkout develop
git merge feature/tianchi/xxx
</code></pre>
<h4 id="rebase"><a class="header" href="#rebase">rebase</a></h4>
<p>é‡å®šï¼Œå˜åŸº(?)ï¼ŒæŒ‡å°†åˆ†æ”¯ç§»åˆ°ä¸€ä¸ªæ–°çš„åŸºæäº¤çš„è¿‡ç¨‹</p>
<ul>
<li>rebase
<ul>
<li>-rï¼š--rebase-mergesç®€å†™ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="language-shell">git rebase -r
</code></pre>
<h2 id="è§„èŒƒ"><a class="header" href="#è§„èŒƒ">è§„èŒƒ</a></h2>
<p>https://www.jianshu.com/p/201bd81e7dc9?utm_source=oschina-app</p>
<h3 id="commit-message-çš„ä½œç”¨"><a class="header" href="#commit-message-çš„ä½œç”¨">Commit message çš„ä½œç”¨</a></h3>
<p>æä¾›æ›´å¤šçš„å†å²ä¿¡æ¯ï¼Œæ–¹ä¾¿å¿«é€Ÿæµè§ˆã€‚</p>
<p>æ¯”å¦‚ï¼Œä¸‹é¢çš„å‘½ä»¤æ˜¾ç¤ºä¸Šæ¬¡å‘å¸ƒåçš„å˜åŠ¨ï¼Œæ¯ä¸ªcommitå æ®ä¸€è¡Œã€‚ä½ åªçœ‹è¡Œé¦–ï¼Œå°±çŸ¥é“æŸæ¬¡ commit çš„ç›®çš„ã€‚</p>
<pre><code class="language-bash">$ git log &lt;last tag&gt; HEAD --pretty=format:%s
</code></pre>
<p>å¯ä»¥è¿‡æ»¤æŸäº›commitï¼ˆæ¯”å¦‚æ–‡æ¡£æ”¹åŠ¨ï¼‰ï¼Œä¾¿äºå¿«é€ŸæŸ¥æ‰¾ä¿¡æ¯</p>
<pre><code class="language-bash">$ git log &lt;last release&gt; HEAD --grep feature
</code></pre>
<p>å¯ä»¥ç›´æ¥ä»commitç”ŸæˆChange logã€‚Change Log æ˜¯å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œç”¨æ¥è¯´æ˜ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬å·®å¼‚çš„æ–‡æ¡£ï¼Œè¯¦è§åæ–‡ã€‚</p>
<p>å…¶ä»–ä¼˜ç‚¹</p>
<ul>
<li>å¯è¯»æ€§å¥½ï¼Œæ¸…æ™°ï¼Œä¸å¿…æ·±å…¥çœ‹ä»£ç å³å¯äº†è§£å½“å‰commitçš„ä½œç”¨ã€‚</li>
<li>ä¸º Code Reviewingåšå‡†å¤‡</li>
<li>æ–¹ä¾¿è·Ÿè¸ªå·¥ç¨‹å†å²</li>
<li>è®©å…¶ä»–çš„å¼€å‘è€…åœ¨è¿è¡Œ git blame çš„æ—¶å€™æƒ³è·ªè°¢</li>
<li>æé«˜é¡¹ç›®çš„æ•´ä½“è´¨é‡ï¼Œæé«˜ä¸ªäººå·¥ç¨‹ç´ è´¨</li>
</ul>
<h3 id="commit-message-çš„æ ¼å¼"><a class="header" href="#commit-message-çš„æ ¼å¼">Commit message çš„æ ¼å¼</a></h3>
<p>æ¯æ¬¡æäº¤ï¼ŒCommit message éƒ½åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼šheaderï¼Œbody å’Œ footerã€‚</p>
<pre><code class="language-xml">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;
&lt;BLANK LINE&gt;
&lt;body&gt;
&lt;BLANK LINE&gt;
&lt;footer&gt;
</code></pre>
<p>å…¶ä¸­ï¼Œheader æ˜¯å¿…éœ€çš„ï¼Œbody å’Œ footer å¯ä»¥çœç•¥ã€‚
ä¸ç®¡æ˜¯å“ªä¸€ä¸ªéƒ¨åˆ†ï¼Œä»»ä½•ä¸€è¡Œéƒ½ä¸å¾—è¶…è¿‡72ä¸ªå­—ç¬¦ï¼ˆæˆ–100ä¸ªå­—ç¬¦ï¼‰ã€‚è¿™æ˜¯ä¸ºäº†é¿å…è‡ªåŠ¨æ¢è¡Œå½±å“ç¾è§‚ã€‚</p>
<h4 id="header"><a class="header" href="#header">Header</a></h4>
<p>Headeréƒ¨åˆ†åªæœ‰ä¸€è¡Œï¼ŒåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼š<code>type</code>ï¼ˆå¿…éœ€ï¼‰ã€<code>scope</code>ï¼ˆå¯é€‰ï¼‰å’Œ<code>subject</code>ï¼ˆå¿…éœ€ï¼‰ã€‚</p>
<h5 id="type"><a class="header" href="#type">type</a></h5>
<p>ç”¨äºè¯´æ˜ commit çš„ç±»åˆ«ï¼Œåªå…è®¸ä½¿ç”¨ä¸‹é¢7ä¸ªæ ‡è¯†ã€‚</p>
<ul>
<li>featï¼šæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰</li>
<li>fixï¼šä¿®è¡¥bug</li>
<li>docsï¼šæ–‡æ¡£ï¼ˆdocumentationï¼‰</li>
<li>styleï¼š æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰</li>
<li>refactorï¼šé‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰</li>
<li>testï¼šå¢åŠ æµ‹è¯•</li>
<li>choreï¼šæ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨</li>
</ul>
<p>å¦‚æœtypeä¸º<code>feat</code>å’Œ<code>fix</code>ï¼Œåˆ™è¯¥ commit å°†è‚¯å®šå‡ºç°åœ¨ Change log ä¹‹ä¸­ã€‚å…¶ä»–æƒ…å†µï¼ˆ<code>docs</code>ã€<code>chore</code>ã€<code>style</code>ã€<code>refactor</code>ã€<code>test</code>ï¼‰ç”±ä½ å†³å®šï¼Œè¦ä¸è¦æ”¾å…¥ Change logï¼Œå»ºè®®æ˜¯ä¸è¦ã€‚</p>
<h5 id="scope"><a class="header" href="#scope">scope</a></h5>
<p>scopeç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®ä¸åŒè€Œä¸åŒã€‚</p>
<p>ä¾‹å¦‚åœ¨<code>Angular</code>ï¼Œå¯ä»¥æ˜¯<code>$location</code>, <code>$browser</code>, <code>$compile</code>, <code>$rootScope</code>, <code>ngHref</code>, <code>ngClick</code>, <code>ngView</code>ç­‰ã€‚</p>
<p>å¦‚æœä½ çš„ä¿®æ”¹å½±å“äº†ä¸æ­¢ä¸€ä¸ª<code>scope</code>ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>*</code>ä»£æ›¿ã€‚</p>
<h5 id="subject"><a class="header" href="#subject">subject</a></h5>
<p><code>subject</code>æ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50ä¸ªå­—ç¬¦ã€‚</p>
<p>å…¶ä»–æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>ä»¥åŠ¨è¯å¼€å¤´ï¼Œä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚changeï¼Œè€Œä¸æ˜¯changedæˆ–changes</li>
<li>ç¬¬ä¸€ä¸ªå­—æ¯å°å†™</li>
<li>ç»“å°¾ä¸åŠ å¥å·ï¼ˆ.ï¼‰</li>
</ul>
<h4 id="body"><a class="header" href="#body">Body</a></h4>
<p>Body éƒ¨åˆ†æ˜¯å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªèŒƒä¾‹ã€‚</p>
<pre><code class="language-php">More detailed explanatory text, if necessary.  Wrap it to 
about 72 characters or so. 

Further paragraphs come after blank lines.

- Bullet points are okay, too
- Use a hanging indent
</code></pre>
<p>æœ‰ä¸¤ä¸ªæ³¨æ„ç‚¹:</p>
<ul>
<li>ä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚ä½¿ç”¨changeè€Œä¸æ˜¯changedæˆ–changesã€‚</li>
<li>æ°¸è¿œåˆ«å¿˜äº†ç¬¬2è¡Œæ˜¯ç©ºè¡Œ</li>
<li>åº”è¯¥è¯´æ˜ä»£ç å˜åŠ¨çš„åŠ¨æœºï¼Œä»¥åŠä¸ä»¥å‰è¡Œä¸ºçš„å¯¹æ¯”ã€‚</li>
</ul>
<h4 id="footer"><a class="header" href="#footer">Footer</a></h4>
<p>Footer éƒ¨åˆ†åªç”¨äºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p>
<h5 id="ä¸å…¼å®¹å˜åŠ¨"><a class="header" href="#ä¸å…¼å®¹å˜åŠ¨">ä¸å…¼å®¹å˜åŠ¨</a></h5>
<p>å¦‚æœå½“å‰ä»£ç ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸å…¼å®¹ï¼Œåˆ™ Footer éƒ¨åˆ†ä»¥BREAKING CHANGEå¼€å¤´ï¼Œåé¢æ˜¯å¯¹å˜åŠ¨çš„æè¿°ã€ä»¥åŠå˜åŠ¨ç†ç”±å’Œè¿ç§»æ–¹æ³•ã€‚</p>
<pre><code class="language-go">BREAKING CHANGE: isolate scope bindings definition has changed.

    To migrate the code follow the example below:

    Before:

    scope: {
      myAttr: 'attribute',
    }

    After:

    scope: {
      myAttr: '@',
    }

    The removed `inject` wasn't generaly useful for directives so there should be no code using it.
</code></pre>
<h5 id="å…³é—­-issue"><a class="header" href="#å…³é—­-issue">å…³é—­ Issue</a></h5>
<p>å¦‚æœå½“å‰ commit é’ˆå¯¹æŸä¸ªissueï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Footer éƒ¨åˆ†å…³é—­è¿™ä¸ª issue ã€‚</p>
<pre><code class="language-bash">Closes #234
</code></pre>
<h4 id="revert-1"><a class="header" href="#revert-1">Revert</a></h4>
<p>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœå½“å‰ commit ç”¨äºæ’¤é”€ä»¥å‰çš„ commitï¼Œåˆ™å¿…é¡»ä»¥revert:å¼€å¤´ï¼Œåé¢è·Ÿç€è¢«æ’¤é”€ Commit çš„ Headerã€‚</p>
<pre><code class="language-csharp">revert: feat(pencil): add 'graphiteWidth' option

This reverts commit 667ecc1654a317a13331b17617d973392f415f02.
</code></pre>
<p>Bodyéƒ¨åˆ†çš„æ ¼å¼æ˜¯å›ºå®šçš„ï¼Œå¿…é¡»å†™æˆ<code>This reverts commit &lt;hash&gt;</code>.ï¼Œå…¶ä¸­çš„hashæ˜¯è¢«æ’¤é”€ commit çš„ SHA æ ‡è¯†ç¬¦ã€‚</p>
<p>å¦‚æœå½“å‰ commit ä¸è¢«æ’¤é”€çš„ commitï¼Œåœ¨åŒä¸€ä¸ªå‘å¸ƒï¼ˆreleaseï¼‰é‡Œé¢ï¼Œé‚£ä¹ˆå®ƒä»¬éƒ½ä¸ä¼šå‡ºç°åœ¨ Change log é‡Œé¢ã€‚å¦‚æœä¸¤è€…åœ¨ä¸åŒçš„å‘å¸ƒï¼Œé‚£ä¹ˆå½“å‰ commitï¼Œä¼šå‡ºç°åœ¨ Change log çš„Revertså°æ ‡é¢˜ä¸‹é¢ã€‚</p>
<h3 id="commitizen"><a class="header" href="#commitizen">Commitizen</a></h3>
<p>å¯ä»¥ä½¿ç”¨å…¸å‹çš„gitå·¥ä½œæµç¨‹æˆ–é€šè¿‡ä½¿ç”¨CLIå‘å¯¼<a href="https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2Fcommitizen%2Fcz-cli">Commitizen</a>æ¥æ·»åŠ æäº¤æ¶ˆæ¯æ ¼å¼ã€‚</p>
<h3 id="å®‰è£…-4"><a class="header" href="#å®‰è£…-4">å®‰è£…</a></h3>
<pre><code class="language-undefined">npm install -g commitizen
</code></pre>
<p>ç„¶åï¼Œåœ¨é¡¹ç›®ç›®å½•é‡Œï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä½¿å…¶æ”¯æŒ Angular çš„ Commit message æ ¼å¼ã€‚</p>
<pre><code class="language-kotlin">commitizen init cz-conventional-changelog --save --save-exact
</code></pre>
<p>ä»¥åï¼Œå‡¡æ˜¯ç”¨åˆ°<code>git commit</code>å‘½ä»¤ï¼Œä¸€å¾‹æ”¹ä¸ºä½¿ç”¨<code>git cz</code>ã€‚è¿™æ—¶ï¼Œå°±ä¼šå‡ºç°é€‰é¡¹ï¼Œç”¨æ¥ç”Ÿæˆç¬¦åˆæ ¼å¼çš„ Commit messageã€‚</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/3827973-39053e8f0259dfda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/557/format/webp" alt="img" /></p>
<p>5.png</p>
<h3 id="validate-commit-msg"><a class="header" href="#validate-commit-msg">validate-commit-msg</a></h3>
<p><a href="https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2Fkentcdodds%2Fvalidate-commit-msg">validate-commit-msg</a> ç”¨äºæ£€æŸ¥é¡¹ç›®çš„ Commit message æ˜¯å¦ç¬¦åˆAngularè§„èŒƒã€‚</p>
<p>è¯¥åŒ…æä¾›äº†ä½¿ç”¨githooksæ¥æ ¡éªŒ<code>commit message</code>çš„ä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘æ¨èä½¿ç”¨<a href="https://link.jianshu.com?t=http%3A%2F%2Fnpm.im%2Fhusky">husky</a>ï¼Œåªéœ€è¦æ·»åŠ <code>&quot;commitmsg&quot;: &quot;validate-commit-msg&quot;</code>åˆ°ä½ çš„<code>package.json</code>ä¸­çš„<code>nam scripts</code>å³å¯.</p>
<p>å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡å®šä¹‰é…ç½®æ–‡ä»¶<code>.vcmrc</code>æ¥è‡ªå®šä¹‰æ ¡éªŒæ ¼å¼ã€‚è¯¦ç»†ä½¿ç”¨è¯·è§æ–‡æ¡£ <a href="https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2Fkentcdodds%2Fvalidate-commit-msg">validate-commit-msg</a></p>
<h3 id="ç”Ÿæˆ-change-log"><a class="header" href="#ç”Ÿæˆ-change-log">ç”Ÿæˆ Change log</a></h3>
<p>å¦‚æœä½ çš„æ‰€æœ‰ Commit éƒ½ç¬¦åˆ Angular æ ¼å¼ï¼Œé‚£ä¹ˆå‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œ Change log å°±å¯ä»¥ç”¨è„šæœ¬è‡ªåŠ¨ç”Ÿæˆã€‚ç”Ÿæˆçš„æ–‡æ¡£åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>New features</li>
<li>Bug fixes</li>
<li>Breaking changes.</li>
</ul>
<p>æ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šç½—åˆ—ç›¸å…³çš„ commit ï¼Œå¹¶ä¸”æœ‰æŒ‡å‘è¿™äº› commit çš„é“¾æ¥ã€‚å½“ç„¶ï¼Œç”Ÿæˆçš„æ–‡æ¡£å…è®¸æ‰‹åŠ¨ä¿®æ”¹ï¼Œæ‰€ä»¥å‘å¸ƒå‰ï¼Œä½ è¿˜å¯ä»¥æ·»åŠ å…¶ä»–å†…å®¹ã€‚</p>
<p><a href="https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2Fajoslin%2Fconventional-changelog">conventional-changelog</a> å°±æ˜¯ç”Ÿæˆ Change log çš„å·¥å…·ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ã€‚</p>
<pre><code class="language-ruby">$ npm install -g conventional-changelog
$ cd my-project
$ conventional-changelog -p angular -i CHANGELOG.md -w
</code></pre>
<h2 id="æœ¬åœ°åº“æ“ä½œ"><a class="header" href="#æœ¬åœ°åº“æ“ä½œ">æœ¬åœ°åº“æ“ä½œ</a></h2>
<h3 id="æœ¬åœ°åº“åˆå§‹åŒ–"><a class="header" href="#æœ¬åœ°åº“åˆå§‹åŒ–">æœ¬åœ°åº“åˆå§‹åŒ–</a></h3>
<ol>
<li>åœ¨cmdä¸­è¿›åˆ°é¡¹ç›®ç›®å½•ä¸‹</li>
<li>git initï¼šæœ¬åœ°åº“åˆå§‹åŒ–ã€‚ç”Ÿæˆä¸€ä¸ª.gitç›®å½•ï¼Œè¯¥ç›®å½•ä¸­å­˜æ”¾çš„æ˜¯æœ¬åœ°åº“ç›¸å…³çš„å­ç›®å½•å’Œæ–‡ä»¶</li>
<li>è®¾ç½®ç­¾åï¼šusernameå’Œemailç”¨äºåŒºåˆ†ä¸åŒå¼€å‘äººå‘˜çš„èº«ä»½ã€‚è¿™é‡Œè®¾ç½®çš„ç­¾åå’Œç™»å½•è¿œç¨‹åº“(ä»£ç æ‰˜ç®¡ä¸­å¿ƒ)çš„è´¦å·å¯†ç æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚é»˜è®¤é¡¹ç›®çº§åˆ«(ä»“åº“çº§åˆ«)ä»…åœ¨å½“å‰æœ¬åœ°åº“èŒƒå›´å†…ç”Ÿæ•ˆï¼Œé¡¹ç›®çº§åˆ«ä¿¡æ¯ä¿å­˜åœ¨.git/configä¸‹ã€‚ç³»ç»Ÿç”¨æˆ·çº§åˆ«ï¼šæŒ‡å®š--globalï¼Œç³»ç»Ÿç”¨æˆ·çº§åˆ«ä¿¡æ¯ä¿å­˜åœ¨ç³»ç»Ÿç”¨æˆ·å®¶ç›®å½•ä¸‹çš„.configæ–‡ä»¶ä¸­ã€‚é¡¹ç›®çº§åˆ«ä¼˜å…ˆäºç³»ç»Ÿç”¨æˆ·çº§åˆ«ã€‚è‡³å°‘è®¾ç½®ä¸€ä¸ª
<ol>
<li>git config [--global] user.name <username>ï¼šè®¾ç½®ç”¨æˆ·å</li>
<li>git config [--global] user.email <email>ï¼šè®¾ç½®Emailåœ°å€</li>
<li>cat .git/cogfigï¼šæŸ¥çœ‹æœ¬åœ°åº“é…ç½®æ–‡ä»¶</li>
</ol>
</li>
</ol>
<h3 id="åŸºæœ¬æ“ä½œ"><a class="header" href="#åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</a></h3>
<ul>
<li>git help &lt;å‘½ä»¤&gt;ï¼šæŸ¥çœ‹è¯¥å‘½ä»¤æ–‡æ¡£</li>
</ul>
<h3 id="æ–‡ä»¶æ“ä½œ"><a class="header" href="#æ–‡ä»¶æ“ä½œ">æ–‡ä»¶æ“ä½œ</a></h3>
<ul>
<li>git statusï¼šæŸ¥çœ‹çŠ¶æ€ã€‚
<ul>
<li>on branch masterè¡¨ç¤ºåœ¨ä¸»åˆ†æ”¯ä¸Šï¼Œno commits yetè¡¨ç¤ºæ— æäº¤å†…å®¹</li>
<li>çº¢è‰²æ–‡ä»¶è¡¨ç¤ºæœªæ·»åŠ åˆ°æš‚å­˜åŒºä¸­ï¼Œç»¿è‰²è¡¨ç¤ºå·²æ·»åŠ åˆ°æš‚å­˜åŒºä¸­</li>
</ul>
</li>
<li>git add <filename>ï¼šå°†æ–‡ä»¶ä»å·¥ä½œåŒºæ·»åŠ åˆ°æš‚å­˜åŒºã€‚unstageè¡¨ç¤ºä»æš‚å­˜åŒºä¸­ç§»é™¤</li>
<li>git rm <filename>ï¼šä»æš‚å­˜åŒºåˆ é™¤</li>
<li>git commit [-m <description>] [-a] <filename>ï¼šå°†æ–‡ä»¶ä»æš‚å­˜åŒºä¸­æäº¤åˆ°æœ¬åœ°åº“ï¼Œæ·»åŠ åä¼šè¿›å…¥vimï¼Œå†™æœ¬æ¬¡æäº¤æè¿°å†…å®¹
<ul>
<li>-mï¼šæ— éœ€ç¼–è¾‘vimï¼Œç›´æ¥åœ¨åé¢å†™å…¥æè¿°å†…å®¹ï¼Œï¼›</li>
<li>-aï¼šæ— éœ€git addæ“ä½œï¼Œç›´æ¥æ·»åŠ &amp;æäº¤ï¼Œä¸è¿‡å°±ä¸å­˜åœ¨æš‚å­˜åŒºçš„æ’¤é”€æ“ä½œæ—¶é—´äº†</li>
<li>ç»“æœå†…å®¹ï¼š
<ul>
<li>root-commitï¼šè¡¨ç¤ºæ ¹æäº¤(ç¬¬ä¸€æ¬¡æäº¤)</li>
<li>æ•°å­—ç¼–å·ï¼šæš‚æ—¶ç²—ç•¥è®¤ä¸ºæ˜¯æœ¬æ¬¡æäº¤çš„ç‰ˆæœ¬å·</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ç‰ˆæœ¬ç§»åŠ¨"><a class="header" href="#ç‰ˆæœ¬ç§»åŠ¨">ç‰ˆæœ¬ç§»åŠ¨</a></h3>
<ul>
<li>git log [--pretty={oneline}] [--oneline]ï¼šæŸ¥çœ‹æ—¥å¿—ç‰ˆæœ¬ï¼Œåªæ˜¾ç¤ºå½“å‰åŠä»¥å‰ç‰ˆæœ¬ã€‚è¿™é‡Œæœ‰2ä¸ªç‰ˆæœ¬çš„è®°å½•ï¼Œè¿™é‡Œhashå€¼è¡¨ç¤ºè¯¥æ¬¡æäº¤çš„ç´¢å¼•ï¼ŒHEADæ˜¯æŒ‡å‘å½“å‰ç‰ˆæœ¬çš„æŒ‡é’ˆ
<ul>
<li>--pretty=onelineå°†æ¯ä¸ªç‰ˆæœ¬åªä»¥ä¸€è¡Œæ˜¾ç¤º</li>
<li>--onelineä¸ä»…ä¸€è¡Œæ˜¾ç¤ºè¿˜åªæ˜¾ç¤ºéƒ¨åˆ†hashå€¼</li>
</ul>
</li>
<li>git reflogï¼šæŸ¥çœ‹æ—¥å¿—ï¼Œæ˜¾ç¤ºå‰åæ‰€æœ‰ç‰ˆæœ¬ä»¥åŠç‰ˆæœ¬ç§»åŠ¨
<ul>
<li>HEAD@{n}è¡¨ç¤ºç§»åŠ¨åˆ°å¯¹åº”ç‰ˆæœ¬æŒ‡é’ˆéœ€è¦ç§»åŠ¨næ­¥</li>
</ul>
</li>
<li>git reset --{hard/mixed/soft} HEAD <headHash>ï¼šç´¢å¼•ç§»åŠ¨(æ¨è)
<ul>
<li>--mixedåœ¨æœ¬åœ°æ¯ç§»åŠ¨HEADæŒ‡é’ˆï¼Œé‡ç½®æš‚å­˜åŒºï¼Œé»˜è®¤ç­–ç•¥</li>
<li>--hardåœ¨æœ¬åœ°åº“ç§»åŠ¨HEADæŒ‡é’ˆï¼Œé‡ç½®æš‚å­˜åŒºï¼Œé‡ç½®å·¥ä½œåŒºï¼ˆä¼šåˆ é™¤æ–‡ä»¶ï¼‰ï¼Œ</li>
<li>--softä»…åœ¨æœ¬åœ°åº“ç§»åŠ¨HEADæŒ‡é’ˆ</li>
</ul>
</li>
<li>git reset  --hard HEAD^^^ï¼š^ç§»åŠ¨ï¼Œåªèƒ½åé€€ï¼Œ3ä¸ª^å³è¡¨ç¤ºåé€€3ä¸ªç‰ˆæœ¬</li>
<li>git reset  --hard HEAD~<n>ï¼š~ç§»åŠ¨ï¼Œåªèƒ½åé€€ï¼Œnå³è¡¨ç¤ºåé€€nä¸ªç‰ˆæœ¬</li>
<li>git checkout <versionNumber> <filename>ï¼šé€‰æ‹©æŸä¸ªç‰ˆæœ¬çš„æ–‡ä»¶åˆ°å·¥ä½œåŒº</li>
<li>git diff [HEAD] [<filename>]ï¼šåœ¨ä¿®æ”¹å·¥ä½œåŒºæ–‡ä»¶ä¹‹å
<ul>
<li>æ— HEADï¼šè¡¨ç¤ºå·¥ä½œåŒºä¸æš‚å­˜åŒºçš„è¯¥æ–‡ä»¶æ¯”è¾ƒï¼Œæ˜¾ç¤ºæ–‡ä»¶å˜åŒ–</li>
<li>æœ‰HEADï¼šè¡¨ç¤ºå·¥ä½œåŒºä¸æœ¬åœ°åº“çš„è¯¥æ–‡ä»¶æ¯”è¾ƒï¼Œæ˜¾ç¤ºæ–‡ä»¶å˜åŒ–</li>
<li>æ— <filename>ï¼šå°†æ¯”è¾ƒå½“å‰å·¥ä½œåŒºä¸­çš„æ‰€æœ‰æ–‡ä»¶</li>
</ul>
</li>
</ul>
<h3 id="åˆ†æ”¯ç®¡ç†"><a class="header" href="#åˆ†æ”¯ç®¡ç†">åˆ†æ”¯ç®¡ç†</a></h3>
<p>åˆ†æ”¯ï¼šåœ¨ç‰ˆæœ¬æ§åˆ¶è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å¤šæ¡çº¿åŒæ—¶æ¨è¿›å¤šä¸ªä»»åŠ¡ã€‚åŒæ—¶å¹¶è¡Œæ¨è¿›å¤šä¸ªåŠŸèƒ½å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚å„ä¸ªåˆ†æ”¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸€ä¸ªåˆ†æ”¯å¼€å‘å¤±è´¥ï¼Œä¸ä¼šå¯¹å…¶ä»–åˆ†æ”¯æœ‰ä»»ä½•å½±å“ï¼Œåˆ é™¤é‡æ–°å¼€å§‹å³å¯</p>
<ul>
<li>git branch [-v] [-a]ï¼š
<ul>
<li>-vï¼šæ˜¾ç¤ºç‰ˆæœ¬å·</li>
<li>-aï¼šåŒ…æ‹¬è¿œç¨‹åˆ†æ”¯</li>
</ul>
</li>
<li>git branch <branchName>ï¼šåˆ›å»ºåˆ†æ”¯</li>
<li>git branch -D <branchName>ï¼šåˆ é™¤åˆ†æ”¯</li>
<li>git checkout <branchName>ï¼šåˆ‡æ¢åˆ†æ”¯</li>
<li>git merge <branchName>ï¼šåˆå¹¶æŸåˆ†æ”¯ï¼Œå°†å½“å‰æ‰€åœ¨åˆ†æ”¯ä¸æŸåˆ†æ”¯åˆå¹¶ã€‚
<ul>
<li>åˆ†æ”¯åˆå¹¶å†²çªï¼šå½“ä¸¤ä¸ªåˆ†æ”¯éƒ½ä¿®æ”¹äº†åŒä¸€ä¸ªæ–‡ä»¶ä¸­åŒä¸€è¡Œçš„å†…å®¹ï¼Œåˆå¹¶æ—¶å–èˆå“ªä¸ªåˆ†æ”¯çš„è¯¥å¤„å†…å®¹gitæ˜¯æ— æ³•åˆ¤æ–­çš„ï¼Œåªéœ€è¦vimæ‰‹åŠ¨ç¼–è¾‘åå†æ·»åŠ æäº¤(æäº¤ä¸èƒ½å¸¦æ–‡ä»¶å)å³å¯</li>
</ul>
</li>
</ul>
<h3 id="clean"><a class="header" href="#clean">clean</a></h3>
<pre><code class="language-sh">git clean -f
git clean -d -fx #å¼ºåˆ¶åˆ é™¤Untracked files
</code></pre>
<h2 id="åˆå¹¶å·¥ç¨‹"><a class="header" href="#åˆå¹¶å·¥ç¨‹">åˆå¹¶å·¥ç¨‹</a></h2>
<ul>
<li>å‡å¦‚æœ‰masterã€testã€developåˆ†æ”¯ï¼Œç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ä»masteråˆ‡å‡ºæ¥ä¸€ä¸ªdemandï¼Œéœ€æ±‚å­ä»»åŠ¡ä»demandåˆ‡å‡ºæ¥ä¸€ä¸ªdemand/childï¼š<code>git pull origin demand:demand</code>ï¼Œ<code>git ch demand</code>ï¼Œ<code>git ch -b demand/child</code>
<ul>
<li>ä»»åŠ¡å¼€å‘å®Œåï¼Œéœ€è¦merge demand/child into developã€‚åˆ‡åˆ°ä»»åŠ¡åˆ†æ”¯<code>git ch demand/child</code>ï¼Œæ‹‰å–developåˆ†æ”¯<code>git pull origin develop:develop</code>ï¼Œä¼šæœ‰å¾ˆå¤šæ”¹å˜ï¼Œä¼šå› ç‰ˆæœ¬è€Œmerge develop into demand/childçš„ç›¸å…³æç¤ºï¼Œä¸­æ­¢merge<code>git merge --abort</code>ï¼Œä¸èƒ½è®©merge develop into demand/childå‘ç”Ÿï¼Œè¿™åäº†ï¼Œåˆ‡åˆ°dev<code>git ch develop</code>ï¼Œmerge demand/child into develop<code>git merge demand/child</code>ï¼Œç¼–è¯‘æ£€æŸ¥<code>go build xxx</code>ï¼Œæäº¤ä¹‹å‰å†æ£€æŸ¥ç‰ˆæœ¬<code>git lg -5</code>æ˜¯å¦æ˜¯merge demand/child into developï¼Œæ¨é€<code>git push origin develop:develop</code></li>
<li>developç¯å¢ƒè°ƒè¯•å®Œï¼Œéœ€è¦merge demand/child into demandã€‚åˆ‡åˆ°ä»»åŠ¡åˆ†æ”¯<code>git ch demand/child</code>ï¼Œç›´æ¥æ‹‰å–è¿œç¨‹demandå¹¶åˆå¹¶åˆ°demand/child<code>git pull origin demand:demand/child</code>ï¼Œå› ä¸ºdemandæœ¬æ¥å°±æ˜¯demand/childçš„æºï¼Œæ‰€ä»¥ç›´æ¥åˆå¹¶ä¹‹åè¦å†åˆå¹¶å›å»<code>git push origin demand/child:demand</code>ï¼Œä¸ä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Œä¹Ÿèƒ½å°†å…¶ä»–äººçš„æ›´æ”¹åˆå¹¶è¿›æ¥ï¼Œå¦‚æœdevelopä¹Ÿè¿™ä¹ˆåšçš„è¯ï¼Œä¼šå°†demand/childä¸éœ€è¦çš„developçš„å†…å®¹åˆå¹¶è¿›æ¥ï¼Œé‚£å°±åªæœ‰å›é€€ç‰ˆæœ¬å†é‡æ–°æ“ä½œäº†</li>
</ul>
</li>
</ul>
<h2 id="git-flow"><a class="header" href="#git-flow">git flow</a></h2>
<p>å¼€å‘</p>
<pre><code class="language-shell"># åˆ›å»º feature/&lt;brance_name&gt; åˆ†æ”¯
git flow feature start brance_name
# åˆå¹¶ feature/&lt;brance_name&gt; åˆ° developï¼Œåˆ é™¤ feature/&lt;brance_name&gt;ï¼Œå¹¶åˆ‡æ¢åˆ° develop
git flow feature finish brance_name
</code></pre>
<p>å‘å¸ƒ</p>
<pre><code class="language-shell"># åˆ›å»º release-1.1.1 åˆ†æ”¯
git flow release start 1.1.1
# åˆå¹¶ release-1.1.1 åˆ° masterï¼Œä½¿ç”¨ release-1.1.1 åˆ†æ”¯åç§°æ‰“ tagï¼Œå›åˆ release-1.1.1 åˆ° developï¼Œåˆ é™¤ release-1.1.1ï¼Œå¹¶åˆ‡æ¢åˆ° develop
git flow release finish 1.1.1
</code></pre>
<p>ç´§æ€¥ä¿®å¤</p>
<pre><code class="language-shell"># åˆ›å»º hotfix-1.1.1 åˆ†æ”¯
git flow hotfix start 1.1.1
# åˆå¹¶ hotfix-1.1.1 åˆ° masterï¼›
# å¦‚æœå­˜åœ¨ release-1.1.1ï¼Œåˆ™åˆå¹¶ hotfix-1.1.1 åˆ° release-1.1.1ï¼Œå¦åˆ™åˆå¹¶ hotfix-1.1.1 åˆ° developï¼›
# åˆ é™¤ hotfix-1.1.1ï¼Œå¹¶åˆ‡æ¢åˆ° develop
git flow release finish 1.1.1
</code></pre>
<h1 id="github"><a class="header" href="#github">GitHub</a></h1>
<h3 id="ssh"><a class="header" href="#ssh">ssh</a></h3>
<pre><code class="language-shell"># ed25519ç®—æ³•
ssh-keygen -t ed25519 -C &quot;yuanyatianchi@example.com&quot;
# rsaç®—æ³•
ssh-keygen -t rsa -b 4096 -C &quot;yuanyatianchi@gmail.com&quot;
</code></pre>
<h3 id="æœç´¢"><a class="header" href="#æœç´¢">æœç´¢</a></h3>
<p>åŒ¹é…è¯­æ³•ã€‚</p>
<ul>
<li>æ¨¡ç³ŠåŒ¹é…ï¼š<code>in:&lt;field&gt; &lt;xxx&gt;</code>ï¼Œè¡¨ç¤ºåŒ¹é…æŸå­—æ®µä¸­åŒ…å« xxx å­—ç¬¦ä¸²
<ul>
<li>nameï¼š<code>in:name xxx</code></li>
<li>readmeï¼š<code>in:readme xxx</code></li>
<li>descriptioï¼š<code>in:description xxx</code></li>
</ul>
</li>
<li>æ•°å­—
<ul>
<li>stars:&gt;1000 æˆ– star&gt;1000</li>
<li>forks:&gt;1000 æˆ– fork&gt;1000</li>
</ul>
</li>
<li>æ—¥æœŸ
<ul>
<li>pushed:&gt;2019-04-15ï¼Œè¡¨ç¤º2019å¹´4æœˆ15æ—¥åæœ‰æ›´æ–°çš„</li>
</ul>
</li>
<li>è¯­è¨€
<ul>
<li>language:goï¼Œè¡¨ç¤º go è¯­è¨€é¡¹ç›®</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
